(function(c){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,a=h?h("WidgetStreamer",""):g;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,g,h){c.when("jQuery","widget-streamer-action-ws-append","widget-streamer-action-ws-prepend","widget-streamer-action-ws-update","widget-streamer-action-ws-event").register("widget-streamer-actions",function(a,d,e,b,f){var c={"ws-append":d,"ws-prepend":e,"ws-update":b,"ws-event":f},k={execute:a.noop};
return{create:function(f){var b,e,d;b=k;if(a.isArray(f)&&f.length&&f[0]){b=f[0];e=c[b];d="widget-streamer-action-"+b;if("function"!==typeof e)throw Error("Action: "+b+" is not supported. Register component "+d+" to handle this action");b=e(f)}return b}}});"use strict";c.register("widget-streamer-jquery-action",function(){return function(a,d,e){var b,f;if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));b=a[1];f=a[2];return{execute:function(a){var c=
a._$target.find(b).add(a._$target.filter(b));a._isTargetUpdated?e(c,f):d(c.get(0),f)}}}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-update",function(a){return function(d){return a(d,function(a,b){a.innerHTML=b},function(a,b){a.html(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a){return function(d){return a(d,function(a,b){a.innerHTML+=b},function(a,b){a.append(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",
function(a){return function(d){return a(d,function(a,b){a.innerHTML=b+a.innerHTML},function(a,b){a.prepend(b)})}});c.register("widget-streamer-action-ws-event",function(){return function(a){var d=a[1],c;try{c=JSON.parse(a[2])}catch(b){c=null}return{execute:function(a){a._emitEvent(d,c)}}}});"use strict";c.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===
typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";c.when("A","jQuery","widget-streamer-actions").register("widget-streamer",function(a,c,e){function b(a){a=a||{};this._$originalTarget=a.$target;this._$target=a.$target.clone();this._actions=[];this._isExecutable="undefined"===typeof a.immediateExecution||a.immediateExecution;this._onUpdate=
a.onUpdate||c.noop;this._hasExecutionStarted=!1;this._events=a.events||{};this._isTargetUpdated=!1;this._updateTriggerEvent=a.updateTriggerEvent;this.chunkHandler=c.proxy(this.chunkHandler,this)}b.prototype.chunkHandler=function(a){a=e.create(a);this._actions.push(a);this.executeActions()};b.prototype.enableExecution=function(){this._isExecutable=!0;this.executeActions()};b.prototype.executeActions=function(){var a;if(this._isExecutable&&this._actions.length)for(this._hasExecutionStarted||(this._hasExecutionStarted=
!0,this._updateTriggerEvent||this._updateTarget()),a=this._actions.shift();a;)a.execute(this),a=this._actions.shift()};b.prototype._emitEvent=function(a,b){var e=(this._events||{})[a]||c.noop;a===this._updateTriggerEvent&&this._updateTarget(b);e.call(this,b)};b.prototype._updateTarget=function(){this._onUpdate.apply(this,arguments);this._$originalTarget.html(this._$target.html());this._$target=this._$originalTarget;this._isTargetUpdated=!0};return function(a){return new b(a)}})});
/* ******** */
(function(r){var q=window.AmazonUIPageJS||window.P,F=q._namespace||q.attributeErrors,la=F?F("CheckoutCommonAsset",""):q;la.guardFatal?la.guardFatal(r)(la,window):la.execute(function(){r(la,window)})})(function(r,q,F){r.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,l){if(null==this)throw new TypeError('"this" is null or not defined');var m=Object(this),c=m.length>>>0;if(0===c)return-1;l=+l||0;Infinity===Math.abs(l)&&(l=0);if(l>=c)return-1;for(l=
Math.max(0<=l?l:c-Math.abs(l),0);l<c;){if(l in m&&m[l]===a)return l;l++}return-1})});"use strict";r.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var l=Object(this),m=l.length>>>0;if("function"!==typeof a)throw new TypeError;for(var c=[],f=2<=arguments.length?arguments[1]:void 0,h=0;h<m;h++)if(h in l){var g=l[h];a.call(f,g,h,l)&&c.push(g)}return c})});"use strict";r.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function l(){return this.valueOf()}function m(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=B[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,b){var e,k,p=d,g,f=b[a];f&&"object"===typeof f&&"function"===typeof f.toJSON&&(f=f.toJSON(a));"function"===typeof t&&(f=t.call(b,a,f));switch(typeof f){case "string":return m(f);case "number":return isFinite(f)?
String(f):"null";case "boolean":case "null":return String(f);case "object":if(!f)return"null";d+=n;g=[];if("[object Array]"===Object.prototype.toString.apply(f)){k=f.length;for(a=0;a<k;a+=1)g[a]=c(a,f)||"null";b=0===g.length?"[]":d?"[\n"+d+g.join(",\n"+d)+"\n"+p+"]":"["+g.join(",")+"]";d=p;return b}if(t&&"object"===typeof t)for(k=t.length,a=0;a<k;a+=1)"string"===typeof t[a]&&(e=t[a],(b=c(e,f))&&g.push(m(e)+(d?": ":":")+b));else for(e in f)Object.prototype.hasOwnProperty.call(f,e)&&(b=c(e,f))&&g.push(m(e)+
(d?": ":":")+b);b=0===g.length?"{}":d?"{\n"+d+g.join(",\n"+d)+"\n"+p+"}":"{"+g.join(",")+"}";d=p;return b}}var f=/^[\],:{}\s]*$/,h=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,g=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,b=/(?:^|:|,)(?:\s*\[)+/g,e=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=l,Number.prototype.toJSON=l,String.prototype.toJSON=l);var d,n,B,t;"function"!==typeof JSON.stringify&&(B={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=
function(a,b,e){var k;n=d="";if("number"===typeof e)for(k=0;k<e;k+=1)n+=" ";else"string"===typeof e&&(n=e);if((t=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,e){function d(a,b){var c,p,n=a[b];if(n&&"object"===typeof n)for(c in n)Object.prototype.hasOwnProperty.call(n,c)&&(p=d(n,c),p!==F?n[c]=p:delete n[c]);return e.call(a,b,n)}a=String(a);p.lastIndex=0;p.test(a)&&
(a=a.replace(p,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(f.test(a.replace(h,"@").replace(g,"]").replace(b,"")))return a=eval("("+a+")"),"function"===typeof e?d({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";r.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,l,m,c){function f(a,b){function e(a,b){for(var d=0;d<a._options.length;d++){var c=a._options[d];
if(c=b.call(a,c,"object"===typeof c?c.name:c))return c}}this._options=a instanceof f&&b&&b.length?a._options.concat(b):a instanceof f?a._options:a&&a.length?a:[];this.filter=function(a){var b={};e(this,function(e,c){c in a&&(b[c]=a[c])});return b};this.getOption=function(a){return e(this,function(b,e){if(e===a)return b})};return this}function h(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var b in a)if(a.hasOwnProperty(b)){var e=this._options.getOption(b);if(!e)throw e=this._messageForViolation.replace(this._optionName,b),Error(e);if("object"===typeof e&&!e.validate(a[b]))throw e=this._messageForViolationWithValue.replace(this._optionName,b),e=e.replace(this._valueName,a[b]),Error(e);}};return this}function g(a){try{A.validate(a)}catch(e){console.error(e)}var c=k.filter(a),c=l.extend(c,b(a));return l.ajax(c)}function b(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function e(b){try{E.validate(b)}catch(e){console.error(e)}var k={url:F,options:u.filter(b)},g=new l.Deferred;k.url=b.url;if(b.data){if(b.data&&b.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof b.data)k.options.params=b.data;else if("string"===typeof b.data)c.isSetParamsFormatAsStirngWeblabOn()?
"GET"===b.type?k.url+="?"+b.data:(k.options.params=b.data,k.options.paramsFormat="string"):k.url+="?"+b.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(b.type){if(b.type&&b.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");k.options.method=b.type}if("crossDomain"in b){if("crossDomain"in b&&"withCredentials"in b)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
k.options.withCredentials=b.crossDomain}k=d(k,b,g);k=p(k,b,g);k=B(k,b,g);k=n(k,b,g);k=t(k,b,g);b.beforeSend&&b.beforeSend(k.options);k=w(k,b,g);b=a.ajax(k.url,k.options);return b=g.promise(b)}function p(a,b,e){var c=a.options.success;a.options.success=function(a,b,d){c&&c(a,b,d);e.resolve(a,b,d)};var d=a.options.error;a.options.error=function(a,b,c){d&&d(a,b,c);e.reject(a,b,c)};var k=a.options.abort;a.options.abort=function(a){k&&k(a);e.reject(a,"abort")};return a}function d(a,b){if(!b.complete)return a;
var e=a.options.success;a.options.success=function(a,c,d){e&&e(a,c,d);b.complete(d,"success")};var c=a.options.error;a.options.error=function(a,e,d){c&&c(a,e,d);b.complete(a,"error")};var d=a.options.abort;a.options.abort=function(a){d&&d(a);b.complete(a,"abort")};return a}function n(a,b){var e=a.options.success;a.options.success=function(a,c,d){e&&("text"===b.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),e(a,c,d))};return a}function B(a,b){if(!b.useXMLHttp)return a;var e=a.options.success;
a.options.success=function(a,b,c){c&&(c=c.http);e(a,b,c)};var c=a.options.error;a.options.error=function(a,b,e){a&&(a=a.http);c(a,b,e)};var d=a.options.abort;a.options.abort=function(a){a&&(a=a.http);d(a)};return a}function t(a,b){var e=a.options.success;a.options.success=function(a,b,c){c&&304===c.http.status?e(a,"notmodified",c):e(a,"success",c)};var c=a.options.error;a.options.error=function(a,b,d){a&&a.http.readyState<z.DONE?c(a,"timeout",d):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
z.DONE?e(a.http.responseText,"success",a):a&&0==a.http.status?c(a,"abort",d):c(a,"error",d)};return a}function w(a,b){var e=a.options.success;a.options.success=function(a,b,c){x(c,"success");e(a,b,c)};var c=a.options.error;a.options.error=function(a,b,e){x(a,"error");c(a,b,e)};return a}function x(a,b){a?(m.increaseCount("AUI:Ajax:"+b+":xhr:defined"),a.http?m.increaseCount("AUI:Ajax:"+b+":xhr:http:defined"):a.http===F?m.increaseCount("AUI:Ajax:"+b+":xhr:http:undefined"):null===a.http&&m.increaseCount("AUI:Ajax:"+
b+":xhr:http:null")):a===F?m.increaseCount("AUI:Ajax:"+b+":xhr:undefined"):null===a&&m.increaseCount("AUI:Ajax:"+b+":xhr:null")}var z={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},k=new f("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
u=new f("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),I=new f(u,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),v=new f(k,["params"]),E=new h({allowedOptions:I,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),A=new h({allowedOptions:v,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),N=l("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==N&&"AUI"!==N&&(N="jQuery");return{default:function(a){try{E.validate(a),A.validate(a)}catch(b){console.error(b)}if("jQuery"===
N)g(a);else if("AUI"===N)e(a);else throw Error("Unknown AJAX method: "+N);},jQuery:g,aui:e,READY_STATE:z}});"use strict";r.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isAjaxStreamingEnabled:function(){return"1"===a("meta[name\x3dENABLE_AJAX_STREAMING]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==
a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},
sospPartialAvailabilityWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},removesGiftOptionOnRush:function(){return"1"===
a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===
a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},isUpdateMobileNumberEnabled:function(){return"1"===a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},isPyoClientSideInitiationEnabled:function(){return"1"===a("meta[name\x3dPYO_CLIENT_SIDE_INITIATION]").attr("content")},
isTFXCurrencyToggleOnTabletFixed:function(){return"1"===a("meta[name\x3dTFX_CURRENCY_TOGGLE_ON_TABLET_FIXED]").attr("content")},isTFXGuaranteedExchangeFeeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TFX_GUARANTEED_EXCHANGE_FEE]").attr("content")},isCSMErrorLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_ERROR_LOGGING]").attr("content")},isLogAFFNFallbackEnabled:function(){return"1"===a("meta[name\x3dENABLE_AF_FN_FALLBACK]").attr("content")},isExecutionIdInQueryStringEnabled:function(){return"1"===
a("meta[name\x3dADD_EXECUTION_ID_TO_QUERY_STRING]").attr("content")},isDigitalAsinIndexingFixedOnSOSPEnabled:function(){return"1"===a("meta[name\x3dDIGITAL_ASIN_INDEXING_FIXED_ON_SOSP]").attr("content")},isCvfOldAmazonUiFixesEnabled:function(){return"1"===a("meta[name\x3dCVF_OLD_AUI_FIXES]").attr("content")},isHeadersCleaned:function(){return"1"===a("meta[name\x3dCLEAN_UP_HEADERS]").attr("content")},isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled:function(){return"1"===a("#is-item-assoc-delete-confirmation-popover-for-wireless-plans").val()},
isSsdMdwEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SSD_MDW]").attr("content")},isExcludeMdwFromGoldenCXWidgetRenamingWeblabEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_GOLDEN_CX_WIDGET_RENAMING_EXCLUDE_MDW]").attr("content")},isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SD_NOT_DIGITAL]").attr("content")},isEGiftOptionsActive:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_EGIFT_OPTIONS_MOBILE]").attr("content")},
isPipelineDispatchSendHeaderEnabled:function(){return"1"===a("meta[name\x3dSEND_HEADER_FOR_PIPELINE_REQUEST]").attr("content")},isIngressEnabled:function(){return"1"===a("meta[name\x3dINGRESS_ENABLED]").attr("content")},isISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_ISPU_MASTER]").attr("content")},isRushISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_RENDER_RUSH_ISPU_MASTER]").attr("content")},isProgressiveOrderReviewCardAnchorEnabled:function(){return 1===
a("#progressive-order-review-card-anchor").length},isHandlingMultipleFormIdEnabled:function(){return"1"===a("meta[name\x3dCJ_ARX_HANDLING_MULTIPLE_FORM_CHECKOUT_TSPC]").attr("content")},isTaxExemptionMessagingFixed:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TAX_EXEMPTION_MSGING]").attr("content")},isProgressiveOrderReviewScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESSIVE_SCROLLING_FIX]").attr("content")},isVasTrueSPCEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_VAS_TRUESPC]").attr("content")},
isSecureUnifiedDeliveryEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SECURE_UNIFIED_DELIVERY]").attr("content")},isChooseSDOButtonMultiClickFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TSPC_CHOOSE_SDO_BUTTON_MULTI_CLICK_FIX]").attr("content")},isClearTemporaryPreferenceFixRemoveEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SWP_REMOVE_TPP_FIX]").attr("content")},isPageConductorConvergenceEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PAGE_CONDUCTOR_TANGO_INGRESS_CONVERGENCE]").attr("content")},
isSkipZeroShippingSpeedShipmentEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SKIP_ZERO_SHIPPING_SPEED_SHIPMENT]").attr("content")},isScheduleDeliveryHiddenInputIdFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SCHEDULE_DELIVERY_HIDDEN_INPUT_ID_FIX_ENABLED]").attr("content")},isIngressEDGSetterResponseHandlerEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_INGRESS_EDG_SETTER_RESPONSE_HANDLER_ENABLED]").attr("content")},isProgressiveIndicatorScrollingFixEnabled:function(){return"1"===
a("meta[name\x3dRCX_CHECKOUT_PROGRESS_INDICATOR_SCROLLING_FIX]").attr("content")},isOrderSummaryUpsellWidgetUpdateEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PAGE_CONDUCTOR_OSU_WIDGET_UPDATE_ENABLED]").attr("content")},isPrimePresentationLoggerEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PRIME_PRESENTATION_LOGGER_ENABLED]").attr("content")},isSnsChangeOrderTypeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SNS_CHANGE_ORDER_TYPE_ENABLED]").attr("content")},
isPrefetchUrlTaggingWeblabEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PREFETCH_URL_TAGGING_ENABLED]").attr("content")},isAllowlistingQueryParametersEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_ENABLE_ALLOWLISTING_QUERY_PARAMETERS_DURING_FORM_SUBMISSION]").attr("content")},isTaxRegistrationChewbaccaUrlEnabled:function(){return"1"===a("meta[name\x3dTAX_REGISTRATION_CHEWBACCA_URL_ENABLED]").attr("content")},isSDIncentiveFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_FIX_AD_NR_INCENTIVE_ENABLED]").attr("content")},
isBRMarketplaceCurrencyFormatEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_BR_MARKETPLACE_CURRENCY_FORMAT]").attr("content")},isProgressIndicatorPaySelectFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESS_INDICATOR_PSP_FIX_ENABLED]").attr("content")},isMaxPrefetchRetryRestrictionEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PREFETCH_MAX_RETRY_RESTRICTION_ENABLED]").attr("content")}}});"use strict";r.when("A","client-side-metrics").register("weekend-availability-expander-helper",
function(a,l){function m(a){return(a=g[a])?h("#weekend-availability-expander-header-text-"+a).text():h("#weekend-availability-default").text()}function c(){return 1==h("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?!0:!1}function f(a,e){return a&&e?"BOTH":a?"SAT":e?"SUN":"NONE"}var h=a.$,g={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:c,logExpanderState:function(a,e,c,d){l.increaseCount("checkout:delivery-preferences:"+a+
":expander:"+e+":"+(c&&d?"neverExpanded":d?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var e=!1,p=!1;if(c()){if("BOTH"===a||"SAT"===a)e=!0;if("BOTH"===a||"SUN"===a)p=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)e=!0;if("BOTH"===a||"OTH"===a||"SUN"===a)p=!0}return{isSaturdayChecked:e,isSundayChecked:p}},updateAllOptOutMessages:function(a){1==h("input[name\x3d'isSundayDeliveryPreferenceSuppressed']").attr("value")?a.isSaturdayChecked?h(".weekend-availability-opt-out-box").toggleClass("aok-hidden",
!0):(h(".weekend-availability-opt-out-message").text(h("#weekend-availability-opt-out-sat-text").text()),h(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?h(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(h(".weekend-availability-opt-out-message").text(h("#weekend-availability-opt-out-sun-text").text()),h(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(h(".weekend-availability-opt-out-message").text(h("#weekend-availability-opt-out-sat-text").text()),
h(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(h(".weekend-availability-opt-out-message").text(h("#weekend-availability-opt-out-both-text").text()),h(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1))},updateAllTitles:function(a){a=f(a.isSaturdayChecked,a.isSundayChecked);h(".sat-sun-expander-heading-text").text(m(a))},updateAllWeekendAvailabilityStates:function(a){a=f(a.isSaturdayChecked,a.isSundayChecked);h("input[name\x3d'BusinessHours']").attr("value",a)}}});
"use strict";r.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page","client-side-metrics","weblab-helper").register("address-popovers",function(a,l,m,c,f,h,g,b,e){function p(a){(e.isHeadersCleaned()?a.popoverValid:a.getResponseHeader("x-amz-checkout-popover-valid"))||c.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}})}function d(d,k,n){f.protectAgainstDoubleAction("show-add-address-popover",
200)||(N=d.popover,!A('input[name\x3d"preloadAddressPopover"]').length||k.is(":empty")?(k.empty(),k.css("min-height",397),N.updatePosition(!0),l.showSpinner(k,!1,N),d=(new Date).getTime(),n=g.getCurrentPage(),b.increaseCount("checkout:address-popover-pagetype:".curPage,1),n="itemselect"===n||"spp-itemselect"===n?1:0,e.isHeadersCleaned()?A.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+d,data:{isBilling:q,isMultiAddress:n},dataType:"json",async:!0,cache:!1,
headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,e){p(a);k.css("min-height",0);u(k,a.popoverContent)},error:c.ajaxRedirect}):A.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+d,data:{isBilling:q,isMultiAddress:n},async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,e){p(e);k.css("min-height",0);u(k,a)},error:c.ajaxRedirect})):(h.customizeFormFromIdentity(k),h.countrySpecificPopoverOptimizationCheck(A("html")),
n&&a.trigger("identity-assets")))}function n(a,d){if(!f.protectAgainstDoubleAction("add-new-address",200)){b.resetMetrics();var k=!1;A(".identity-protect-from-errant").each(function(){var a=A(this),a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&(k=!0)});if(k){var n=A(".address-form-security-error:first");n.length?alert(n.text()):alert("Please check that the address you have entered is correct.")}else{d.$event.preventDefault();l.showSpinner(a,!1,N);var g=A("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible"),
n=g.serialize(),h=(new Date).getTime();d=d.$currentTarget.find('input[type\x3d"submit"]').attr("name");"useSelectedAddress"===d?n+="\x26fromSuggestionPage\x3d1":"fromAddressEditToContinue"===d&&(n+="\x26fromAddressEditToContinue\x3d1");A("#addAddressOnly").length&&(n+="\x26addOnly\x3d1");q&&(n+="\x26isBilling\x3d1");var m="/gp/buy/addressselect/handlers/popover/new.html";if(N){if("domestic-address-popover-form"===g.attr("id")&&(g.find(".enterAddressFormField").blur(),g="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",
0<A(g).size())){l.hideSpinner(a);return}m+="/ref\x3dchk_addr_editPopoverSubmit";c.isSPP()&&(N.lock(11),setTimeout(function(){N.unlock(12)},2E3))}var t=null!==T&&T!==F&&null!==Q&&Q!==F;"useSelectedAddress"===d&&!q&&t&&(n+="\x26fromSTMAPopover\x3d1");A("#international-address-popover-form").filter(":visible").length&&(n+="\x26showSecondaryForm\x3d1");v()&&L?B(a,h,n):e.isHeadersCleaned()?A.ajax({type:"POST",url:m+"?cachebuster\x3d"+h,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",
data:n,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,d){c.isSPP()&&N.unlock(12);p(b);b.newPopoverType?w(b,e,b):b.reloadPopover?u(a,b.popoverContent):t?x(b):z("added",b.popoverContent)}}):A.ajax({type:"POST",url:m+"?cachebuster\x3d"+h,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:n,async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,d){c.isSPP()&&N.unlock(12);p(d);d.getResponseHeader("x-amz-checkout-open-new-popover")?w(b,e,d):d.getResponseHeader("x-amz-checkout-reload-popover")?
u(a,b):t?x(d):z("added",d)}})}}}function B(a,b,d){var k=L.getNewTaxAddressPopoverURL();e.isHeadersCleaned()?A.ajax({type:"POST",url:k+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:d,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,d){c.isSPP()&&N.unlock(12);p(b);b.reloadPopover?u(a,b.popoverContent):b.newAddressId&&(A(".a-button-close").trigger("click"),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),L.submitTaxAddressFormWithNewAddressId(b.newAddressId))}}):
A.ajax({type:"POST",url:k+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:d,async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,d){c.isSPP()&&N.unlock(12);p(d);d.getResponseHeader("x-amz-checkout-reload-popover")?u(a,b):d.getResponseHeader("x-amz-checkout-new-address-id")&&(A(".a-button-close").trigger("click"),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),b=d.getResponseHeader("x-amz-checkout-new-address-id"),L.submitTaxAddressFormWithNewAddressId(b))}})}
function t(a){if(!f.protectAgainstDoubleAction("show-edit-address-popover",200)){var b=A("#address-suggestions-popover");a.$event.preventDefault();l.showSpinner(b,!1,N);a=A("#address-popover-suggestions-form");var d=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=A(this);a.attr("checked")&&(d+="\x26edit_"+a.val()+"\x3d1")});q&&(d+="\x26isBilling\x3d1");N&&c.isSPP()&&(N.lock(11),setTimeout(function(){N.unlock(12)},2E3));a=(new Date).getTime();e.isHeadersCleaned()?A.ajax({type:"POST",
url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:d,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,e){c.isSPP()&&N.unlock(12);p(a);w(a,b,a)}}):A.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:d,async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,e){c.isSPP()&&N.unlock(12);p(e);w(a,b,e)}})}}function w(b,d,c){A('input[name\x3d"preloadAddressPopover"]').remove();e.isHeadersCleaned()?(d=c.newPopoverType,
"suggestions"===d?(A("#address-suggestions-popover").empty().append(c.popoverContent),A("#address-suggestions-popover-link").trigger("click")):"edit"===d&&(d=A("#edit-address-popover"),d.empty().append(c.popoverContent),A("#edit-address-popover-link").trigger("click"),u(d,c.popoverContent))):(d=c.getResponseHeader("x-amz-checkout-open-new-popover"),"suggestions"===d?(A("#address-suggestions-popover").empty().append(b),A("#address-suggestions-popover-link").trigger("click")):"edit"===d&&(d=A("#edit-address-popover"),
d.empty().append(b),A("#edit-address-popover-link").trigger("click"),u(d,b)));a.trigger("identity-assets")}function x(a){a=e.isHeadersCleaned()?a.newAddressId:a.getResponseHeader("x-amz-checkout-new-address-id");var b=(new Date).getTime();A.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+b,data:{action:"update-address",lineitems:T,quantities:Q,addresses:a+".home..",returnHTML:0},async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){z("applied",d)}})}function z(b,
d){var e=(new Date).getTime();A('input[name\x3d"shipToAddress"]').length?(b=function(){c.isSPP()?(m.blockAllActions(),m.shrinkPanel(A(".spp-panel.expanded"),!0)):m.show()},c.isNonBlockingAnimationEnabled()?a.delay(b,0):b(),b=g.getCurrentPage(),c.loadPage(b,"",F,{refTag:"chk_addr_editPopoverSubmit"},F,d)):(d=c.setAjaxTransitionHeader(),A.ajax({type:"POST",headers:d,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+e,data:{useCase:"multiAddress",showAddressAdded:b,page:"itemselect"},
dataType:"text",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){c.ajaxUpdatePage(a,b,d);A(".a-button-close").trigger("click");f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}))}function k(a){a=A("#"+a);a.length&&a.empty()}function u(b,d){b.html(d);h.customizeFormFromIdentity(b);N.updatePosition(!0);a.trigger("identity-assets");h.countrySpecificPopoverOptimizationCheck(A("html"))}function I(a){a=a.$currentTarget.closest(".lineitem");T=a.find('input[name^\x3d"lineItemEntityID."]').val();
Q=a.find('input[name^\x3d"quantity."]').val();a=A("#add-address-popover-link");a.length?a.trigger("click"):A("#add-new-address-popover").trigger("click")}function v(){return e.isCreateAddressLinkForTaxAddressFormWeblabOn()&&0<A("#isTaxAddress").length}function E(){q=A("#isBilling").length?1:0;if(e.isInterceptionAddressFormWidthFixEnabled()){var a=A(".enter-address-form");h.customizeFormFromIdentity(a)}}var A=a.$,N,T,Q,q=0,L=null;if(!A("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",
function(a){k("edit-address-popover");k("add-billing-address-popover");q=0;d(a,A("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){k("edit-address-popover");k("add-address-popover");d(a,A("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){N=a.popover}),a.on("a:expander:delivery-expander:toggle:expand",function(a){a=A(".a-expander-content");h.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){r.when("a-popover-base").execute(function(b){(b=
b.get(a.data.popoverName))&&b.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){r.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()});e.isRemoveAddressFormOnDeleteAddressWeblabOn()&&(k("edit-address-popover"),k("add-address-popover"),k("add-billing-address-popover"));r.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),A(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),
a.declarative("select-billing-address-in-popover",["click","touchend"],function(a){a.$event.preventDefault();A("#address-list").submit();r.when("a-popover-base").execute(function(a){a.get("select-billing-address")&&a.remove("select-billing-address")})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){f.protectAgainstDoubleAction("trigger-popover-from-link",200)||(Q=T=null,A("#add-address-popover-link").trigger("click"))}),a.declarative("add-address-popover-submit",["click",
"touchend"],function(a){n(A("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",["click","touchend"],function(a){n(A("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",["click","touchend"],function(a){n(A("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){n(A("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",["click","touchend"],function(a){a=A("#delete-address-button");
0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],t),a.declarative("add-address-popover-edit",["click","touchend"],function(a){if(!f.protectAgainstDoubleAction("add-address-popover-edit",200)){a.$event.preventDefault();var b=A("#add-address-popover");l.showSpinner(b,!1,N);a=A("#address-popover-suggestions-form").serialize()+"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";var d=(new Date).getTime();e.isHeadersCleaned()?A.ajax({type:"POST",
url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+d,data:a,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,d,e){p(a);u(b,a.popoverContent)}}):A.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+d,data:a,async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,d,e){p(e);u(b,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],function(a){f.protectAgainstDoubleAction("add-address-popover-toggle",
200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),h.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked","checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");a.addClass("radio-option-selected")}),a.declarative("trigger-address-popover",["click","touchend"],
function(a){f.protectAgainstDoubleAction("trigger-address-popover",200)||A("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",E),a.on("checkout:reload:spp-billing-address",E),a.on("checkout:reload:itemselect",E),a.on("checkout:reload:spp-itemselect",E),{actionTriggerPopoverFromDropdown:I,actionRegisterTaxAddressController:function(a){v()&&!L&&a&&(L=a)}}});"use strict";r.when("A").register("address-book-controller",function(a){function l(){m("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",
function(){var a,f=m(),h=0,g=m("div.address-book .js-same-height"),b=g.length;g.css({height:"auto"}).each(function(e){var p=m(this);a=a||p.offset().top;a!==p.offset().top&&(f.height(h),f=m(),h=0,a=p.offset().top);var d=p.height();f=f.add(p);d>h&&(h=d);e===b-1&&0<h&&f.height(h)})}).trigger("recalculate-address-height");m(q).unbind("resize.checkout-as").bind("resize.checkout-as",function(){m("div.address-book").trigger("recalculate-address-height")})}var m=a.$;a.on("checkout:reload:spp-shipaddress",
l);a.on("checkout:reload:shipaddressselect",l);a.on("checkout:reload:billingaddressselect",l);a.on("checkout:reload:spp-billing-address",l)});"use strict";r.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,l,m){function c(a){a.find("input").each(function(){var a=b(this),d=a.outerWidth(!0),e=a.parent().outerWidth(!0);d>e&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),a.width("100%"))})}function f(a){if(b('input[name\x3d"useLiveAUI"]').length)r.when("p-detect").execute(function(d){d.capabilities.inputPlaceholder&&
a.find(".field-description").each(function(){var a=b(this),d=a.text(),e=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");e.attr("maxlength")<d.length&&e.attr("size",d.length);e.attr("placeholder",a.text())})}),a.find("input").each(function(){b(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=b(this).closest(".full-width-config"),d=b(this);0===a.find(".a-popover-trigger").length&&(m.isInterceptionAddressFormWidthFixEnabled()?
d.addClass("addressform-textfield-width"):d.width("96%"))});else{r.when("p-detect").execute(function(d){d.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=b(this),d=a.text(),e=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");e.attr("maxlength")<d.length&&e.attr("size",d.length);e.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=b(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=
b(this);a.find("b").each(function(){var a=b(this);a.text(b.trim(a.text()))});a.find("font").each(function(){var a=b(this);"-2"===a.attr("size")&&a.remove()})});var p=b(".enter-address-form");c(p);var d=0,p=a.find(".one-new-address-form-field").first();p.length&&p.find(".a-column").each(function(){d+=b(this).outerWidth()});a.width(0<d?d:"")}}function h(b){function c(){m=n.val();(z=h[m])&&g.find(".learn-more a").text(z.popOverLinkText)}var d=q.P&&q.P.AUI_BUILD_DATE,n=b.find("#enterAddressCountryCode"),
g=b.find(".country-specific-form-input"),f,h;d?(f=g.find("input"),h=b.find(".country-specific-config").data("popovercountryconfig")):(l.increaseCount("removeauijs2"),f=g.find("#"+g.data("inputid")),h=g.find(".country-specific-config").data("popovercountryconfig"));if(n.length&&g.length&&f.length&&h){var m=n.val(),z=h[m];n.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",c);c();var k=d?"show":"beforeShow";a.on("a:popover:"+k+":checkout-"+g.data("inputid")+"Name",function(a){"beforeShow"===
k&&l.increaseCount("removeauijs3");z&&(a.popover.$popover.find(".a-popover-header h4").html(z.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(z.popOverText),a.popover.updatePosition())})}}function g(a){function c(){var a=n.val();(a=h[a])?(a=(a=a.label)||"",f.attr("placeholder",b("\x3cdiv /\x3e").html(a).text().replace(":","")),g.show()):g.hide()}var d=q.P&&q.P.AUI_BUILD_DATE,n=a.find("#enterAddressCountryCode"),g=a.find(".country-specific-form-input-mobile"),f,h;d?(f=g.find("input"),
h=a.find(".country-specific-config").data("labelcountryconfig")):(l.increaseCount("removeauijs3"),f=g.find("#"+g.data("inputid")),h=g.find(".country-specific-config").data("labelcountryconfig"));n.length&&g.length&&f.length&&h&&(n.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){g.hasClass("initial-edit-value")?g.removeClass("initial-edit-value"):f.val("");c()}),c())}var b=a.$;r.when("a-checkbox").execute(function(b){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered",
"click",function(a){if("undefined"!==typeof a.$target){var d=a.$target.val();a.$target.is(":checked")&&("NONE"===d?(b("#delivery-preferences-weekend-availability-sat").uncheck(),b("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==d&&"SUN"!==d||b("#delivery-preferences-weekend-availability-none").uncheck())}})});a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var c=a.$target.context.id;a=b(".com-businesshours-text");var d=b("#delivery-preferences-weekend-availability-sat").is(":checked"),
n=b("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===c?(l.increaseCount("WDPTotalCOMClick"),b(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),b(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),b(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===c?(l.increaseCount("WDPTotalRESClick"),b(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),
b(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),b(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===c?(l.increaseCount("WDPTotalSATClick"),c=d?n?"BOTH":"SAT":n?"SUN":"OTH",a.addClass("aok-hidden"),b(".com-businesshours-"+c).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===c&&(l.increaseCount("WDPTotalSUNClick"),c=n?d?"BOTH":"SUN":d?"SAT":"OTH",a.addClass("aok-hidden"),b(".com-businesshours-"+
c).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,g){a.hide();g.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=b(this),c=a.attr("name")||a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var e=g.find("input[name\x3d'"+c+"']");"enterAddressLandmark"===c&&(e=g.find("input[name\x3d'Landmark']"));"Landmark"!==
c||e.length||(e=g.find("input[name\x3d'enterAddressLandmark']"));1<e.length&&a.is("input[type\x3d'radio']")?e.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):e.is("select")?e.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||e.is("input[type\x3d'hidden']")||e.val(a.val())}});g.show();c(g);f(g)},customizeFormFromIdentity:f,fixOverflow:c,countrySpecificLabelOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){g(b)},
100):g(b)},countrySpecificPopoverOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){h(b)},100):h(b)}}});"use strict";r.when("A","page-conductor","page-transition-controller","client-side-metrics","page-detector-current-page","checkout-general-utils","weblab-helper").register("address-form-helper",function(a,l,m,c,f,h,g){function b(a,b,d){B(".a-button-close").trigger("click");B('\x3cinput name\x3d"addressID"/\x3e').val(a).appendTo(d);B('\x3cinput name\x3d"purchaseId"/\x3e').val(b).appendTo(d);
l.continueClicked(null,d)}function e(a,b){b||(b=B("#address-ui-checkout-form"));d(b);var c=(new Date).getTime();B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+c,data:{action:"update-address",lineitems:t,quantities:w,addresses:a,returnHTML:0},async:!0,cache:!1,error:function(){n(b);l.ajaxRedirect},success:function(a,d,c){p("applied",b)}})}function p(a,b){var d=(new Date).getTime(),c=l.setAjaxTransitionHeader();B.ajax({type:"POST",headers:c,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+
d,data:{useCase:"multiAddress",showAddressAdded:a,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:function(){n(b);l.ajaxRedirect},success:function(a,d,c){n(b);l.ajaxUpdatePage(a,d,c);B(".a-button-close").trigger("click");h.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function d(a){l.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(a)):m.show()}function n(a){l.isSPP()?(m.unblockAllActions(),B(a).find("div.section-overwrap").remove()):m.hide()}var B=a.$,t,w;
a.on("a:popover:afterUpdatePosition:edit-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",b.popover)});a.on("a:popover:afterUpdatePosition:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:visible:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});g.isHandlingMultipleFormIdEnabled()&&
(a.on("a:popover:beforeShow:add-address",function(){a.trigger("checkout:popover-beforeShow:add-address")}),a.on("a:popover:beforeShow:edit-address",function(){a.trigger("checkout:popover-beforeShow:edit-address")}),a.on("a:popover:invisible:add-address",function(){a.trigger("checkout:popover-hide:add-address")}),a.on("a:popover:invisible:edit-address",function(){a.trigger("checkout:popover-hide:edit-address")}),a.on("checkout:reload:spp-shipaddress",function(){a.trigger("checkout:reload:address-page")}));
a.declarative("itemselect-update-address",["change"],function(a){a=a.$currentTarget.closest(".lineitem");t=a.find('input[name^\x3d"lineItemEntityID."]').val();w=a.find('input[name^\x3d"quantity."]').val()});return{setDestination:function(a,d){a||(c.increaseCount("checkout:addressForm:setDestination:noRequest",1),a={});var k=a.addressId;k||c.increaseCount("checkout:addressForm:setDestination:noAddressId",1);var g=a.purchaseId||B("input[name\x3d'purchaseId']").val();g||c.increaseCount("checkout:addressForm:setDestination:noPurchaseId",
1);a=a.ref||"ox_shipaddress_add_new_addr";var n=f.getCurrentPage();if("itemselect"===n||"spp-itemselect"===n)return e(k,d);B('[name\x3d"isBilling"]')&&1==B('[name\x3d"isBilling"]').val()?(a="ox_billing_continue",(d=B("input[name\x3d'paymentInstrumentId']").val())||c.increaseCount("checkout:addressForm:setDestination:noPaymentInstrumentId",1),(n=B("input[name\x3d'paymentMethodCode']").val())||c.increaseCount("checkout:addressForm:setDestination:noPaymentMethodCode",1),a=B("\x3cform/\x3e").attr("action",
"/gp/buy/billingaddressselect/handlers/continue.html/ref\x3d"+a),B('\x3cinput name\x3d"paymentInstrumentId"/\x3e').val(d).appendTo(a),B('\x3cinput name\x3d"paymentMethodCode"/\x3e').val(n).appendTo(a),B('\x3cinput name\x3d"action" value\x3d"select-billing"/\x3e').appendTo(a),B('\x3cinput name\x3d"isAUIWSAddressCreationWorkflow" value\x3d"1"/\x3e').appendTo(a)):(a=B("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a),B('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a));
b(k,g,a)},onPageTransitionStart:d,onPageTransitionComplete:n}});"use strict";r.when("A","client-side-metrics","weblab-helper").register("action-logger",function(a,l){var m=a.$;a.declarative("ue-count",["click","touchend"],function(a){l.increaseCount(a.data.countFlag,a.data.countValue)});return{logUsedPrefetch:function(a,f,h,g){g||(l.increaseCount("Checkout:action-log:MissingRefMarker"),g="");m.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+g,data:"pageType\x3d"+a+"\x26subPageType\x3d"+
f+"\x26relatedRequestId\x3d"+h,dataType:"text",cache:!1})}}});"use strict";r.when("A","weblab-helper").register("ajax-utility",function(a,l){return{jsonify:function(m){var c;if(c=l.isAJAXWeblabOn()){c=m instanceof Function;var f=m instanceof Array,h=m instanceof String;c=m instanceof Object&&!f&&!c&&!h}if(c)return m;try{m=a.$.parseJSON(m)}catch(g){m=null}return m}}});"use strict";r.when("A","page-conductor","client-side-metrics","weblab-helper").register("button-blocker",function(a,l,m,c){function f(a,
b,d,c){l.isSPP()?b.closest("span.a-declarative").data("blockerText",d):b.find("input.a-button-text").data("blockerText",d);h(c);n?(a.addClass("aok-hidden"),b.removeClass("aok-hidden"),g("#hasTVNavigation").length&&r.when("a-tv").execute(function(b){b.remove(a)})):(m.increaseCount("removeauijs10"),a.hide(),b.show(),b.hasClass("aok-hidden")&&b.removeClass("aok-hidden"))}function h(a){var b=g(".continue-button-blocker-text");b.length&&(a?(b.html(a),b.removeClass("aok-hidden")):(b.addClass("aok-hidden"),
b.empty()))}var g=a.$,b={},e=[],p,d,n=q.P&&q.P.AUI_BUILD_DATE,B=!1;c=c.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";a.on(c,function(){e=[];b={};p=""});return{show:function(a,d,c){if(!B){var n=g(".continue-button");if(n.length)if(d){var k=g(".continue-button-blocker");if(k.length){c=c||"";var u=b[a]!==F&&b[a].tooltipText!==d,h=b[a]!==F&&b[a].buttonInlineText!==c;if(0===e.length||!b[a]||u||h)f(n,k,d,c),p=a;b[a]===F&&e.push(a);b[a]={tooltipText:d,buttonInlineText:c}}}else q.console&&
q.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),m.increaseCount("Checkout:ButtonBlocker:EmptyTooltip")}},hide:function(a){if(!B){if(b[a]!==F){delete b[a];var d=g.inArray(a,e);e.splice(d,1)}var c=g(".continue-button");c.length&&(d=g(".continue-button-blocker"),d.length&&(0===e.length?(h(),n?(d.addClass("aok-hidden"),c.removeClass("aok-hidden"),g("#hasTVNavigation").length&&r.when("a-tv").execute(function(a){a.add(c)})):(m.increaseCount("removeauijs11"),
d.hide(),c.show(),c.hasClass("aok-hidden")&&c.removeClass("aok-hidden"))):p===a&&(p=e[0],f(c,d,b[p].tooltipText,b[p].buttonInlineText))))}},lock:function(){B=!0},unlock:function(){B=!1},getButtonBlocker:function(){d||(d=g(".continue-button-blocker"));return d}}});"use strict";r.when("A","button-blocker","client-side-metrics").register("button-blocker-controller",function(a,l,m){function c(a,b){g[a]!==F&&g[a].state!==b&&(g[a].state=b,f())}function f(){var a=!0,d;h.each(g,function(c,g){d=g.owner;if(g.state===
e.DISABLE_CONTINUE)return a=!1,l.show(d,g.toolTipMessage,g.buttonInlineMessage),b||(m.increaseCount("removeauijs12"),h(".continue-button-blocker").css("display","inline-block")),!1});a&&l.hide(d)}var h=a.$,g={},b=q.P&&q.P.AUI_BUILD_DATE,e={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){g={}});return{disableContinue:function(a,b,n,h){h=h||"";g[b]===F&&(n?(g[b]!==F||(g[b]={state:e.ENABLE_CONTINUE,owner:a,toolTipMessage:n,buttonInlineMessage:h}),
f()):q.console&&q.console.error&&console.error("_registerElement should not be called with an empty tooltip."));c(b,e.DISABLE_CONTINUE)},enableContinue:function(a){g[a]!==F&&c(a,e.ENABLE_CONTINUE)}}});"use strict";r.when("jQuery").register("cache-page-data-controller",function(a){var l={};return{clearCache:function(){l={}},setCachedPageData:function(m,c,f,h,g){var b=[],e=!0;a(".cacheable-spp-panel").each(function(){var d=a(this),c;c=!d||d.find(".is-scheduled-delivery").length?!1:!0;if(!c)return e=
!1;d.find(".expand-panel-button").removeClass("a-button-focus");b.push({id:d.attr("id"),content:d[0].outerHTML})});if(e){var p={panels:b};a(".cacheable-spp-section").each(function(){var b=a(this);p[b.attr("id")]=b[0].outerHTML});l[m+"-"+c]={curPageData:p,state:q.history?history.state:f,page:m,title:document.title||h,url:q.location.href||g}}},getCachedPageData:function(a,c){return l[a+"-"+c]}}});"use strict";r.when("A").register("checkout-general-utils",function(a){function l(a,b,e,p){var d=f.getAssocParamValuesFromUrl(a);
!e&&p?delete d[b]:d[b]=e;b=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;b=b+"?"+c.param(d,1);(a=f.getFragmentFromUrl(a))&&(b+="#"+a);return b}function m(a){a=a||document.location.pathname;var b;c.each(h,function(c,f){if((c=f.validator)&&c.test(a))return b=f,!1});b||(b=h.UNKNOWN);return b.type}var c=a.$,f={moveToNextInput:function(a){a=a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},hide:function(a){a.hide()},show:function(a){q.P&&q.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&a.removeClass("aok-hidden");
a.show()},getAssocParamValuesFromUrl:function(a){var b={};if("string"!==typeof a||-1===a.indexOf("?"))return b;a=a.slice(a.indexOf("?")+1);if(!a)return b;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var c=0;c<a.length;c++){var f=a[c].split("\x3d");b[f[0]]=f[1]}return b},addQueryStringParameter:function(a,b,c){return l(a,b,c,!1)},addQueryStringParameterOrDeleteIfEmpty:function(a,b,c){return l(a,b,c,!0)},getQueryStringParameter:function(a,b){a=f.getAssocParamValuesFromUrl(a);
return b in a?a[b]:F},getFragmentFromUrl:function(a){var b=a.indexOf("#");return-1==b?F:a.substring(b+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var b={};a&&(a[1]&&(b.normalizedUrl=a[1]),a[2]&&(b.refMarker=a[2]),a[3]&&(b.query=a[3]));return b},buildFilteredQueryString:function(a,b){var c="?";if(null==a||null==b)return"";b.forEach(function(b){var d=f.getQueryStringParameter(a,b);d&&(c=f.addQueryStringParameterOrDeleteIfEmpty(c,b,
d))});return"?"===c?"":c},redirectWithJavascript:function(a){q.location=f.addQueryStringParameter(a,"hasWorkingJavascript","1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===a.which&&c(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,b,e){c.trim(a);return/^\d+$/.test(a)&&a>=b&&a<=e}};f.protectAgainstDoubleAction=
function(){var a={};return function(b,c){if(!b)return q.console&&q.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(b))return!0;a[b]=1;setTimeout(function(){delete a[b]},c||100);return!1}}();f.logErrorOnLevel=function(a,b){(q.ueLogError||c.noop)({message:a,logLevel:b});if(q.console){var e={FATAL:q.console.error,"default":q.console.warn};b=e[b]||e["default"]}else b=c.noop;b.call(q,a)};f.logError=function(a){f.logErrorOnLevel(a,
"FATAL")};f.updateCartByMash=function(a){r.when("safe-mash").execute(function(b){null!==a&&a!==F&&"1"===c("#updateCartByMash").attr("content")&&b&&b.cart&&b.cart.didUpdate&&b.cart.didUpdate({newCartQuantity:a})})};f.getPosition=function(a,b,c){for(var f=0,d=a.length,n=0;n<d;n++)if(a.charAt(n)===b&&(f++,f===c))return n;return-1};f.limitInputToNumbers=function(a){var b=a.$event.keyCode;-1!==c.inArray(b,[46,8,9,37,39])||-1!==c.inArray(b,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>b||57<b)&&
(96>b||105<b))&&a.$event.preventDefault()};f.nukeDropdowns=function(a){r.when("a-popover-base").execute(function(b){c.each(c(a),function(){b.remove(this.name)})})};var h={GURUPA:{type:"gurupa",validator:/.*\/gp\/buy\/.*/},CHEWBACCA:{type:"chewbacca",validator:/.*\/checkout\/p\/.*/},UNKNOWN:{type:"unknown"}};"function"===typeof Object.freeze&&Object.freeze(h);f.getUrlType=m;f.isChewbaccaUrl=function(a){return m(a)===h.CHEWBACCA.type};a.on("checkout:reload",function(){c('input[name\x3d"useLiveAUI"]').length||
a.defer(function(){c(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&c(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){c("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return f});"use strict";r.when("A","weblab-helper").register("client-side-metrics",function(a,l){var m=a.$,c=null,f=null,h=0,g,b=a.capabilities&&a.capabilities.isAmazonApp||
q.amazon&&q.amazon.mash;a=function(){};var e=q.uet||a,p=q.uex||a,d=!1,n=!1,B=function(a){q.ue&&q.ue.t&&(q.uet(a,c),v("checkout:client-side-metrics:uet:marker:"+a,1,1),null===c&&null===f&&q.ue.isl&&(v("checkout:client-side-metrics:mark:at",1,1),q.uex("at")));"af"===a?d=!0:"fn"===a&&(n=!0)},t=function(a){q.ue&&q.uex&&(q.uex(a,c),v("checkout:client-side-metrics:uex:marker:"+a,1,1))},w=function(a){q.ue&&q.ues&&q.ues("id",c,a)},x=function(){q.ue&&q.ues&&q.ues("ctb",c,"1")},z=function(){q.ue&&q.ues&&(b&&
B("mts",c),q.ues("t0",c,(new Date).getTime()),B("ue"),B("bb"))},k=function(a){a?f="ctbajax"+h++:c="ajax"+h++};a=function(a){c=a};var u=function(){return c},I=function(){return f},v=function(a,b,c){"undefined"!==typeof q.ue&&"undefined"!==typeof q.ue.count&&(b=b?b:1,c?q.ue.count(a,(q.ue.count(a)||0)+1):q.ue.count(a,b))},E=function(a){if(a&&a.length){var b=c;c=f;w(a);c=b}},A=function(){g===F&&(g=0<m("#transitionLogging").length);return g},N=function(a,b,c,d){q.ueLogError&&q.ueLogError(a,{message:b,
attribution:c,logLevel:d})};return{getscope:u,getasyncscope:I,setmarker:B,sendue:t,setrid:w,setctb:x,resetue:z,createscope:k,setscope:a,getScope:u,getAsyncScope:I,setMarker:B,sendUe:t,setRid:w,setCtb:x,resetUe:z,createScope:k,setScope:a,increaseCount:v,resetMetrics:function(){c=f;x();z()},setAsyncRequestId:E,sendUEPageLoadStats:function(){!l.isCSMErrorLoggingEnabled()||d&&n||N({message:"Logged ld without both af and fn logged first af:"+d+" fn:"+n},"","checkout-client-side-metrics","WARN");l.isLogAFFNFallbackEnabled()&&
(!0===d&&v("checkout:client-side-metrics:page-load-stats:earlyaf",1),v("checkout:client-side-metrics:page-load-stats:af",1),B("af"));l.isLogAFFNFallbackEnabled()&&(!0===n&&v("checkout:client-side-metrics:page-load-stats:earlyfn",1),v("checkout:client-side-metrics:page-load-stats:fn",1),B("fn"));t("ld");k(1);n=d=!1},isTransitionLoggingEnabled:A,logPageTransition:function(a,b,c,d){if(A()){var e=(new Date).getTime();m.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+
e,data:{fromPage:a,toPage:b},async:!0,cache:!1,timeout:1E3,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-requestid");E(e);c&&c.call(this,a,b,d)},complete:function(a,b){d&&d.call(this,a,b)}})}},logError:N,startWidgetTiming:function(a){e("bb",a,{wb:1})},finishWidgetTiming:function(a){p("ld",a,{wb:1})},setMarkerForWidget:function(a,b){e(a,b,{wb:1})},emitNexusMetrics:function(a,b,c){"undefined"!==typeof q.ue&&"undefined"!==typeof q.ue.event&&q.ue.event(a,b,c)},setCountValue:function(a,
b){v(a,b,!1)}}});"use strict";r.register("currency-formatter",function(){function a(l,m){isNaN(m)||(l=Number(l).toFixed(m));l=l.toString();m=0<=l.lastIndexOf(".")?l.lastIndexOf("."):l.length;return 3>=m?l:a(l.substring(0,m-3),0)+","+l.substring(m-3)}return{getNumberWithSeparators:a}});"use strict";r.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,l,m,c){function f(a){var e=m.isSPP()?"spp":"mpp",f="desktop";c.isMobile()?f="mobile":
c.isTablet()&&(f="tablet");l.increaseCount("checkout:delivery-preferences:"+f+":"+e+":"+a,1)}function h(a){return 0===a.length?"NoValueSet":a}var g=a.$;return{recordCSM:f,recordCSMWithCurrentFieldValues:function(a,c,p){c=g("input[name\x3d"+c+"]:checked");c.length&&(c=c.val(),f(a+":preference:"+h(c)));p=g("input[name\x3d"+p+"]");p.length&&f(a+":set-as-default:"+(p.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";f(a+"eligible-page-displayed");var c=g("input[name\x3ddelivery-preferences-preference-set]");
c.length&&f(a+"summary-displayed:preference:"+h(c.val()))}}});"use strict";r.when("A").register("error-feature-detection",function(a){function l(a){q.errorFeatureDetection&&q.errorFeatureDetection.safelyLogError?q.errorFeatureDetection.safelyLogError(a):(q.ueLogError&&q.ueLogError(a),q.console&&q.console.error&&console.error(a))}try{a.on("page-detector:page-changed",function(){r.now("page-detector-current-page").execute(function(a){if((a=a.getCurrentPage())&&"spc"===a)try{q.errorFeatureDetection&&
q.errorFeatureDetection.enableErrorHandling&&q.errorFeatureDetection.enableErrorHandling()}catch(c){l(c)}else try{q.errorFeatureDetection&&q.errorFeatureDetection.disableErrorHandling&&q.errorFeatureDetection.disableErrorHandling()}catch(c){l(c)}})})}catch(m){l(m)}return{registerFeature:function(a,c){try{q.errorFeatureDetection&&q.errorFeatureDetection.registerFeature&&q.errorFeatureDetection.registerFeature(a,c)}catch(f){l(f)}},markFeatureAvailable:function(a){try{q.errorFeatureDetection&&q.errorFeatureDetection.markFeatureAvailable&&
q.errorFeatureDetection.markFeatureAvailable(a)}catch(c){l(c)}},markFeatureUnavailable:function(a){try{q.errorFeatureDetection&&q.errorFeatureDetection.markFeatureUnavailable&&q.errorFeatureDetection.markFeatureUnavailable(a)}catch(c){l(c)}}}});r.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";r.when("A","page-transition-controller").execute(function(a,
l){a=a.$;"1"===a("#showSpinnerOnProceedToCheckout").attr("content")&&(l.show(),r.when("ready").execute(function(){l.hide()}))});"use strict";r.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,l,m,c,f,h){function g(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,
String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function b(a){var b=t.$popover.find(".rewards-registration");l.hideSpinner(b);b.children("div").hide();b=b.find(".rewards-registration-error");a&&a.error?(a=b.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():b.find("[data-error\x3d'rewards_SystemUnavailable']").show()):b.find("[data-error\x3d'rewards_SystemUnavailable']").show();b.fadeIn(300)}function e(a){t=a.popover;var c=
t.$popover.find(".rewards-registration");l.showSpinner(c,!1,t);a=c.data("issuer-id");var d=c.data("program-id"),e=c.data("cc-issuer"),n=c.data("cc-brand"),c=c.data("parent-payment-method-id"),f="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();B.ajax({type:"POST",url:f,data:"programid\x3d"+d+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+c+"\x26issuer\x3d"+e+"\x26brand\x3d"+n+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:function(a){return m.jsonify(a)},
success:function(a,b,c){b=t.$popover.find(".rewards-registration");l.hideSpinner(b);c=a.fields||{};for(var d in c)if(c.hasOwnProperty(d)){var e=c[d],k=b.find("[data-field\x3d'"+e.type+"']");e.value&&k.filter("input").attr("value",e.value);k.parents(".rewardsfield").show()}a.termshtml&&b.find(".rewardstermstext").html(g(a.termshtml));a.billingzip&&b.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",a.billingzip);if(a.displaydata){d=b.find("[data-field]");for(var n in a.displaydata)a.displaydata.hasOwnProperty(n)&&
d.filter("[data-field\x3d"+n+"]").html(a.displaydata[n])}a.marketinglink&&b.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);b.find("#rewards-registration-image").show();b.find(".rewards-registration-main").fadeIn(300);t.updatePosition(!0)},error:function(a){b(a)}})}function p(){if(t){var a=t.$popover.find(".rewards-registration");l.hideSpinner(a);a.find(".rewards-registration-success").hide();a=a.find(".rewards-registration-error");a.hide();a.find("h4").hide();w&&(h.show(),
f.isSPP()?f.reloadPage():B("div.pay").length?f.loadPage("payselect","payselect"):B("div.spc").length&&f.loadPage("spc","spc"))}}function d(a){return a.is("input")?a:a.find("input")}function n(){if(t){var a=t.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();l.showSpinner(a,!1,t);var e=(new Date).getTime(),k="programid\x3d"+encodeURIComponent(a.data("programId")),k=k+("\x26paymentinstrumentid\x3d"+encodeURIComponent(a.data("parent-payment-method-id"))+
"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+e),n=a.find("[data-field]");n.each(function(){var a=B(this).attr("data-field");if("CVV2"===a)k+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(B(this).val());else if(B(this).data("entryindex")){if(1===B(this).data("entryindex")){var b=n.filter("[data-field\x3d"+a+"]").sort(function(a,b){return Number(B(a).data("entryindex"))-Number(B(b).data("entryindex"))});k+="\x26"+a+"\x3d";b.each(function(){k+=encodeURIComponent(B(this).val())})}}else"TERMS_AND_CONDITIONS"===
a?d(B(this)).is(":checked")&&(k+="\x26"+a+"\x3dtrue"):k+="\x26"+a+"\x3d"+encodeURIComponent(B(this).val())});e="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(e+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+e+"?cachebuster\x3d"+(new Date).getTime();B.ajax({type:"POST",url:a,data:k,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return m.jsonify(a)},success:function(a,d,e){a?a&&0===a.success?b(a):t&&(d=t.$popover.find(".rewards-registration-success"),
d.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(d.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),d.find("[data-field\x3d'pointsamount']").html(c.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),d.find(".rewardsuccessbalance").show()),a.showwarnmessage&&d.find(".warnmessage").show(),w=!0,d.fadeIn(300),l.hideSpinner(t.$popover.find(".rewards-registration"))):b()},error:function(a){b(a)}})}}var B=a.$,t,w=!1;a.on("a:popover:show:rewards-registration",
e);a.on("a:popover:hide:rewards-registration",p);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();n(a)});a.declarative("toggle-reward-signup-button","change",function(a){a=a.$target;var b=t.$popover.find(".rewards-registration");a&&a.is(":checked")?(b.find("#reward-signup-button").removeClass("aok-hidden"),b.find("#disabled-reward-signup-button").addClass("aok-hidden")):
(b.find("#reward-signup-button").addClass("aok-hidden"),b.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(B(".cvv2helpcontent").text());a.popover.updatePosition()});return{displayRewardsRegister:e,hideRewardsRegister:p}});"use strict";r.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,l,m){var c=a.$;a.on("checkout:reload",function(){(c("body.a-touch").length||
c("div.a-touch:first").length)&&c("html").addClass("a-touch");c("form").each(function(){var a=c(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):c(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});m&&(c("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=c(this).attr("href"),a=a+(0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal"),a=a.replace("#","");c(this).attr("href",a);c(this).removeAttr("data-action");
c(this).removeAttr("data-help-popup");c(this).removeAttr("onclick")}),c("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=c(this).attr("href"),a=a.replace("#","");c(this).attr("href",a);c(this).removeAttr("data-help-popup");c(this).removeAttr("onclick");c(this).addClass("a-declarative help-popup");c(this).attr("data-action","help-popup")}));if(0<c("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),h=0;h<a.length;h++)a[h].href||(a[h].href="#")});c(document).bind("jsdetection",
function(){l.markFeatureAvailable("javascript-detection")})});r.when("A","safe-mash","ready").execute(function(a,l){var m=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");l&&l.navigate?l.navigate({url:a}):q.location.href=a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var f=m(q),h=m(document),g=a.$currentTarget.offset().top,b=0,e=
0,p=function(){q.setTimeout(function(){f.scrollTop(g);b===h.height()?e++:(e=0,b=h.height());10>e&&p()},10)};p()}})});q.amz_js_PopWin=function(a,l,m){(a=q.open(a,l,m))&&a.focus&&a.focus();return!1};var la=!1;q.confirmPurchase_onSubmit||(q.confirmPurchase_onSubmit=function(){return la?!1:la=!0});"use strict";r.when("A","error-feature-detection","loading-spinner-spp-controller","loading-spinner-aui-controller").register("loading-spinner-controller",function(a,l,m,c){function f(){return b("#checkout-spinner").length}
function h(a){if(e&&p){var c,n,f;B&&x?(a=B.getContent(),c=a.innerHeight(),n=a.innerWidth()):(c=a.height(),n=a.width());f=a.offset();a=p.width();var h=p.height();if(d)f="1"===b("input[name\x3dfromAnywhere]").val()?b(document).height():b(q).height(),e.width(b(document).width()).height(f).css("left","0px").css("z-index",2E3),p.css("left",n/2-a/2+"px").css("top",c/2-h/2+"px").css("z-index",4E3).show();else{var g=b(q),m=x?g.scrollLeft():0;e.css("position","fixed").width(n).height(c).css("z-index",3E3).css("left",
f.left-m).css("top",f.top-g.scrollTop());t?p.css("position","fixed").css("left",f.left-m+(n/2-a/2)+"px").css("top",f.top-g.scrollTop()+(c/2-h/2)+"px").css("z-index",4E3).show():p.css("left",n/2-a/4+"px").css("top",c/2-h/4+"px").css("z-index",4E3).show()}}}function g(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",c=b("#first-pipeline-load-page-spinner-img");c.length&&(a=b.trim(c.attr("src")));1>b("#loading-spinner-blocker-doc").length&&(a=
b(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e','\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),
p=e=n=null,"1"===b("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),b("body").prepend(a));b("input[name\x3duseModifiedSpinnerResizeFn]").length&&(t=!0);b("#useRelativeSpinner").length&&(w=!0);b("#modifiedBlockerDivSize").length&&(x=!0)}var b=a.$,e,p,d,n,B,t=!1,w=!1,x=!1,z=!1;a.on("a:popover:positionUpdated",function(a){if(x&&B&&B.name===a.popover.name&&e&&p){var c=B.getContent();a=c.innerHeight();var d=c.innerWidth(),c=c.offset(),
n=b(q);e.width(d).height(a).css("left",c.left-n.scrollLeft()).css("top",c.top-n.scrollTop());p.css("left",c.left-n.scrollLeft()+(d/2-p.width()/2)+"px").css("top",c.top-n.scrollTop()+(a/2-p.height()/2)+"px")}});g();a.on("checkout:reload",g);return{showSpinner:function(a,u,g){if(w&&!u&&x&&t&&g)return z=!0,m.showSpinner(a,g);f()?c.showSpinner():(z=!1,0!==a.length&&(B=(d=u)?F:g,n||(n=b(".loading-spinner.template").clone().removeClass("template"),n.show()),a.append(n),d?(e=b("#loading-spinner-blocker-doc"),
a.find(".loading-spinner-blocker").hide()):e=a.find(".loading-spinner-blocker"),e.show(),d&&l.markFeatureUnavailable("continue-action"),p=a.find(".loading-spinner-inner"),h(a)))},hideSpinner:function(a,b){if(f())return c.hideSpinner();if(z)return z=!1,m.hideSpinner(a,b);z=!1;e&&(d&&(e.hide(),l.markFeatureAvailable("continue-action")),n.detach());b&&a.hide()},adjustSize:function(a){return f()?c.adjustSize():z?m.adjustSize():h(a)}}});"use strict";r.when("A","error-feature-detection").register("loading-spinner-spp-controller",
function(a,l){function m(){if(f&&h){var a=b.innerHeight(),c=b.innerWidth();f.width(c).height(a);h.css("left",c/2-h.width()/2+"px").css("top",a/2-h.height()/2+"px")}}var c=a.$,f,h,g,b,e;a.on("a:popover:positionUpdated",function(a){e&&e.name===a.popover.name&&m()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=c("#first-pipeline-load-page-spinner-img");b.length&&(a=c.trim(b.attr("src")));1>c(".loading-spinner-spp").length&&
(a=c(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e','\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),h=f=g=null,"1"===c("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),c("body").prepend(a))});return{showSpinner:function(a,d){0!==a.length&&
(e=d,b=a,g||(g=c(".loading-spinner-spp.template").clone().removeClass("template"),g.show()),d.getContent().before(g),b.prepend(g),f=b.find(".loading-spinner-spp-blocker"),f.show(),h=b.find(".loading-spinner-spp-inner"),m())},hideSpinner:function(a,b){f&&g.detach();b&&a.hide()},adjustSize:m}});"use strict";r.when("A","error-feature-detection").register("loading-spinner-aui-controller",function(a,l){function m(){return c("#checkoutDisplayPage").outerHeight()}var c=a.$;return{showSpinner:function(){l.markFeatureUnavailable("continue-action");
var f=c("#checkout-spinner");a.show(c("#checkout-spinner-overwrap").height(m()));f.attr("aria-busy","true");a.show(f)},hideSpinner:function(){l.markFeatureAvailable("continue-action");var f=c("#checkout-spinner");a.hide(c("#checkout-spinner-overwrap"));f.attr("aria-busy","false");a.hide(f)},adjustSize:function(){var f=c("#checkout-spinner-overwrap");f.is(":visible")&&a.show(f.height(m()))}}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils",
"client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer","widget-streamer-utils","weblab-helper","temporary-preference-indicator","payment-marketplace-helper").register("page-conductor",function(a,l,m,c,f,h,g,b,e,p,d,n,B,t){function w(a){q.ueLogError&&q.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function x(a){M&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),a["x-amz-checkout-type"]||
(a["x-amz-checkout-type"]="spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});n.isPipelineDispatchSendHeaderEnabled()&&(a?a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"):a={"x-amz-checkout-transition":"ajax"});return a}function z(){ta=!1;Y=null;ra=0;ha=!1;ma=R=ja=null}function k(a){var b=parseInt(P("#checkoutDisplayPage").data("delaySetTitle"),10)||0;b?q.setTimeout(function(){document.title=a},b):document.title=a}function u(b){"function"===typeof a.state.parse&&
a.state.parse();a.trigger("checkout:beforeReload");a.trigger("checkout:reload");b&&("spp-revieworder"===b?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+b));a.trigger("checkout:afterReload")}function I(a){l.show();var b="/gp/buy/addtocart/handlers/display.html";a&&(b+="?errorType\x3d"+a);q.location=b}function v(b){(b=P("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+b)}function E(b,c){var d;if(c.getResponseHeader("x-amz-force-full-page-update"))A(b);else{if(c.getResponseHeader("x-amz-checkout-redirect-addtocart")){(c=
m.jsonify(b))?I(c.errorCode):I();return}d=Da(b)}b=P("#pipelinedPageTitle").text();k(b);var e=c.getResponseHeader("x-amz-checkout-page");M?a.delay(function(){u(e)},d):u(e)}function A(a){var b=document.open("text/html","replace");b.write(a);b.close()}function N(a,b,c){try{if(b.getResponseHeader("x-amz-force-full-page-update"))A(a);else{if(!na)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");na(a,c)}}catch(d){a="Error while replacing page content.",
d.message&&(a+="  Error message: "+d.message),r.error(a,"page-conductor","replaceDisplayPage",d)}a=P("#pipelinedPageTitle").text();k(a);b=b.getResponseHeader("x-amz-checkout-page");u(b)}function T(a){var b=parseInt(P("#showPageTransition").attr("content"),10);(b=isNaN(b)?1:b)||l.hide();b="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?b=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(b=a.pipedata.conductoraction.url));
b=0<b.indexOf("?")?b+"\x26":b+"?";P("input[name\x3dfromAnywhere][value\x3d1]").length&&(b+="fromAnywhere\x3d1");b=da(b);g&&P("html").hasClass("a-tablet")&&-1<b.indexOf("/gp/cart/view.html")&&(b="/gp/aw/c?app-action\x3dcart");q.location=b}function Q(a,c,d,e,n){e=e||{};e.pushNewFrame=e.pushNewFrame||"true";e.anchor=e.anchor||F;z();"true"===e.pushNewFrame&&g&&g.navigate&&P("#checkoutDisplayPage").data("useMashNavigateForTransitions")?g.navigate({url:null,transitionEffect:"slide",successCallback:function(){W(a,
c,d,e,n)},failCallback:function(a){}}):W(a,c,d,e,n);e.keepCachedPagesData||b.clearCache()}function G(){var a=P("input#isPipelinedPage");return 0<a.length&&"1"===a.val()}function L(a){return n.isExecutionIdInQueryStringEnabled()?a?a.getResponseHeader("x-amz-checkout-executionid"):f.getQueryStringParameter(q.location.href,"executionId"):P("input#executionId").val()}function W(b,e,k,p,g){function l(a){var b=k.getResponseHeader(a);null==b&&(h.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader"),
h.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader:"+a),w("performUpdatePageFromResponse is missing required header "+a));return b}function B(a){var b=/^\s*\<(?:!doctype|html)/;if("string"===typeof a&&a.match(b)){var b=(new DOMParser).parseFromString(a,"text/html"),c=P(b).find("#checkoutDisplayPage");if(0<c.length)return h.increaseCount("Checkout:PageConductor:Ajax:Update:CenterContentExtracted"),c[0].outerHTML;b=P(b).find("body");if(0<b.length)return h.increaseCount("Checkout:PageConductor:Ajax:Update:BodyExtracted"),
b[0].outerHTML}return a}p=p||{};p.pushNewFrame=p.pushNewFrame||"true";p.anchor=p.anchor||F;p.mixedContentFallback=p.mixedContentFallback||"fallback";var A=l("x-amz-checkout-page"),t=l("x-amz-checkout-requestid"),z=c.getCurrentPage();c.setCurrentPage(A);if(p.freshLoad)p.freshLoad=!1,r.when("first-load-dependencies").execute(function(a){W(b,e,k,p)});else if(A){P("head .aui-page-asset").removeAttr("disabled");P("head .old-pipeline-asset").removeAttr("disabled");h.setAsyncRequestId(t);var ga=k.getResponseHeader("x-amz-checkout-redirect");
if(ga)T({conductoraction:{url:ga,type:"redirect"}});else{if(n.isPageConductorConvergenceEnabled()){if(f.isChewbaccaUrl(document.location.pathname)&&"reload"==p.mixedContentFallback){h.increaseCount("Checkout:PageConductor:mixedContentFallback:"+p.mixedContentFallback);location.reload();return}}else va(b)&&oa(p);n.isIngressEnabled()&&(b=B(b));if(n.isAJAXWeblabOn()&&d.isStreamingAjax(k))n.isAjaxStreamingEnabled()?u(A):(v(k),U(b,A));else if(a.trigger("checkout:unload"),0<P("#checkoutDisplayPage").length?
N(b,k,A!==z):E(b,k),n.isAjaxStreamingEnabled()&&G()){var z=P("#pipelinedPageTitle").text(),ga=l("x-amz-checkout-url"),ka=k.getResponseHeader("x-amz-checkout-additional-page-args");Z(A,z,ga,L(k),ka,p.anchor,p.pushNewFrame)}!n.isAjaxStreamingEnabled()&&G()&&(z=P("#pipelinedPageTitle").text(),ga=l("x-amz-checkout-url"),ka=k.getResponseHeader("x-amz-checkout-additional-page-args"),Z(A,z,ga,L(k),ka,p.anchor,p.pushNewFrame));M||H(A);p.anchor&&(A=P(p.anchor),0===A.length&&(A=p.anchor.replace("#",""),A=P(document.getElementsByName(A))),
A.length&&P(document).scrollTop(A.offset().top));p.logUsedPrefetch&&r.when("action-logger").execute(function(a){a.logUsedPrefetch(l("x-amz-checkout-page-type"),l("x-amz-checkout-sub-page-type"),t,g)})}}else{if(q.getOldAjaxSuccessCallback)return q.getOldAjaxSuccessCallback("ajaxConductor","generalErrorHandling","generalErrorHandling")(b,e,k);b=m.jsonify(b);T(b)}}function Z(a,b,c,d,e,k,p){b&&c&&q.history&&q.history.pushState&&(n.isExecutionIdInQueryStringEnabled()?"true"!==p||history.state&&history.state.page===
a||(c=da(c),k&&(c+=k),d&&(c=f.addQueryStringParameterOrDeleteIfEmpty(c,"executionId",d)),history.pushState({page:a,additionalURLArgs:e},b,c)):(c=da(c),k&&(c+=k),d&&(c=f.addQueryStringParameter(c,"executionId",d)),"true"===p&&history.state&&history.state.page!==a&&history.pushState({page:a,additionalURLArgs:e},b,c)))}function H(a){var b=P("#checkoutDisplayPage");if(b.length){var c=0<=document.location.search.indexOf("pipelineType\x3dChewbacca")?"multi-page-pipeline-chewbacca":M?"single-page":"multi-page";
b.attr({"data-checkout-pipeline":c,"data-checkout-page":a||""})}}function U(a,b){a.executeActions();a=P("#pipelinedPageTitle").text();k(a);u(b)}function V(){q.location=ga?"/gp/buy/addtocart/handlers/display.html":"/gp/buy/payselect/handlers/error.html"}function X(b,c,k,p,h,u){p=p||{};p.refTag=p.refTag||"";p.pushNewFrame=p.pushNewFrame||"true";p.anchor=p.anchor||F;p.refTag&&0!==p.refTag.indexOf("/ref\x3d")&&(p.refTag="/ref\x3d"+p.refTag);var g="";n.isPageConductorConvergenceEnabled()&&h&&f.isChewbaccaUrl(h)||
(g="fromPage\x3d"+b+"\x26page\x3d"+c);(b=L(u))&&(g+="\x26executionId\x3d"+b);k&&(g+="\x26"+k);k=h?h:"/gp/buy/shared/handlers/pipeline-dispatch.html";n.isPageConductorConvergenceEnabled()&&f.isChewbaccaUrl(k)||(k+=p.refTag);h=function(){};b=function(){};"function"===typeof p.resultscallback?(c=function(a,b,c){p.resultscallback(a,b,c)},u=function(a,b,c){p.resultscallback(F,b,a)}):(h=function(b){a.trigger("checkout:beforeLoadPage");wa&&wa.abort();wa=b},c=function(a,b,c){n.isAJAXWeblabOn()&&d.isStreamingAjax(c)||
p.callbackBeforePageUpdate&&p.callbackBeforePageUpdate();Q(a,b,c,p);p.callbackAfterPageUpdate&&p.callbackAfterPageUpdate()},u=function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===e.READY_STATE.UNSET?r.when("a-tv","mash").execute(function(a,b){q.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(aa(a,b),V()))},b=function(a){wa=null});g={type:"GET",url:k,data:g,dataType:"text",async:!0,beforeSend:h,success:c,error:u,complete:b,cache:!1};if(M||n.isPipelineDispatchSendHeaderEnabled())g.headers=
x({"x-amz-checkout-transition":"ajax"});C(g);return n.isAJAXWeblabOn()?(g.useXMLHttp=!0,g=n.isAjaxStreamingEnabled()?ca(g,p.callbackBeforePageUpdate,p.anchor,p.pushNewFrame):ca(g,p.callbackBeforePageUpdate),e.aui(g)):P.ajax(g)}function ca(b,e,f,h){b.timeout=5E4;b.data=ia(b.data,"acceptsStreaming\x3d1");var u=b.data.match(/.*isAsync=1.*/)?!0:!1;Ca=p({$target:P("#checkoutDisplayPage"),updateTriggerEvent:"pageReady",immediateExecution:!u,updateTarget:P("#checkoutDisplayPage"),onUpdate:function(b){"function"===
typeof e&&e();a.trigger("checkout:unload");k(b.title);Z(b.page,b.title,b.url,b.executionId,b.additionalURLArgs,f,h||"true");c.setCurrentPage(b.page)}});b.chunk=Ca.chunkHandler;if(!n.isAjaxStreamingEnabled()){var g=b.success;b.success=function(a,b,c){g&&d.isStreamingAjax(c)?g(Ca,b,c):g&&g(a,b,c)}}return b}function ia(a,b){return a?a+"\x26"+b:b}function C(a){if(a.data.match(/.*isAsync=1.*/)&&n.isPrefetchUrlTaggingWeblabEnabled())return a.headers?a.headers["x-amzn-tiertwo"]="yes":a.headers={"x-amzn-tiertwo":"yes"},
h.increaseCount("Checkout:PageConductor:Prefetch:Tagging:T"),!0;h.increaseCount("Checkout:PageConductor:Prefetch:Tagging:C");return!1}function aa(a,b){h.increaseCount("Checkout:PageConductor:Ajax:Error");n.isAJAXWeblabOn()?(a?(h.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),w("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===F?(h.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),w("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):
null===a&&(h.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),w("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),h.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+b),h.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+a.status),h.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+a.readyState)):(a?(h.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),w("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===F?(h.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),
w("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(h.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),w("jqXHR null throw CheckoutErrorAW using jQuery")),h.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+b),h.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+a.status),h.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+a.readyState))}function ba(a,b,c,d){var k=a;b=ia(b,"isClientTimeBased\x3d1");var p;if(n.refactorExtractURL()){p=f.extractURLParts(a);a=p.normalizedUrl;
if(!a)return h.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),w("Unable to normalize url ["+k+"]. Ajax request aborted."),!1;var u=a.indexOf("/gp/buy/");0<u?(a=a.substring(u),h.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):h.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");p.query?(b+="\x26"+p.query,h.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):h.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");
p=p.refMarker;p||(h.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),p="");p&&-1===p.indexOf("ref\x3d")&&(h.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),p="")}else{var g=a.indexOf("?");0<g?(u=a,b+="\x26"+a.substring(g+1),a=a.substring(0,g),n.isAllowlistingQueryParametersEnabled()&&(g=f.buildFilteredQueryString(u,Ka),""===g?h.increaseCount("Checkout:PageConductor:submitAjax:url:hasNoAllowlistedQueryParameter"):h.increaseCount("Checkout:PageConductor:submitAjax:url:hasAllowlistedQueryParameter"),
a+=g),h.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):h.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");u=a.indexOf("/gp/buy/");0<u?(a=a.substring(u),h.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):h.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(g=f.isChewbaccaUrl(a))a=a.slice(a.indexOf("/checkout/p/p-")),h.increaseCount("Checkout:PageConductor:submitAjax:url:chewbacca:C");else{if(-1===a.indexOf(".html"))return h.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),
w("url ["+k+"] is missing html extension and not a chewbacca call. Ajax request aborted."),!1;k=a.indexOf(".html");p=a.substring(k+5);a=a.substring(0,k+5)}p||h.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");p&&-1===p.indexOf("ref\x3d")&&(h.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),p="")}b+="\x26handler\x3d"+a;a={type:"POST",url:g?a:"/gp/buy/shared/handlers/async-continue.html"+p,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:x({"x-amz-checkout-transition":"ajax"}),data:b,dataType:"text",async:!0,success:c,error:function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===e.READY_STATE.UNSET?r.when("a-tv","mash").execute(function(a,b){q.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof d&&(aa(a,b),d()))},cache:!1};C(a);return n.isAJAXWeblabOn()?(a.useXMLHttp=!0,ca(a),e.aui(a)):P.ajax(a)}function y(a,b,c,d,e){e=e&&e.action?e.action:a.attr("action");a=a.serialize();d&&(a+="\x26isAsync\x3d1");
return ba(e,a,b,c)}function ea(a,b,c,d){a=da(a.attr("href"));d&&(a+="\x26isAsync\x3d1");return ba(a,"",b,c)}function fa(a){a=a||{};a.logUsedPrefetch=1;Q(Y.data,Y.status,Y.response,a,Y.refMarker)}function da(a){-1===a.toLowerCase().indexOf("hasworkingjavascript")&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function ka(a){ha=!1;var b=c.getCurrentPage(),d=ma-R,e=ra,k=a.data("pushNewFrame"),f=function(a,b,c){"boolean"===typeof k&&!1===k?Q(a,b,c,{pushNewFrame:"false"}):Q(a,
b,c)};pa&&clearTimeout(pa);if(a.is("form"))O(a)?(fa(),h.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Success"),h.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":TimeSaved",d)):(n.isPageConductorConvergenceEnabled()?y(a,f,V):y(a,Q,V),h.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Failure:Invalid"));else if(a.is("a"))if(sa(a)){var p;1===parseInt(a.data("keepCachedPagesData"),10)&&(p={keepCachedPagesData:1});fa(p);h.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+
e+":Success");h.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":TimeSaved",d)}else n.isPageConductorConvergenceEnabled()?ea(a,f,V):ea(a,Q,V),h.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Failure:Invalid");else h.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Failure:NoTrigger"),r.error("function called without a trigger","page-conductor","handleContinueAction")}function O(a){return a.is("form")&&null!==Y&&Y.serializedValue===a.serialize()}function sa(a){return a.is("a")&&
null!==Y&&da(Y.serializedValue)===da(a.attr("href"))}function oa(a){"reload"==a.mixedContentFallback?(h.increaseCount("Checkout:PageConductor:mixedContentFallback:"+a.mixedContentFallback),location.reload()):"fallback"==a.mixedContentFallback?(h.increaseCount("Checkout:PageConductor:mixedContentFallback:"+a.mixedContentFallback),T({conductoraction:{url:"/gp/buy/spc/handlers/display.html?_from\x3dcheetah",type:"redirect"}})):(h.increaseCount("Checkout:PageConductor:mixedContentFallback:Invalid"),r.log("mixedContentFallback is invalid. mixedContentFallback should be reload or fallback",
"ERROR","mixedContentFallback"))}function S(a){return ua&&(a.is("form")&&ua!==a.serialize()||a.is("a")&&da(ua)!==da(a.attr("href")))}function xa(a,b,e,k,p){function u(c,f,A){var z=!0;if("success"===f){if(!n.isAJAXWeblabOn()||!d.isStreamingAjax(A)){var ga=m.jsonify(c);null!==ga&&ga&&ga.result&&"noPrefetch"===ga.result&&(Y=null,z=!1)}z&&(Y={},Y.serializedValue=t,Y.data=c,Y.status=f,Y.response=A,Y.refMarker=B,null==ma&&(ma=(new Date).getTime()))}else Y=null,h.increaseCount("Checkout:"+l+":PageConductor:Prefetch:"+
ra+":Failure:Response");ta=!1;M&&r.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});if(ha)return ka(ja),!0;if(z){var E=function(){k?xa(a,b,e,!0,p):qa(a)};if(null===Y||"form"===g&&Y.serializedValue!==a.serialize())return E(),!0;b&&(0===b?h.increaseCount("checkoutPrefetchTimeoutSetToZero",1):pa=setTimeout(function(){Y=null;E()},1E3*b))}return!0}if(!G()||0===a.length)return!1;var g=a.get(0).tagName.toLowerCase();if("form"!==g&&"a"!==g||"function"===typeof p&&!p(g))return!1;
b=b||0;e=n.isMaxPrefetchRetryRestrictionEnabled()?1<e?1:0:e||0;k=k||!1;if(ta||ra>=e)return!1;ta=!0;r.when("link-prefetch").execute(function(a){a.isClearCacheEnabled()&&a.clearCache()});M&&r.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});ra++;var l=c.getCurrentPage();R=(new Date).getTime();ma=null;h.increaseCount("Checkout:"+l+":PageConductor:Prefetch:"+ra+":Attempted");pa&&clearTimeout(pa);var B=f.extractURLParts("form"===g?a.attr("action"):a.attr("href")).refMarker,
A,t=null;"form"===g?(t=a.serialize(),A=n.isAJAXWeblabOn()?y(a,u,u,!0):y(a,null,null,!0)):"a"===g&&(t=da(a.attr("href")),A=n.isAJAXWeblabOn()?ea(a,u,u,!0):ea(a,null,null,!0));n.isAjaxStreamingEnabled()&&t&&(ua=t);"object"!==typeof A||"function"!==typeof A.always||n.isAJAXWeblabOn()||A.always(u)}function qa(a){var b=parseInt(a.data("prefetchTimeout"),10),c=parseInt(a.data("maxPrefetches"),10);return xa(a,b,c,!1,function(b){if(a.find("input:checked").hasClass("no-prefetch"))return!1;if(n.disablePrefetchForScheduledDeliveryWeblabOn()){var c=
a.find("div.one-shipment:not(:hidden)").find("input:checked");if(c.parents('[data-a-input-name\x3d"'+c.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===P("input#block-prefetch").val()||"1"===P("input#block-all-prefetch").val()||"form"===b&&!a.data("checkoutFormReady")?!1:!0})}function Aa(){var a=c.getCurrentPage();return"payselect"===a||"spp-payment"===a||"pay"===a}function va(a,b){return/.*\/checkout\/p\/.*\/spc/.test(b||q.window.location.pathname)&&/data-checkout-page/.test(a)}function Ba(b,
c){ta&&null==ma&&(ma=(new Date).getTime());b&&b.preventDefault();!n.isClearTemporaryPreferenceFixRemoveEnabled()&&Aa()&&B.hasActiveTemporaryPreference&&B.hasActiveTemporaryPreference()&&z();var d=b?P(b.currentTarget):c;b=function(){if(M){l.blockAllActions();var a=d.data("shrink-panel"),b=d.data("loading-text");(a=P("#"+a))&&a.length?a.hasClass("expanded")||l.shrinkPanel(P(".spp-panel.expanded"),!1):a=P(".spp-panel.expanded");l.shrinkPanel(a,!0,b)}else l.show()};h.resetMetrics();!Fa||O(d)||sa(d)?b():
a.delay(b,0);try{ha=!0,ja=d,n.isAjaxStreamingEnabled()&&Ca&&!S(d)&&Ca.enableExecution(),ta||ka(d)}catch(e){b="An error occured while click on the continue button.",e.message&&(b+="  Error message: "+e.message),r.error(b,"page-conductor","continueClicked",e)}}function K(){P("#checkout-btf-spinner").addClass("aok-hidden")}var P=a.$,ta,R,ma,wa,Y,ra,ha,ja,pa,ya,na,ua,Da=function(a){if(!ya)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");return ya(a)},
M=!1,ga=!1,Ha=!1,Fa=!1,Ga=!1,Ca,Ka=["sif_profile"];z();a.declarative("page-transit-no-update-action","click",function(d){if(!Ha){d.$event.preventDefault();h.resetMetrics();var e=d.data.targetDeclarativeActionId;if(e&&(e=P("#"+e),e.length)){e.trigger("click");return}var k=d.data.toPage,e=d.data.fromPage||c.getCurrentPage(),f=d.data.refTag||"chk_"+e+"_cancel_pri",p=d.data.args,g=d.$currentTarget.find("a.checkout-pipeline-pref-link"),m=M&&"function"===typeof t.isIN&&t.isIN();M&&(!m||"spp-payment"!==
e&&"spp-rxselect"!==e?b.setCachedPageData(e,k):("spp-payment"==e&&h.increaseCount("checkout:trueSPC:disableCachingPSP:"+k,1),"spp-rxselect"==e&&h.increaseCount("checkout:trueSPC:disableCachingRxSelect:"+k,1)));if(b.getCachedPageData(k,e)){h.increaseCount("checkout:"+e+":cancelpri",1);f=b.getCachedPageData(k,e);z();c.setCurrentPage(f.page);var B;B=n.isAJAXWeblabOn()?Da(f.curPageData):Da(JSON.stringify(f.curPageData));if(M)if(h.isTransitionLoggingEnabled()){var A=(new Date).getTime();h.logPageTransition(e+
"-cached",k,F,function(b){b=(new Date).getTime()-A;b<B?a.delay(function(){u(k)},B-b):u(k)})}else a.delay(function(){u(k)},B);else u(k);f.title&&f.url&&q.history&&q.history.pushState&&history.state&&history.state.page!==f.page&&history.pushState(f.state,f.title,f.url)}else g.length?Ba(null,g):(h.increaseCount("checkoutSPPCancelNoCachedData",1),m&&"spp-payment"===k&&h.increaseCount("checkout:trueSPC:emptyPSPCacheFrom:"+e,1),g=function(){if(M)if(l.blockAllActions(),d.data.noShrink)l.show();else{var a=
d.data.loadingText,b=P("#"+d.data.shrinkPanel);b.length||(b=d.$currentTarget.closest("div.spp-panel"));l.shrinkPanel(b,!0,a)}else l.show()},Fa?a.delay(g,0):g(),X(e,k,p,{refTag:f,keepCachedPagesData:1}))}});n.isAjaxStreamingEnabled()&&(a.on("checkout:page:atf",function(){l.hide();P("#checkout-btf-spinner").removeClass("aok-hidden")}),a.on("checkout:page:end",function(){K()}));a.on("ready",function(){Fa=0<P("#executeNonBlockingAnimations").length;Ga=0<P("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",
function(){l.hide();n.isAjaxStreamingEnabled()&&K();a.delay(h.sendUEPageLoadStats);if(G()){var c=P("form.checkout-page-form:not(:disabled):first"),d=P("a.checkout-continue-link:not(:disabled):first");P("#useFirstActivePrefetch").length&&(d=P("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<(parseInt(P(this).data("maxPrefetches"),10)||0)}).first());var e=!1;c.length&&(e=qa(c));!e&&d.length&&(e=qa(d));!e&&M&&(c=P("a.checkout-pipeline-pref-link:not(:disabled):first"),c.length&&(d=
c.data("fromPage"),e=c.data("toPage"),b.getCachedPageData(e,d)||(e=qa(c))))}});return{ajaxUpdatePage:Q,ajaxRedirect:T,ajaxSorryPage:V,isPageLoadRequestInProgress:function(){return wa?1:0},submitFormAjax:y,reloadPage:function(){var a=c.getCurrentPage();X(a,a)},loadPage:X,usePrefetch:fa,makePrefetch:qa,makePrefetchWithParams:xa,isPrefetchValidFor:function(a,b){if(null!==Y){var c=Y.response.getResponseHeader("x-amz-checkout-page");if(n.isPageConductorConvergenceEnabled()&&b){var d=Y.response.getResponseHeader("x-amz-checkout-url"),
d=f.getUrlType(d);b=f.getUrlType(b);return a===c&&d===b}return a===c}return!1},redirect:T,continueClicked:Ba,initFunc:function(a,b){ya=a;na=b},overrideIsSPP:function(a){M=a},isSPP:function(){return M},overrideAddToCart:function(a){ga=a},isAnimating:function(){return Ha},overrideIsAnimating:function(a){Ha=a},setAjaxTransitionHeader:x,isPipeliningOn:G,disablePageNoUpdateTransition:function(){Ga&&r.when("a-button").execute(function(a){var b=P(".spp-panel.expanded").data("stepIndex");P(".expand-collapsed-panel-trigger").each(function(){var c=
P(this),d=c.parents(".spp-panel").data("stepIndex");if(!b||!d||d>b)c.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),a(c.filter(".expand-panel-button")).disable(),c.filter("a.expand-panel-button").addClass("disabled-link"),c.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});P(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){Ga&&r.when("a-button").execute(function(a){P(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");
a(".expand-collapsed-panel-trigger.expand-panel-button").enable();P(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},isNonBlockingAnimationEnabled:function(){return Fa},isPrefetchFromAddressEnabled:function(){return Ga},getExecutionId:L,isPrefetchRequestInProgress:function(){return ta},isRequestMixedContent:va,ajaxUpdate:function(b,c,d){d=d||{};"undefined"===typeof d.pushNewFrame&&(d.pushNewFrame=!1);"boolean"===typeof d.pushNewFrame&&(d.pushNewFrame=d.pushNewFrame.toString());
var e="";c&&"object"===typeof c?e=a.map(c,function(a,b){return b+"\x3d"+a}).join("\x26"):"string"===typeof c&&(e=c);pa&&clearTimeout(pa);h.resetMetrics();l.show();return ba(b,e,function(a,b,c){Q(a,b,c,d)},V)}}});r.when("A","jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,l,m,c,f,h,g,b,e,p){if(g.isPipeliningOn()){q.history&&l(q).bind("popstate",
function(){var a=this.history.state,b=f.getCurrentPage();if(a&&a.page&&b&&(a.page!==b||g.isPageLoadRequestInProgress())){m.show();b=l("#checkoutDisplayPage");b.data("wipeOnPipelineBackTransition")&&b.empty();e.resetMetrics();b=l("#useFastBackButton").length;if(p.isPageConductorConvergenceEnabled()){if(b&&g.isPrefetchValidFor(a.page,document.location.pathname)){g.usePrefetch({pushNewFrame:!1});return}}else if(b&&g.isPrefetchValidFor(a.page)){g.usePrefetch({pushNewFrame:!1});return}b="spc"===a.page?
"":a.page;if(p.isPageConductorConvergenceEnabled()){var c="";if(h.isChewbaccaUrl(document.location.pathname)){var d=document.location.href.indexOf("/checkout/p/p-");0<=d&&(c=document.location.href.substring(d))}g.loadPage(f.getCurrentPage(),b,a.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"},c)}else g.loadPage(f.getCurrentPage(),b,a.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"})}});l(document).delegate("form.checkout-page-form","change",function(a){l(a.target).parent().hasClass("no-prefetch-on-change")||
(a=l(a.currentTarget),g.makePrefetch(a))});l(document).delegate("form.checkout-page-form","submit",function(a){g.continueClicked(a)});l(document).delegate("a.checkout-continue-link","click",function(a){g.continueClicked(a)});a.declarative("checkout-page-form-submit","change",function(a){var b;a=a.$target.closest("form.checkout-page-form");b=a.attr("data-push-new-frame");"undefined"!==typeof b&&""!==b||a.attr("data-push-new-frame","false");a.submit()});l(document).delegate("form.checkout-page-form .submit-button-with-name",
"click",function(a){a=l(a.currentTarget);l("\x3cinput\x3e").attr({type:"hidden",name:a.attr("name"),value:a.val()}).appendTo(a.closest("form.checkout-page-form"))});var d=!1;l(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","touchmove",function(a){d=!0});l(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","click keypress touchend",function(a){if(d)d=!1,a.preventDefault();else if(h.protectAgainstDoubleAction("pipeline-link"))a.preventDefault();
else if("keypress"!==a.type||13===a.which){var c=l(a.currentTarget),f=c.data("pipelineLinkFromPage"),w=c.data("pipelineLinkToPage"),x=c.data("pipelineLinkAnchor"),z=c.data("pipelineLinkRef");z||((z=h.extractURLParts(c.attr("href")).refMarker)?e.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):e.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));var k=c.data("pipelineLinkArgs");w&&(e.resetMetrics(),a.preventDefault(),g.isSPP()&&b.setCachedPageData(f,w),m.show(),a={refTag:z,
anchor:x},g.isSPP()&&(a.keepCachedPagesData=1),x="",c=c.attr("href"),p.isPageConductorConvergenceEnabled()&&c&&h.isChewbaccaUrl(c)&&(x=c.substring(c.indexOf("/checkout/p/p-")),k=""),g.loadPage(f,w,k,a,x))}});l(document).delegate("a.spclite-dispatch-link","click keypress touchend",function(a){if("keypress"!==a.type||13===a.which){var b=l(a.currentTarget),c=b.data("spcliteLinkFromPage"),d=b.data("spcliteLinkToPage");b.data("spcliteLinkAnchor");var e=b.data("spcliteLinkRef"),b=b.data("spcliteLinkArgs"),
f=l("input#executionId").val(),b=b?b+("\x26executionId\x3d"+f):"executionId\x3d"+f;d&&(a.preventDefault(),m.show(),g.loadPage(c,d,b,{refTag:e},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}l(document).delegate("input.submit","click touchend",function(){e.resetMetrics()});l(document).delegate("form","submit",function(){e.resetMetrics()});l(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){e.isTransitionLoggingEnabled()&&e.resetMetrics()});p.isExecutionIdInQueryStringEnabled()&&
(l.ajaxSetup({beforeSend:function(a,b){b.url&&(a=h.getQueryStringParameter(q.location.href,"executionId"),b.url=h.addQueryStringParameterOrDeleteIfEmpty(decodeURIComponent(b.url),"executionId",a));return!0}}),l(document).ajaxSuccess(function(a,b,c){if(c&&c.url&&c.url.match(/\/async-continue|\/set-|\/update-|\/new/i)&&(a=b.getResponseHeader("x-amz-checkout-sub-page-type")||"Unknown",!a.match(/^p-/))){c=g.getExecutionId(b);if(q.history&&q.history.replaceState){var d=h.addQueryStringParameterOrDeleteIfEmpty(q.location.href,
"executionId",c,!0);q.history.replaceState(q.history.state,"",d)}else e.increaseCount("Checkout:PageConductor:NoReplaceState");c||(b=b.getResponseHeader("x-amz-checkout-page-type")||"Unknown",e.increaseCount("Checkout:PageConductor:"+(null===c?"ExecutionIdIsNotSet":"ExecutionIdIsEmpty")+":"+b+":"+a,1))}}))});"use strict";r.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,l,m){function c(b){return b.disableHide?function(){}:function(){var c=this;c.animating=
!0;a.fadeOut(this.$popover,250);b.secondaryPopover||e("#a-popover-modal").hide();a.delay(function(){c.animating=!1},250)}}function f(a,b){var d=c(b);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;(p=l.show({$trigger:a,name:b.name,skin:n(b.header,b.closeButton,b.closeTextOverride),content:b.content,url:b.url,data:b.data,update:t,alone:b.alone?"true"===b.alone:!0,position:b.position||"triggerVertical",hide:d}))&&p.$trigger!==a&&(p.$trigger=a,p.updatePosition())}
function h(a,b){b.disableHide=!0;var f=c(b);d=!1;(b=l.show({$trigger:a.$declarativeParent,skin:B(b.header,b.footer,b.closeButton,b.contentClass),name:b.name,requestURL:b.url,position:"windowCenter",update:t,data:b.data,updatePosition:b.allowScrollOnPage?w:x,modal:!0,alone:b.alone?"true"===b.alone:!0,show:function(){this.animating=!0;this.$popover.show();e("#a-popover-modal").show();this.animating=!1},hide:f}))&&b.$trigger!==a.$declarativeParent&&(b.$trigger=a.$declarativeParent,b.updatePosition())}
function g(c){var d=c.$declarativeParent;a.delay(function(){b(c,d)},250)}function b(c,d){p&&(m.eventOccursWithin(c,d)||m.eventOccursWithin(c,p.$popover))?a.delay(function(){b(c,d)},250):l.hide(d)}var e=a.$,p,d=!1,n=function(a,b,c){return function(d){var f=c;c===F&&(f=e("input#closeButtonText").val()||"");var p="";f&&(p='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+f+"\x3c/a\x3e\x26nbsp;");f="false"===b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',
p,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',a||f?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",f,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',d,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},
B=function(a,b,c,d){return function(f){var p=e("input#closeButtonText").val()||"",n="";p&&(n='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+p+"\x3c/a\x3e\x26nbsp;");p="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',n,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");p=a||p?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',
a,"\x3c/h4\x3e",p,"\x3c/div\x3e"].join(""):"";n="";if(b){var g=e("#a-popover-footer-"+b);0<g.length&&(n=['\x3cdiv class\x3d"a-popover-footer"\x3e',g.html(),"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',p,'\x3cdiv class\x3d"a-popover-inner ',d,'"\x3e',f,"\x3c/div\x3e",n,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",
["click","touchend"],function(b){b.$event.preventDefault();var c=b.$target;e("html").hasClass("a-ie6")||e("html").hasClass("a-ie7")||e("html").hasClass("a-ie8")?c.closest(".a-popover").hide():a.fadeOut(c.closest(".a-popover"),250);e("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:c,$event:b.$event,$currentTarget:b.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});
a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var b=a.popover.$trigger.data("aCheckoutModalPopover");b&&b.allowScrollOnPage&&a.popover.$popover.css("position","absolute")}});var t=function(a){e(".a-popover-inner",this.$popover).html(a)},w=function(a){if(!d||a)x.call(this,!0),d=!0},x=function(a){var b=e(q),c=b.height()/2,d=b.width()/2,f=this.$popover.height()/2,p=this.$popover.width()/2,c=c-f;if(a||"fixed"!==this.$popover.css("position"))c+=b.scrollTop();a=Math.max(0,d-p);c=Math.max(0,
c);this.$popover.css({top:c,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup","touchend"],function(a){a.data.showOnHover&&"touchend"!==a.type?"mouseenter"===a.type||"click"===a.type?f(a,a.data):"mouseleave"===a.type&&g(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&f(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&
h(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===e("#a-popover-modal").length&&e("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});return{hideById:function(a){l.hide(a)},createModal:h}});"use strict";(function(){var a=!1;r.when("A").register("page-detector",function(l){function m(){return c("checkout-as")}function c(a){e||(e={});e.hasOwnProperty(a)||(e[a]=0<b("div."+a).length);return e[a]}function f(){return c("checkout.pay")}function h(){return c("checkout.spc")||
-1<q.location.href.search(/\/checkout\/p\/p[-\d]+\/spc.*/)?!0:!1}function g(){return l.capabilities.mobile}var b=l.$,e;l.on("checkout:reload",function(){e={};a||r.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});return{isAddressSelect:m,isAddressTranslation:function(){return c("translate-address-form")},isDesktopPayment:function(){return f()&&c("pay-desktop")},isDesktopSpc:function(){return h()&&c("spc-desktop")},isMobileAddressSelect:function(){return m()&&
c("checkout-as-mobile")},isMobilePayment:function(){return f()&&c("pay-mobile")},isMobileSpc:function(){return h()&&g()},isTabletAddressSelect:function(){return m()&&c("checkout-as-tablet")},isTabletPayment:function(){return f()&&c("pay-tablet")},isTabletSpc:function(){return h()&&c("spc-tablet")},isSpcLite:function(){return h()&&c("spclite")},isPayment:f,isSosp:function(){return c("checkout.sosp")},isSpc:h,isMobile:g,isTablet:function(){return l.capabilities.tablet}}});r.register("page-detector-current-initializer",
function(){return{initializeDetectorWithCurrentPage:function(l){if(!a){var m=l;r.register("page-detector-current-page",function(){return{getCurrentPage:function(){return m},setCurrentPage:function(a){var f=m;m=a;r.when("A").execute(function(h){h.trigger("page-detector:page-changed",f,a)})}}});a=!0}}}})})();"use strict";r.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,l){function m(){"function"===typeof w.blockAllActions&&w.blockAllActions()}function c(){"function"===
typeof w.unblockAllActions&&w.unblockAllActions()}function f(a){"function"===typeof w.showTransitionInContainer&&w.showTransitionInContainer(a)}function h(){var b=a(q).width(),c=a(q).height(),d=a(q),e=0;null!==t&&(e=t.outerHeight()-a(q).scrollTop(),0>e&&(e=0));n.css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c)}
function g(){var b;b=document.activeElement?a(document.activeElement):a(":focus:first");b.is("button, a, input:enabled")&&b.blur()}function b(){if(x){m();r.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});var b=a(".spp-panel.expanded");if(0<b.length&&b.is(":visible")){f(b,1);return}}if(B)return n.length&&n.find(".loading-spinner-inner").show(),!1;B=!0;g();n=a("#spinner-anchor");n.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(t=a("#header"));p=n.css("z-index");
a(q).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",function(a){d&&q.clearTimeout(d);d=setTimeout(function(){h();d=null},50)});a(q).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",function(){h();l.adjustSize(n)});a(q).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){h();l.adjustSize(n)});h();n.show();n.css("z-index",2E3);l.showSpinner(n,!0);return!0}function e(){if(x)c(),"function"===
typeof w.hideSpinner&&w.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();if(!B)return!1;B=!1;n.length&&n.find(".loading-spinner-inner").show();n&&(a(q).unbind(".checkout-page-spinner"),n.hide(),n.css("z-index",p),l.hideSpinner(n));return!0}}var p,d=null,n,B=!1,t=null,w={},x=!1;return{show:b,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:b()},hide:e,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&e();return!0},hideAnimatedSpinnerImage:function(){n.length&&
n.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==a&&(w=a,x=!0)},blockAllActions:m,unblockAllActions:c,showTransitionInContainer:f,shrinkPanel:function(a,b,c){"function"===typeof w.shrinkPanel&&w.shrinkPanel(a,b,c)},clearFocus:g}});"use strict";r.when("A").execute(function(a){a=a.$;var l="",l="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";r.when(l).register("page-transition-controller",function(a){r.when("A").execute(function(c){c.declarative("page-spinner-show",
["click"],{allowLinkDefault:!0},function(c){c=c.$target;c.hasClass("a-button-disabled")||c.closest(".a-button-disabled").length||a.showPageTransition()})});r.when("A").execute(function(c){c.declarative("page-spinner-show-on-submit",["submit"],{allowLinkDefault:!0},function(c){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,
shrinkPanel:a.shrinkPanel}})});"use strict";r.when("A","page-conductor","client-side-metrics","page-detector-current-page","a-popover","ready").execute(function(a,l,m,c){function f(a,c,f){l.isSPP()&&m.setmarker&&m.setmarker("af");m.sendUEPageLoadStats()}var h=a.$,g=!1;a.on("a:popover:afterHide",function(a){a.popover&&(g=!1)});a.on("a:popover:beforeShow",function(a){var c=a.popover;c&&(g=!0,c.$trigger.find(".modal-parameters").each(function(){h.each(h(this).data(),function(a,b){c.attrs(a,b)})}))});
a.on("a:popover:dismiss",function(a){a=a.popover;if(m.isTransitionLoggingEnabled()&&a&&g){g=!1;var e,p;"prime-acquisition-spc-popover"===a.name&&(e="prime-acquisition",p=c.getCurrentPage());e||p||!a.attrs||(e=a.attrs("returnfrom"),p=a.attrs("returnto"));e&&p&&(m.resetMetrics(),m.logPageTransition(e,p,f))}})});"use strict";r.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",function(a,l,m,c){function f(){"function"===typeof q.uet&&
"function"===typeof q.uex&&(q.uet("cf","first-load-dependencies-ready",{wb:1}),q.uex("ld","first-load-dependencies-ready",{wb:1}));c.startWidgetTiming("first-load-dependencies:checkout:beforeReload");a.trigger("checkout:beforeReload");c.finishWidgetTiming("first-load-dependencies:checkout:beforeReload");c.startWidgetTiming("first-load-dependencies:checkout:reload");a.trigger("checkout:reload");c.finishWidgetTiming("first-load-dependencies:checkout:reload");var b;g&&(b="spp-revieworder"===g?"spc":
g);b&&(c.finishWidgetTiming("first-load-dependencies:checkout:reload:"+b),a.trigger("checkout:reload:"+b),c.finishWidgetTiming("first-load-dependencies:checkout:reload:"+b));c.startWidgetTiming("first-load-dependencies:checkout:afterReload");a.trigger("checkout:afterReload");c.finishWidgetTiming("first-load-dependencies:checkout:afterReload");setTimeout(function(){var a=h("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),c.increaseCount("checkout:pageload:timeout"),m.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},
9E4)}var h=a.$,g=l.getCurrentPage();"function"===typeof q.uet&&q.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&a.length){var e=!1,p={};h.each(a,function(a,b){c.startWidgetTiming("checkout:dependency:"+b+":ready");p[b]=1;r.when(b).execute(function(){c.finishWidgetTiming("checkout:dependency:"+b+":ready");delete p[b]})});var d=function(a){a="Page ("+g+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";c.increaseCount("checkout:dependency:missed:regular-page:error");
m.logErrorOnLevel(a,"ERROR")},n=setTimeout(function(){if(!e){var a=[];h.each(p,function(b){c.increaseCount("checkout:dependency:"+b+":missed");a.push(b)});c.increaseCount("checkout:dependency:missed");0<h("#assets-prefetch").length?c.increaseCount("checkout:dependency:missed:assets-prefetch"):(c.increaseCount("checkout:dependency:missed:regular-page"),d(a));f()}},5E3);r.when.apply(r,a).execute(function(){e=!0;q.clearTimeout&&n&&q.clearTimeout(n);f()})}else f()}}});"use strict";r.when("A","page-detector",
"client-side-metrics").register("gift-utility",function(a,l,m){var c=a.$,f=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,h=q.P&&q.P.AUI_BUILD_DATE,g=/((?:file|https?|ftps?|sip):\/\/)/im,b=/((?:\b|[\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?])www\.(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+\.[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+))+)(?:[\s!@#$%^&*()_=+[\]{}\|;:'",<>\?]|$|\b)/im,e=/([^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?\/]+\.(?:[a-z][a-z]|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|om|pro|qa|tel|travel|xxx)(?:\b|$))/im,
p=/^\S+\@\S+\.\S+$/im;return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,b){return b?q.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,b){var c=a.split("\n").length;b=Math.floor(b);a=a.split("\n");for(var e=0;e<a.length;e++)a[e].length>b&&(c+=Math.floor(a[e].length/b),0===a[e].length%b&&c--);return c},getNameWithNoTitle:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&
a.shift();return a.join(" ")},getFirstName:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,b){var e=b.find(".gift-message-warning");if(f.test(a.val())){var p=b.find(".gift-message-preview-trigger"),g=a.val().replace(f,"?");h?r.when("a-popover").execute(function(a){var b=a.get(p);b?b.update({content:g}):a.create(p,{inlineContent:g,position:"triggerVertical",closeButton:"false"})}):
(m.increaseCount("removeauijs13"),p.unbind("click.preview").bind("click.preview",function(a){r.when("a-popover-base").execute(function(b){var d=c(a.target);d.data("popoverid")&&(b=b.get(d.data("popoverid")))&&(b.update(g),b.updatePosition())})}));a.addClass("a-form-error");e.show()}else a.removeClass("a-form-error"),e.hide()},valueContainsUrl:function(a){return g.test(a)||b.test(a)||e.test(a)},isValidEmail:function(a){return p.test(""+a)}}});"use strict";r.when("A","page-detector","safe-mash","client-side-metrics").register("help-popup",
function(a,l,m,c){function f(){if(h("div#help-popover").length){h(q).unbind("resize.checkout-help-popover");var a=h("#help-popover-frame")[0];h(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");h("div#help-popover").remove()}}var h=a.$;l=l.isMobile();c=h("input#isPipelinedPage");c=0<c.length&&"1"===c.val();var g=l&&c&&m&&m.navigate;a.declarative("help-popup",["click"],function(a){if(!h(".a-touch").length||g){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&
a.$event.stopPropagation();var c=a.$target.closest("a").attr("href");a=a.data;g?m.navigate({url:c,transitionEffect:"slide"}):(a.width||(a.width="340"),a.height||(a.height="340"),q.open(c,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else q.open(a.$target.closest("a").attr("href"),"AmazonHelp")});if(g)a.on("checkout:reload",f)});"use strict";r.execute("persistent-order-controller",
function(){return{}});"use strict";r.when("jQuery","page-conductor").register("quantity-service",function(a,l){function m(c,f){f=f||{};var h;f.additionalData&&(h=f.additionalData);var g="/gp/buy/pipeline/handlers/update-quantity.html",b={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};h&&h.deletePrimeMembership&&h.primeMembershipASIN&&(b.deletePrimeMembershipItemIn=h.deletePrimeMembership,b.deletedPrimeMembershipASINIn=h.primeMembershipASIN);f.ref&&(g+=
"/ref\x3d"+f.ref,delete f.ref);h=f.success;delete f.success;var e=l.ajaxRedirect;f.error&&(e=f.error,delete f.error);a.extend(b,f);f=[];for(var p in c)c[p]!==F&&(f.push(p),b[p]=c[p]);b.entityids=f;c=l.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:g,data:a.param(b,!0),dataType:"text",async:!0,cache:!1,headers:c,success:h,error:e})}return{callBatch:function(a,f){m(a,f)},call:function(a,f,h){var g={};g[a]=f;m(g,h)}}});"use strict";r.when("jQuery").register("scroll-controller",
function(a){return{scrollToTop:function(){a(q).scrollTop(0)},toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",function(a){a.preventDefault()})}}});"use strict";r.when("A","checkout-general-utils","ready").execute(function(a,l){var m=a.capabilities&&a.capabilities.isAmazonApp,c=q.amazon&&q.amazon.mash;a=a.$("#checkout-mash-will-load").length;m||c||a?r.when("mash").execute(function(a){var c;"object"===typeof a?c=a:q.amazon&&q.amazon.mash&&
(c=q.amazon.mash);"object"!==typeof c?l.logError("MASH is expected but can't be found!"):(r.register("safe-mash",function(){return c}),q.ue&&q.ue.tag&&q.ue.tag("safe-mash:mash"))}):(r.register("safe-mash",function(){}),q.ue&&q.ue.tag&&q.ue.tag("safe-mash:no-mash"));q.ue&&q.ue.tag&&(m&&q.ue.tag("safe-mash:A.capabilities.isAmazonApp"),c&&q.ue.tag("safe-mash:window.amazon.mash"),a&&q.ue.tag("safe-mash:checkout-mash-will-load"),!m&&c&&q.ue.tag("safe-mash:fallback:window.amazon.mash"),m||c||!a||q.ue.tag("safe-mash:fallback:checkout-mash-will-load"))});
"use strict";r.when("A","scheduled-delivery-external-interface","shipping-speed-selection-controller","page-detector","ready").register("scheduled-delivery-controller",function(a,l,m,c){var f=a.$,h={};m=function(){h={};f("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=f(this),b=a.closest("div.fake-label");(b=l.getSdWidgetRootId(b))&&(h[a.attr("name")]=b)})};a.on("checkout:reload:shipoptionselect",m);a.on("checkout:reload:spp-revieworder",m);c.isSosp()&&m();f(document).delegate("div.fake-label",
"click",function(){if(c.isSosp()){var g=f(this),b=g.find("input[type\x3d'radio']");b.attr("disabled")||(b=b.attr("name"),g=l.getSdWidgetRootId(g),a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:h[b]}),h[b]=g)}});f(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(c.isSpc()){var g=f(this);g.find("input[type\x3d'radio']").attr("disabled")||(g=l.getSdWidgetRootId(g))&&a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:null})}});a.on("scheduled-delivery:unblock-continue",
function(){r.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});a.on("scheduled-delivery:block-continue",function(a){r.when("button-blocker").execute(function(b){b.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,b){var e;a=f("#"+a);if(0!==a.length){if(c.isSpc())a=a.closest(".shipping-speed");else if(c.isSosp())a=a.closest("div.fake-label.a-box");else return;e=a.find("input[type\x3d'radio']");e.attr("disabled",!0);e.is(":checked")&&
b&&(b=f("input[name\x3d"+e.attr("name")+"]:radio:not(:disabled):first"),b.prop("checked",!0),b.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){var b;a=f("#"+a);if(0!==a.length){if(c.isSpc())a=a.closest(".shipping-speed");else if(c.isSosp())a=a.closest("div.fake-label.a-box");else return;b=a.find("input[type\x3d'radio']");b.removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";r.when("A","ready").register("mobile-nav-bar-back-controller",
function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),1<=a.length&&a.click(function(a){a.preventDefault();q.history.back()}))});"use strict";r.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,l,m,c,f){function h(a,b){var c=[];a.addressId||c.push("addressId");a.slotKey||c.push("slotKey");a.shippingOfferingId||c.push("shippingOfferingId");a.conflictItems&&!n.isArray(a.conflictItems)&&c.push("conflictItems");if(0<
c.length){a="Error calling fresh widget callback on "+b+": Bad or Missing Input: "+c[0];for(b=1;b<c.length;b++)a+=", "+c[b];console.error(a);return 0}return 1}function g(){n("#freshSlotKey").val("");n("#freshAddressId").val("");n("#freshReservationToCancel").val("");n("#freshConflictingItems").val("");n("#freshShipOfferingId").val("")}function b(a){var b="",c=f.sospPartialAvailabilityWeblabOn();if(a&&n.isArray(a)&&0<a.length)for(var b=a[0].asin+":"+a[0].merchantId+(c?"|"+a[0].maxQtyAvailable:""),
d=1;d<a.length;d++)b+="-"+a[d].asin+":"+a[d].merchantId+(c?"|"+a[d].maxQtyAvailable:"");return b}function e(a){var d;d="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;d+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(d+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=b(a.conflictItems))&&(d+="\x26freshConflictingItems\x3d"+a);a=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});l.show();n.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",
data:d,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,d){return d.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,d):c.redirect(a)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function p(){n(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");n(".continue-button-blocker").addClass("aok-hidden")}function d(){n(".sosp-continue-button").addClass("aok-hidden");n(".continue-button-blocker").removeClass("aok-hidden")}var n=a.$;a.on("handle-fresh-results",
function(a){if(n("#isfresh").val())if(a)if(m.isSosp())if(h(a,"sosp")){n("#freshSlotKey").val(a.slotKey);n("#freshAddressId").val(a.addressId);n("#freshReservationToCancel").val(a.reservationToCancel);var f=b(a.conflictItems);n("#freshConflictingItems").val(f);n("#freshShipOfferingId").val(a.shippingOfferingId);f&&0<f.length?n("input#block-prefetch").val(1):n("input#block-prefetch").val(0);f=n("#shippingOptionFormId");a.conflictItems&&0<a.conflictItems.length||c.makePrefetch(f);p()}else g(),d();else m.isSpc()?
h(a,"spc")&&e(a):console.error("remote fresh widget JS callback called on unsupported page.");else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){n("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):m.isSosp()?1===a.blockContinue?(d(),g()):0===a.blockContinue?p():console.error("block continue callback - invalid value"):
console.error("block continue callback called on unsupported page."):console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){n("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){c.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',type:"redirect"}})})});"use strict";r.when("A","ready").execute(function(a){function l(){(0<
m(".change-preference-block").length||0<m(".mobile-change-preference-block").length)&&!1===c&&(r.register("loadVasRcxCheckoutAsset",function(){}),c=!0)}var m=a.$,c=!1;l();a.on("checkout:reload:spc",l);a.on("checkout:reload:shipoptionselect",l);a.on("checkout:reload:spp-revieworder",l);a.on("checkout:reload:spp-special-delivery-options",l)});"use strict";r.register("time-left-formatter",function(){function a(a,c,f,h,g){return 0>=c?a:a+c+" "+(1===c?g.HOUR:g.HOURS)+(!h&&0<f?" "+g.AND+" ":"")}function l(a,
c,f,h,g){return 0>=c?a:a+c+" "+(1===c?g.MINUTE:g.MINUTES)+(!h&&1>f?" "+g.AND+" ":"")+(1===h&&1>f?" ":"")}return{getTimeLeftFormatted:function(m,c,f){var h="",g=86400<m?(m-m%86400)/86400:0,b=3600<m?(m-m%3600)/3600:0;m-=3600*b;var e=60<m?(m-m%60)/60:0;m-=60*e;if(c&&0<g)return h+g+" "+(1===g?f.DAY:f.DAYS);if(c&&0<b)return a(h,b,e,c,f);if(c&&5<=e)return l(h,e,b,c,f);h=a(h,b,e,c,f);h=l(h,e,b,c,f);1<=b||(h=h+m+" "+(1===m?f.SECOND:f.SECONDS));return h}}});"use strict";r.register("email-validation",function(){function a(a){if(1!==
a.length)throw Error("Invalid length for character");return a}var l={isISOControl:function(l){"string"===typeof l&&(a(l),l=l.charCodeAt(0));return 31>=l||127===l},isWhitespace:function(l){l=a(l);return null!==l.match(/\s/g)},isLetterOrDigit:function(l){l=a(l);return null!==l.match(/[A-Za-z0-9]/g)}};return function(a){var c;if(!a||64<a.length)return!1;for(c=0;c<a.length;c++)if(127<a.charCodeAt(c))return!1;c=a.indexOf("@");if(c!==a.lastIndexOf("@")||1>c||c===a.length-1)return!1;var f=a.substring(0,
c),h=a.substring(c+1);if("."===h.charAt(0)||"."===h.charAt(h.length-1)||h.match(/[a-zA-Z\d\-.]+/)[0]!==h)return!1;for(c=0;c<h.length;c++)if(a=h.charAt(c),c<h.length-1&&"."===a&&"."===h.charAt(c+1))return!1;if(-1===h.indexOf("."))return!1;var g=h=!1;for(c=0;c<f.length;c++)if(a=f.charAt(c),h){switch(a){case "\\":g=!g;break;case '"':g||(h=!1);break;default:if(g&&!l.isLetterOrDigit(a))return!1;g=!1;if(l.isISOControl(a))return!1}if(!h&&('"'===f.charAt(c-1)||f.length-1!==c&&"."!==f.charAt(c+1)))return!1}else switch(a){case '"':if(0!==
c&&"."!==f.charAt(c-1))return!1;h=!0;break;case ".":if(0===c)return!1;break;case "(":case ")":case "\x3c":case "\x3e":case "[":case "]":case "\\":case ":":case ";":case ",":return!1;default:if(l.isISOControl(a)||l.isWhitespace(a))return!1}return!0}});"use strict";r.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page","safe-mash","loading-spinner-controller","weblab-helper").register("shipoptionselect-controller",function(a,l,m,c,f,h,g,b){function e(a){var b=
x(".delivery-window-groups .more-window");g.showSpinner(b,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");b=x("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");x.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+b+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a){g.hideSpinner();if(a&&a.deliveryWindowGroups){var b=
x(".delivery-window-groups .a-box-group");b.empty();x.each(a.deliveryWindowGroups,function(a,c){b.append(c)});a=x(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function p(a,b){var c=x("div.one-shipment:visible");a=v?x("div.one-shipment").slice(parseInt(a,10),parseInt(b,10)+1):x("div.one-shipment#"+a);k&&0!==a.size()&&c.last().attr("id")!==a.last().attr("id")&&(c.hide(),a.show(),x(q).scrollTop(0),c=x(document.activeElement),c.is("button, a, input:enabled")&&c.blur())}
function d(){if(k){var a=(location.hash?location.hash.replace("#",""):"0-"+I).split("-");2===a.length&&p(a[0],a[1])}}function n(){function e(a,b){x.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:b,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,b,c){l.hide()}})}function n(a){var b=a.closest("div."+m);a.is(":checked")?(b.siblings("div."+m+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),
b.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):b.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");t("triggerChangeEvent",[a])}0<x(".prime-calendar-container").length&&x(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&x(b).replaceWith(b.nodeValue)});var g=x(".delivery-window-groups .selected-group");
g.length&&g.trigger("click");z=x(".sosp-continue-button");k="1"===x("#isClientSidePagingEnabled").val()?1:0;I=b.isDigitalAsinIndexingFixedOnSOSPEnabled()?(x("div.shipment-with-ship-options:visible").length-1).toString():(x("div.one-shipment:visible").length-1).toString();u="1"===x("#useMashNavigateForClientSidePaging").val()?1:0;v="1"===x("#collapseDigitalShipmentsEnabled").val()?1:0;var m=(g=q.P&&q.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";k&&(x(".one-shipment:gt("+I+")").hide(),d());z.bind("click",
function(d){function e(a,b){var c=f.getCurrentPage();if(q.history&&q.history.pushState){var d=location.href;0<d.indexOf("#")&&(d=d.substring(0,d.indexOf("#")));d+="#"+a.attr("id")+"-"+b.attr("id");history.pushState({page:c,id:a.attr("id")},x("title"),d)}}var k=x("div.one-shipment:visible input[id\x3d'fresh-block-continue']");if(k){if("1"===k.val())return a.trigger("f3:fresh-sosp-continue:blocked"),d.preventDefault(),!1;"0"===k.val()&&a.trigger("f3:fresh-sosp-continue:allowed")}var n=!1;x("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(x(this).data("blockingOn"))return alert(x(this).data("blockingOn")),
d.preventDefault(),n=!0,!1});if(n)return!1;if(b.removesGiftOptionOnRush()&&c.isMobile()&&null!=E){var k=x("div.one-shipment:visible"),g=k.find("input[type\x3d'radio']:checked").closest(".shipping-option");if("1"===k.find("input[type\x3dhidden][name\x3disGiftWrapped]").attr("value")&&1===g.data("nosupportforgiftoption"))return E.show(),!1}B();k=x("div.one-shipment:visible");g=k.nextAll("div.one-shipment:hidden");if(0<g.length){d.preventDefault();var l=g.first(),m=l;v&&(m=g.filter(".shipment-with-ship-options"),
m=1<m.length?m.eq(1).prev():g.last());u&&h&&h.navigate?h.navigate({url:null,transitionEffect:"slide",successCallback:function(){e(l,m)},failCallback:function(a){}}):e(l,m);p(l.attr("id"),m.attr("id"));a.trigger("active-shipment-changed")}w("logInlineCalMetrics",[k])});x(".gift-option-removal-cancel-button").bind("click",function(a){E.hide()});x(".gift-option-removal-confirm-button").bind("click",function(a){l.show();E.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+x("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");
var b=x("div.one-shipment:visible"),c=b.nextAll("div.one-shipment:hidden");e(function(a,d,e){b.find("input[type\x3dhidden][name\x3disGiftWrapped]").each(function(){x(this).remove()});0<c.length?(z.click(),l.hide()):x(".checkout-page-form").submit()},a)});x(q).bind("popstate",function(a){c.isSosp()&&d()});x(document).delegate("div."+m,"click",function(a){a=x(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,
z&&z.length&&(a?z.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):z.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",!0)))});var G;a.declarative("faster-than-same-day-sosp-save",["click","submit"],function(){var b="lineItemsToRemoveGiftOptionFrom\x3d"+G.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");l.show();e(function(a,
b,c){G.closest(".one-shipment").find(".isGiftWrapped").each(function(){x(this).remove()});G.attr("checked",!0);n(G);l.hide()},b)});x(document).delegate("div."+m+" input[type\x3d'radio']","change",function(a,c){a=x(this);if("setActive"===c&&!a.attr("disabled")&&b.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGiftWrapped").length&&1==a.data("nosupportforgiftoption"))G=a,a.is(":checked")&&(c=a.closest("div."+m).siblings("div."+m+".selected").find('input[type\x3d"radio"]'),G.attr("checked",
!1),c.attr("checked",!0)),setTimeout(function(){x("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===c){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===c)if(a.attr("disabled",!0),a.is(":checked"))a.removeAttr("checked");else return;n(a)}});x("div."+m+" input[type\x3d'radio']:checked").change();x("h3").children().removeAttr("style");0===x("div."+m+".scheduled-delivery").length&&x("form.checkout-page-form").data("checkoutFormReady",!0).change();g&&x(document).delegate(".a-touch-radio a",
"click",function(a){if(!b.isSOSPExclusiveJSHandlerWeblabOn()||c.isSosp()){var d=x(a.target).attr("href");!d||d.startsWith("#")||d.toLowerCase().startsWith("javascript:")||(h&&h.navigate?h.navigate({url:d,transition:"slide"}):a.preventDefault=!1)}})}function B(){if(1===x("div.store-upsell-ship-options").length){var a="/gp/buy/shared/handlers/store-upsell-async.html",b="ox_store_upsell_continue_",c=x("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),
d=[],e;x.each(c,function(a,c){a=x(c);c=a.attr("value");d.push(c.toLowerCase());a.is(":checked")&&(e=a.attr("value"),b=a.hasClass("store-upsell-ship-option")?b+"success":b+"failure")});a=m.addQueryStringParameter(a,"ref",b);x.ajax({url:a,type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function t(a,b){r.when("checkout-federation-wrapper","shipspeed-provider").execute(function(c,d){c.wrap(function(){d&&!x.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"VasCheckoutShipSpeedProvider")})}
function w(a,b){r.when("checkout-federation-wrapper","sd-methods").execute(function(c,d){c.wrap(function(){d&&!x.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"CricketInlineCalendarHeavyBulkyIN")})}var x=a.$,z,k,u,I,v=0,E;a.declarative("sosp-change-quantity-link",["click"],function(a){var b=a.$currentTarget,c=x("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");b.hasClass("pipeline-link")?(a.$event.preventDefault(),b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click")):
b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});r.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",function(a,b){E=b.create({name:"gift-removal-popover",height:220,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!m.protectAgainstDoubleAction("sosp-extender-toggle")){var b=
a.$target.closest("a"),c=x(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(b.hasClass("aui-extender"))c.length?c.remove():e(a);else{var d=b.find("i"),b=b.closest("div.extender-section");d.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),b.find(".expanded").slideDown("fast"),d.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),e(a)):(b.find(".collapsed").show(),b.find(".expanded").slideUp("fast"),d.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),
c.length&&c.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!m.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var b=a.closest(".valid-slot");if(b.closest(".prime-calendar").hasClass("long-calendar")){var c=b.closest(".prime-calendar").data("orderid"),d=x("#calendar-"+c),c=x("#calendar-delivery-message-"+c),e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<b.length&&b.addClass("selected-slot");x(".a-button-close").trigger("click");
b=a.data("slotid");b=d.find(".slot-"+b);if(0<b.length)d.show(),c.parent().hide(),b.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),b.closest(".valid-slot").addClass("selected-slot");else{var f=a.parent()[0],k=a.parent().parent().find(".rhead")[0],b=k.innerText;b||(b=k.textContent);f=f.cellIndex;e=e.find("th")[f];f=e.innerText;f||(f=e.textContent);c.text(f+" "+b);d.hide();c.parent().show()}}else c=b.closest(".prime-calendar-container").data("orderid"),d=x("#calendar-"+
c).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<b.length&&b.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&x("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&x("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!m.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&!a.hasClass("dwg-button")&&
(a=a.find(".dwg-button"));x(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var b=a.closest(".delivery-window-groups").data("orderid"),c=a.data("key");!c&&a.find("button").length&&(c=a.find("button").data("key"));c&&x("#order_"+b+"_ShippingSpeed").val(c);c=a.data("isscheduleddeliveryslot");!c&&a.find("button").length&&(c=a.find("button").data("isscheduleddeliveryslot"));c&&(c=a.data("sddatastring"),!c&&a.find("button").length&&(c=a.find("button").data("sddatastring")),
x("#sdData"+b).val(c))}});a.on("checkout:reload:shipoptionselect",n);a.on("checkout:reload:spp-shipoption",n);a.on("checkout:reload:spp-f3-sosp",n);if(b.isVasTrueSPCEnabled())a.on("checkout:reload:spp-special-delivery-options",n)});r.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,l){function m(){a(".sosp .order-delivery-time-preference").each(function(){var c=a(this);c.bind("selectionChanged",function(){0===c.find(".delivery-time-preference-group").length?c.hide():(c.show(),
0===c.find("input:checked").length&&c.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){c.find(".delivery-time-preference-group").detach()});var f=c.closest(".one-shipment").find("input.shipping-option");c.find(".delivery-time-preference-group").each(function(){var f=a(this),g=f.data("shippingoptionid"),g=a("#"+g);f.is(".template")&&f.detach().removeClass("template");g.change(function(){c.trigger("empty");f.appendTo(c);c.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});
f.not(".hasDeliveryTimePreference").change(function(f,g){"disabling"===g||a(this).is(":disabled")||(c.trigger("empty"),c.trigger("selectionChanged"))});c.trigger("selectionChanged")})}r.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",m)})});r.when("A","shipoptionselect-controller").execute(function(a){var l=a.$,m={},c={};a.on("checkout:reload:shipoptionselect",function(){var a=l("#shippingOptionFormId"),h=a.find("input[name\x3dtrialKey]");if(1===h.length){for(var g in m)m.hasOwnProperty(g)&&
(m[g].abort(),delete m[g]);m={};c={};var b=function(a){return a.join("::").replace(/\s+/g,"_")},e=function(){return l.map(a.find("input[type\x3dradio]:checked"),function(a){return a.name})},p=function(){return l.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},d=function(a,b){if(m.hasOwnProperty(a)||c.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');b=l.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:b,dataType:"json",async:!0,success:function(b){b?console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');c[a]=b;delete m[a]},error:function(b,c,d){delete m[a];"abort"!==d&&(console.debug("trial "+a+" error"),r.error("issue with set-delivery-options trial: "+c,d))},cache:!1});m[a]=b;return!0},n=function(){for(var a=p(),a=b(a),c=Object.keys(m),d=0;d<c.length;++d){var e=
c[d];e!==a&&(console.debug('removing ajax call for trial key "'+e+'"'),m[e].abort(),delete m[e])}};l(document).delegate("#shippingOptionFormId","change",function(c){c=p();if(b(c)!==h.val())a:{n(),c=e();var g=p(),m=b(g);h.val(m);var x=d(m,a.serialize()),m=0;x&&++m;for(var z=0;z<c.length;++z)for(var k=a.find('input[type\x3dradio][name\x3d"'+c[z]+'"][value!\x3d"'+g[z]+'"]'),u=0;u<k.length;++u){var I=k[u],x=g.slice(0);x[z]=I.value;for(var x=b(x),v=I.name,I=I.value,E=a.serializeArray(),A=0;A<E.length;++A)E[A].name===
v&&(E[A].value=I),"trialKey"===E[A].name&&(E[A].value=x);v=l.param(E);if((x=d(x,v))&&5===++m)break a}}});l(document).delegate("#shippingOptionFormId","submit",function(a){n()})}})});r.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,l,m){function c(){m.isMobile()&&m.isSosp()&&g("div.scheduled-delivery").length&&(g(document).delegate("div."+e+":visible input[type\x3d'radio'].shipping-option","change",function(){h(g(this).closest("div."+e))}),a.on("active-shipment-changed",
h))}function f(a){b||(a.hasClass("scheduled-delivery-loading")?b=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&(b=a.find(".picking-tooltip").text()))}function h(a){b=null;a?f(a):g("div.one-shipment:visible div."+e+".scheduled-delivery").each(function(){var a=g(this);a.find("input").is(":checked")&&f(a)});b?l.show("scheduled-delivery",b):l.hide("scheduled-delivery")}var g=a.$,b,e=q.P&&q.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(m.isMobile())a.on("checkout:reload:shipoptionselect",
c);return{check:h}});"use strict";r.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller","gift-utility","client-side-metrics").register("gift-form-base-controller",function(a,l,m,c,f,h,g,b){function e(a){a.is(":checked")||(ea?a.is(":checked")||a.closest("label").click():(b.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function p(a){a.attr("disabled","disabled");ea&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}
function d(a){a.removeAttr("disabled");ea&&a.closest("div").unbind("click.disable")}function n(){r.when("a-dropdown").execute(function(a){var b=y(".select-recipient");b.empty();for(var c=0;c<C.length;c++){var d=y("\x3coption/\x3e").attr({value:C[c].value}).text(C[c].text);b.append(d)}b.each(function(){var b=y(this).closest(".gift-connection-section"),c=b.find(".include-gift-connection-checkbox").is(":checked"),d=b.find(".item-id").val(),e=b.find(".item-giftlist-type-id").val(),f;!e||"0"!==e&&"1"!==
e&&"2"!==e?e&&"3"===e&&(f=b.find(".item-giftlist-id").val()):f=e;!f&&c&&(c=b.find(".item-registry-id").val())&&ba&&ba[c]&&(f=ba[c]);f&&(a.setValue(y(this).attr("id"),f),(e&&"1"===e||"2"===e)&&b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),I(d))})})}function B(){y(".gift-connection-recipient-section").unbind("click").bind("click",function(){if(!aa)return y(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});y(".select-recipient").each(function(){y(this).unbind("change").bind("change",
function(){var a=y(this),b=a.next().find(".a-dropdown-prompt"),c=y("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();setTimeout(function(){b.html(c)},0)})});r.when("a-dropdown").execute(function(a){y(".gift-connection-section").each(function(){var b=y(this),c=b.find(".item-id").val(),d=b.find(".item-giftlist-type-id").val();b.find(".item-giftlist-id").val();var e=b.find(".item-occasion-id").val(),f=b.find(".item-occasion-month").val(),k=b.find(".item-occasion-day").val(),p=b.find(".item-age").val();
b.find("#input-recipient-first-name-"+c).unbind("keyup").keyup(function(){I(c)});b.find("#input-recipient-last-name-"+c).unbind("keyup").keyup(function(){I(c)});if("1"===d||"2"===d)a.setValue(b.find(".select-recipient").attr("id"),d),b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(b.find(".select-occasion").attr("id"),e);a.setValue(b.find(".select-occasion-month").attr("id"),f);a.setValue(b.find(".select-occasion-day").attr("id"),k);a.setValue(b.find(".select-occasion-age").attr("id"),
p);if("1"===e||"2"===e)b.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),"2"===d&&b.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&I(c)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",b=y(".item-registry-id").map(function(){if(y(this).val())return y(this).val()}).get().join();b&&(a+="?fromRegistryIds\x3d"+b);C?(n(),y(".select-recipient-spinner").hide(),aa=!0):(aa=!1,y.ajax({type:"POST",url:a,dataType:"json",async:!0,
cache:!1,timeout:5E3,success:function(a){!C&&a.options&&0<a.options.length&&(C=a.options);a.registryIdMapping&&(ba=a.registryIdMapping);C&&n();y(".select-recipient-spinner").hide();aa=!0},error:function(a,b,c){y(".select-recipient-spinner").hide();aa=!0}}))}function t(){ca=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",[]);y('[data-action\x3d"gift-form-element"]').each(function(){var a=y(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",
isInit:!0}):a.trigger({type:"change",isInit:!0})});y("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",function(){y(this).trigger("change")});0<y(".enable-gift-connections").length&&B()}function w(a,b){var c=31;if("1"===b)c=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===b||"5"===b||"8"===b||"10"===b)c=30;return c}function x(a,b,c){a=f.jsonify(a);m.redirect(a)}function z(a){r.when("a-dropdown").execute(function(b){y(".gift-connection-recipient-extra-"+
a).hide();b.setValue("select-recipient-"+a,"0");y("#input-recipient-first-name-"+a).val("");y("#input-recipient-last-name-"+a).val("")})}function k(a){r.when("a-dropdown").execute(function(b){y(".gift-connection-occasion-extra-"+a).hide();b.setValue("select-occasion-"+a,"0");b.setValue("select-occasion-month-"+a,"0");b.setValue("select-occasion-day-"+a,"0");b.setValue("select-occasion-age-"+a,"-1");y("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function u(a,b){r.when("a-dropdown").execute(function(c){for(var d=
0;d<C.length;d++)b&&b===C[d].value&&C[d].bMonth&&C[d].bDay&&(c.setValue("select-occasion-month-"+a,C[d].bMonth),c.setValue("select-occasion-day-"+a,C[d].bDay))})}function I(a){r.when("a-dropdown").execute(function(b){var c=y("#select-recipient-"+a).find(":selected").val();"0"!==c&&("1"!==c&&"2"!==c||y("#input-recipient-first-name-"+a).val()||y("#input-recipient-last-name-"+a).val())?b.updateSelect("select-occasion-"+a,{status:"enabled"}):(k(a),b.updateSelect("select-occasion-"+a,{status:"disabled"}))})}
function v(a,b,c){"1"===b&&"2"===c?y("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():y("#select-occasion-age-row-"+a).hide()}function E(){var a=y("#hidePricesCheckbox"),c=y("#kindle-reg-radio-your-account");ea?c.is(":checked")?y("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():(b.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),
y("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function A(){var a=y("#hidePricesCheckbox"),c=y("#kindle-reg-radio-another-account");ea?c.is(":checked")?y("#kindle-reg-radio-your-account").closest("label").click():a.is(":checked")&&a.closest("label").click():(b.increaseCount("removeauijs7"),a.is(":checked")&&a.removeAttr("checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),y("#kindle-reg-radio-your-account").attr("checked",
"checked").trigger("change")))}function N(){y("#hidePricesCheckboxLabel").hide();var a=y("#hidePricesCheckbox");ea&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");y("#kindle-reg-radio-another-account").attr("disabled",!0).trigger("change");y("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");y("#hidePricesDisabledMessage").show();y("#hidePricesDisabledMessage").removeClass("aok-hidden");ea&&(y("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",
function(a){a.stopPropagation()}),y("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function T(a){var b=!1;y(".afn-wrap-checkbox").each(function(){var a=y(this),a=a.is("input")?a:a.find("input");if(a.is(":checked"))return b=!0,!1});y(".mfn-no-wrap-radio").each(function(){var a=y(this),a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return b=!0,!1});if(b)E(),N();else if(y("#hidePricesCheckbox").is(":disabled"))y("#hidePricesCheckboxLabel").show(),
y("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),y("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),y("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),y("#hidePricesDisabledMessage").hide(),ea&&(y("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),y("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||
(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?E():A();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))y("#kindle-reg-radio-your-account").is(":checked")?A():E()}function Q(a){var b=y("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();b&&(y("#giftwrap-carousel-wrap-holder-"+a).css("width",90*b),y("#giftwrap-carousel-wrap-pane-"+a).css("width",90*ia));G(a)}function G(a){y("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(b,
c){b=y(c);b.find("input").is(":checked")&&L(b,{itemId:a})})}function L(a,b){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var c=b.itemId;b=b.wrapNo;var d=m.isSPP(),e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),e.val(d).change());var e=a.data("wrap-no"),
d=y("#giftwrap-option-preview-imagearea-default-"+c),f=y("#giftwrap-option-preview-imagearea-image-"+c),k=y(".selectedWrapLargeLink","#item-"+c),c=y(".wrapNo-"+c+"-"+b);a.hasClass("none-wrap")?(d.removeClass("aok-hidden"),f.addClass("aok-hidden"),k.length&&(k.addClass("aok-hidden"),k.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),f.find("img").attr("src",a),d.addClass("aok-hidden"),f.removeClass("aok-hidden"),k.length&&(k.addClass("aok-hidden"),k.removeClass("selectedWrapLargeLink")),
c.length&&(c.addClass("selectedWrapLargeLink"),c.removeClass("aok-hidden")));a=y(".selectedWrapLargeLink");c=y(".larger-image-link-carousel-"+e);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");c.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}function W(a,b){var c;c=b.itemId;b=y("#giftwrap-option-preview-imagearea-default-"+c);c=y("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),
c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function F(a,b){var c=b.itemId;b=y("#giftwrap-option-preview-imagearea-default-"+c);c=y("#giftwrap-option-preview-imagearea-image-"+c);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))b.removeClass("aok-hidden"),c.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";m.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");c.find("img").attr("src",a);
b.addClass("aok-hidden");c.removeClass("aok-hidden")}}function H(a,b){var c=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");b&&!d.is(":visible")?(a.hide(),c.show(),e.addClass("gift-warning")):(c.hide(),e.removeClass("gift-warning"),a.show())}function U(a){var b=y("#"+a.id),c=g.getCharCount(b.val(),a.useByteSize),b=g.getLineCount(b.val(),a.maxChars/a.maxLines);return{length:c,charDelta:a.maxChars-c,lineDelta:a.maxLines-b}}function V(a,
b){b=y("#item-"+b.itemId);var c=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");m.isSPP()&&y("#carouselGiftWrap").length&&(c=!a.hasClass("mfn-no-wrap-radio"));c?(b.find(".gift-message-pslip").hide(),b.find(".gift-message-card").show()):(b.find(".gift-message-card").hide(),b.find(".gift-message-pslip").show())}function X(b,c){var d=c.itemId;c=m.isSPP()?c.currentTab:b.data("current-tab");var e=y("#afn-gift-options-wrapper-"+d).data("active-tab");c!==e&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),
b.addClass("selected-giftwrap-tab"),y("#afn-gift-options-wrapper-"+d).data("active-tab",c),b="#item-"+d,e=m.isSPP()?y("#giftwrap-carousel-wrap-holder-"+d,b):b,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,c,d),c=y(".none-wrap",y(b)).find("input"),c.prop("checked",!0),c.val("").change(),m.isSPP()?(c=y("#afn-gift-options-wrapper-"+d),c.length&&(c=c.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,c))):a.trigger("checkout:gift:adaptCarousel",d),y("#giftwrap-carousel-wrap-holder-"+
d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),y("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),y("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),y("#giftwrap-option-preview-imagearea-image-"+d).addClass("aok-hidden"),c=y(".selectedWrapLargeLink"),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")),c=m.isSPP(),b="#item-"+
d,y("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),y("#includeMessageCheckbox-"+d).removeAttr("disabled"),c?y("#afn-message-span-"+d,y(b)).removeClass("aok-hidden"):(y("#afn-message-span",y(b)).removeClass("disable-message-area").addClass("enable-message-area"),y("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),y("#message-area-"+d).removeAttr("disabled")))}var ca,ia=4,C,aa=!1,ba,y=a.$,ea=q.P&&q.P.AUI_BUILD_DATE&&c.isMobile(),fa=g.getInput;
a.declarative("save-gift-for-later",["click"],function(a){h.show();a=a.$currentTarget.data("entityId")||a.data.entityId;l.call(a,0,{success:x})});r.register("gift-base/init-carousel",function(){return Q});r.register("gift-base/set-carousel-size",function(){return function(a){ia=a}});var da={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");var b=fa(a.find(".includeMessageCheckbox"));b&&b.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),
a.find(".item-wrap-row").show(),a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var b=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?b.find(".gift-notification-email").removeClass("a-form-disabled"):b.find(".gift-notification-email").addClass("a-form-disabled"):(b.find(".gift-notification-email").removeClass("a-form-disabled"),
a=b.find(".includeMessageCheckbox"),e(a.find("input[type\x3dcheckbox]")),ea&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(b){var c=a.state("giftNotificationEmailConstraints");c.push({id:b.attr("id")});a.state("giftNotificationEmailConstraints",c)},initGiftDeliveryDate:function(b){var c=a.state("giftDeliveryDateConstraints");
b.hasClass("year-select")||(b=b.parents("div.del-opt-date-section").find("select.year-select:first"));c.push({id:b.attr("id")});a.state("giftDeliveryDateConstraints",c)},updateDateDropdown:function(a){var b=a.closest(".gift-options-wrapper");a=b.find(".month-select").val();var c=b.find(".day-select");c.val();var b=b.find(".year-select").val(),d=w(b,a);if(c.hasClass("a-native-dropdown"))r.when("a-dropdown").execute(function(a){a=a.getSelect(c);if(a.getOptions().size()>d)for(var b=a.getOptions().size()-
1;b>=d;b--)a.removeOption(b);else for(b=a.getOptions().size();b<d;b++)a.addOption({text:b+1,value:b+1},b)});else{if(c.find("option").length>d)c.find("option:gt("+(d-1)+")").remove();else for(a=c.find("option").length+1;a<=d;a++)c.append(y("\x3coption\x3e",{value:a}).text(a));c.trigger("change")}},initSelectedTabAndWrapHolderWidth:Q,initGiftMessage:function(a,b){ea&&!a.is("textarea")&&(a=a.find("textarea"));ca.push({id:a.attr("id"),maxChars:parseInt(b.maxChars,10),maxLines:parseInt(b.maxLines,10),
useByteSize:b.useByteSize});fa(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===y("#multipleAFNGiftWrapOption").val()&&(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),Q(a))},enforceSelectorParity:T,enforceGiftReceiptParity:function(a,b){a=y("#item-"+b.itemId);if(0!==a.length){b=a.find(".item-receipt-row label");var c=fa(a.find(".includeReceiptCheckbox")),f=a.find(".mfn-hide-price-row label"),k=fa(a.find(".mfnHidePriceCheckbox")),
n=a.find(".item-message-row label"),g=fa(a.find(".includeMessageCheckbox")).is(":checked"),h=!1;0<a.find(".afn-wrap-checkbox").length?fa(a.find(".afn-wrap-checkbox")).is(":checked")&&(h=!0):0<a.find(".mfn-no-wrap-radio").length&&(fa(a.find(".mfn-no-wrap-radio")).is(":checked")||(h=!0));if(h||g)e(c),e(k);h||g&&n.is(":visible")?(p(c),b.addClass("checkout-gift-option-disabled"),p(k),f.addClass("checkout-gift-option-disabled")):(d(c),d(k),b.removeClass("checkout-gift-option-disabled"),f.removeClass("checkout-gift-option-disabled"))}},
enforceHidePriceParity:function(a){var b=!1;y(".includeReceiptCheckbox").each(function(){if(fa(y(this)).is(":checked"))return b=!0,!1});var c=!1;y(".mfnHidePriceCheckbox").each(function(){if(fa(y(this)).is(":checked"))return c=!0,!1});b||c?(E(),y(".kindle-reg-msg-your-account").hide(),y(".kindle-reg-msg-another-account").show()):(A(),y(".kindle-reg-msg-another-account").hide(),y(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var c=fa(a).is(":checked"),d=a.closest(".gift-options-wrapper");
a=d.find(".no-receipt-warning");var f=d.find(".empty-message-warning"),d=d.find(".item-message-row").find(".includeMessageCheckbox"),k=fa(d);c?(a.hide(),d.is(":visible")||e(k)):(f.hide(),a.show(),k.is(":checked")&&(ea?k.is(":checked")&&k.closest("label").click():(b.increaseCount("removeauijs5"),k.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var b=a.closest(".gift-options-wrapper");if(a.is("textarea"))b=fa(b.find(".includeMessageCheckbox")),e(b);else{a=fa(b.find(".includeMessageCheckbox")).is(":checked");
var c=b.find(".item-message-row label").is(":visible"),d=0<b.find(".empty-message-warning").length,f=b.find("textarea"),k=f.data("default-text"),p=0<f.val().length;a?(b.find(".gift-message-edit").show(),b.find(".gift-message-label").removeClass("a-color-secondary"),f.removeClass("a-form-disabled"),k&&f.val(k)):(c&&b.find(".gift-message-edit").hide(),b.find(".gift-message-label").addClass("a-color-secondary"),f.addClass("a-form-disabled"),k&&f.val(""));d&&(a&&p?H(b,!1):H(b,!0))}},toggleMessageLocationText:V,
toggleMessageBoxDisplay:function(b,c){var f=y("#item-"+c.itemId);if(0!==f.length){var k=f.find(".item-message-row");c=f.find(".item-receipt-row");var n=f.find(".gift-message-on-card"),g=f.find(".gift-message-on-receipt"),h=k.find("label"),k=fa(k.find(".includeMessageCheckbox")),u=a.trim(f.find(".gift-message-default-placeholder").text()),l=a.trim(f.find(".gift-message-with-wrap-placeholder").text()),f=f.find("textarea"),m=b.hasClass("mfn-no-wrap-radio")||b.closest("div").hasClass("mfn-no-wrap-radio");
fa(b).is(":checked")&&!m?(g.hide(),n.show(),f.attr("placeholder",l),c.is(":visible")&&(e(k),h.is(":visible")&&(p(k),h.addClass("checkout-gift-option-disabled")))):(n.hide(),g.show(),f.attr("placeholder",u),d(k),h.removeClass("checkout-gift-option-disabled"))}},updateContinueButtons:function(){for(var b=!0,c,d=0;d<ca.length;d++)if(c=y("#"+ca[d].id),c.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(c=U(ca[d]),0>c.charDelta||0>c.lineDelta))b=
!1;b?(y(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),y(".save-gift-button-box span.a-button-disabled").hide()):(y(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),b=y(".save-gift-button-box span.a-button-disabled"),b.removeClass("aok-hidden"),b.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},updateMessageCounter:function(a){ea&&!a.is("textarea")&&(a=a.find("textarea"));for(var b,c=0;c<ca.length;c++)a.attr("id")===
ca[c].id&&(b=U(ca[c]));if(b){a=a.closest(".gift-options-wrapper");c=a.find(".message-counter");c.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===b.length){H(a,!0);return}H(a,!1)}(-1>b.charDelta?c.find(".remaining-char-over-multiple").show():0>b.charDelta?c.find(".remaining-char-over-single").show():1===b.charDelta?c.find(".remaining-char-single").show():c.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(b.charDelta));(-1>b.lineDelta?
c.find(".remaining-line-over-multiple").show():0>b.lineDelta?c.find(".remaining-line-over-single").show():1===b.lineDelta?c.find(".remaining-line-single").show():c.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(b.lineDelta));c.show()}},updateSelectedGiftWrap:L,clearGiftConnection:function(a,b){y("#include-gift-connection-checkbox-"+b.itemId).is(":checked")||(z(b.itemId),I(b.itemId))},toggleGiftConnectionAgeDropdown:v,toggleGiftConnectionRecipientArea:function(a,b){a=
y("#select-recipient-"+b.itemId).find(":selected").val();var c=y("#select-occasion-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(y(".gift-connection-recipient-extra-"+b.itemId).hide(),"1"===c&&a&&u(b.itemId,a)):y(".gift-connection-recipient-extra-"+b.itemId).removeClass("aok-hidden").show();v(b.itemId,c,a);I(b.itemId)},toggleGiftConnectionOccasionArea:function(a,b){a=y("#select-occasion-"+b.itemId).find(":selected").val();var c=y("#select-recipient-"+b.itemId).find(":selected").val();
!a||"1"!==a&&"2"!==a?y(".gift-connection-occasion-extra-"+b.itemId).hide():("1"===a&&c&&"1"!==c&&"2"!==c&&u(b.itemId,c),y(".gift-connection-occasion-extra-"+b.itemId).removeClass("aok-hidden").show());v(b.itemId,a,c)},includeGiftConnection:function(a,b){(a=y("#select-recipient-"+b.itemId).find(":selected").val())&&"0"===a||y("#include-gift-connection-checkbox-"+b.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:X,updatePreviewImageOnMouseEnter:W,updatePreviewImageOnMouseLeave:F,toggleGiftMessageWarning:function(a){var b=
y("#"+a.attr("id"));g.toggleGiftMessageWarning(b,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(da[b[c]])da[b[c]](a.$target,a.data)});a.declarative("gift-form-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(da[b[c]])da[b[c]](a.$currentTarget,
a.data,a)});a.declarative("select-gift-wrap","click",function(a){L(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});T(a.$target);var b=a.$target.parents("li").find(".gift-hidden-radio");V(b,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){W(a.$target.parents("li"),a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){F(a.$target.parents("li"),a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var b=
a.$target.parents("li");b.attr("data",a.data);X(b,a.data)});a.on("checkout:reload:giftselect",t);a.on("checkout:reload:spp-giftoptions",t);return{extendFunctions:function(a){y.extend(da,a)}}});"use strict";r.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,l,m){function c(a){var b=a.closest(".expando-box");b&&(b=b.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&b.click())}function f(a){var b=a.closest(".gift-options-wrapper"),
c=b.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(c&&!c.is(":checked"))return!0;c=b.find(".email-error-selector");b.find(".gift-notification-email-error").hide();c.removeClass("a-form-error");if(64<q.unescape(encodeURIComponent(a.val())).length)return c.addClass("a-form-error"),b.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;c.addClass("a-form-error");b.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();
return!1}function h(){b("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();g(a)});b(".checkout-gift-image-preview-trigger \x3e a").show();b("#gift-kindle-imb").show()}function g(e){e=b("#giftForm");var p=e.find('input[name\x3d"hidePrices"]'),d=p.is(":disabled");d&&p.removeAttr("disabled");for(var n=!0,g=a.state("giftNotificationEmailConstraints"),h=a.state("giftDeliveryDateConstraints"),w=0;w<g.length;w++){var x=
b("#"+g[w].id);f(x)||(n=!1,c(x))}for(g=0;g<h.length;g++){w=b("#"+h[g].id);var x=w.closest(".gift-options-wrapper"),z=x.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(z&&!z.is(":checked"))x=!0;else{var k=x.find(".month-select").val(),u=x.find(".day-select").val(),z=x.find(".year-select"),I=z.val(),v=x.find("#current-date").val().split("-"),k=new Date(I,k,u),v=new Date(v[0],v[1]-1,v[2]),u=new Date(v.getTime());u.setMonth(u.getMonth()+12);x.find(".gift-delivery-date-error").hide();
I=x.find(".date-error-selector");z=z.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";I.removeClass(z);k>=u||k<v?(x.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),I.addClass(z),x=!1):x=!0}x||(n=!1,c(w))}a.state("continueAction",{enable:n});if(a.state("continueAction").enable)m.isSPP()||l.showPageTransition(),e.submit();else return b("html, body").animate({scrollTop:b(".a-form-error").closest("div").offset().top},500),!1;d&&p.attr("disabled",!0)}var b=a.$;
a.declarative("submit-gift-options","click",function(a){g(a)});a.declarative("discard-gift-options","click",function(a){b('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);b("#giftForm textarea").addClass("a-form-disabled");g(a)});a.on("checkout:reload:giftselect",h);a.on("checkout:reload:spp-giftoptions",h)});"use strict";r.when("A").register("teen-message-controller",function(a){var l=a.$;a.declarative("teen-message-form-element","click keyup",function(a){a=a.data.maxChars;var c=l("#teen-message-box").val(),
f=c.match(/(\r\n|\n|\r)/g),h=0;f&&(h=f.length);c=c.length+h;l(".remaining-char").text(Math.max(a-c,0))});l("#aui-teen-message-box").length&&l(".remaining-char").length&&r.when("A").execute(function(a){function c(a){a=a.val();var c=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+c}a=a.$;var f,h,g;f=a("#aui-teen-message-box");f.bind("change keypress",function(a){return c(f)>=g?(a.preventDefault(),!1):!0});f.bind("paste",function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&
a.originalEvent.clipboardData.getData("Text")){var e=a.originalEvent.clipboardData.getData("Text"),p=c(f);if(p+e.length>=g)return e=e.substring(0,g-p),e=f.val()+e,f.attr("value",e),a.preventDefault(),!1}return!0});f.bind("click keyup",function(){var a=Math.max(g-c(f),0);h.text(a)});h=a(".remaining-char");g=f.parent().data("maxchars")})});"use strict";r.when("A","page-transition-controller","page-conductor","loading-spinner-controller","client-side-metrics").register("concealment-form-del-opt-controller",
function(a,l,m,c,f){function h(a){var c=b("#concealmentForm");c.find("input:checked").length?(a=a.data.saveConcealmentRefTag,f.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,f.increaseCount("CPEX.Checkout.Cancel.Concealment",1));c.find("input[name\x3dref]").val(a);c.attr("action",c.attr("action")+"/ref\x3d"+a)}function g(a){a=b("#concealmentForm");m.isSPP()||l.showPageTransition();a.submit()}var b=a.$;a.declarative("submit-concealment-options","click",function(a){h(a);
g(a)});a.declarative("discard-concealment-options","click",function(a){b('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);h(a);g(a)});a.declarative("submit-concealment-form","click",function(a){h(a);a.$target.closest(".a-button").addClass("a-button-disabled");c.showSpinner(a.$target.closest("form"))})});"use strict";r.when("A","page-transition-controller","page-conductor","address-popovers","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-address-controller",
function(a,l,m,c,f,h,g,b,e){function p(){t(".lineitem").each(function(a,b){a=t(b);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});t("#suppressAddAddressPopover").val()&&t('select[name^\x3d"addressID."]').find("option").each(function(){var a=t(this);"New"===a.val()&&a.closest("optgroup").remove()})}function d(a){var c=(new Date).getTime(),d=m.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});
b.isHeadersCleaned()?t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:d,error:m.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==d&&d!==F)q.location=d;else if(n(a)){a=e.jsonify(a);B(a,c);var p;c=k.find('input[name^\x3d"previousAddress."]');if(null!==c||c!==F)p=x||c.val();var g=k.find('select[name^\x3d"addressID."]');null===g&&g===F||r.when("a-dropdown").execute(function(a){a.setValue(g.attr("id").replace(/\./g,
"\\."),p);g.find("option").removeAttr("selected");g.find('option[value\x3d"'+p+'"]').attr("selected","selected")});l.hide()}else m.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}):t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:d,error:m.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==d&&d!==F)q.location=
d;else if(n(c)){B(a,c);var e;a=k.find('input[name^\x3d"previousAddress."]');if(null!==a||a!==F)e=x||a.val();var p=k.find('select[name^\x3d"addressID."]');null===p&&p===F||r.when("a-dropdown").execute(function(a){a.setValue(p.attr("id").replace(/\./g,"\\."),e);p.find("option").removeAttr("selected");p.find('option[value\x3d"'+e+'"]').attr("selected","selected")});l.hide()}else m.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function n(a){var c;if(b.isHeadersCleaned()){if(a=
e.jsonify(a))c=a.showAddonWarning}else c=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==c&&c!==F}function B(a,c){b.isHeadersCleaned()?(c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");t(".item-list").hide();a.trim().split(",").forEach(function(a){t('[data-asin\x3d"'+a+'"]').show()});a=t("#addon-warning-"+c+"-launcher");a.length&&(t(".delete-title").hide(),t(".reduce-title").hide(),t(".select-address-title").show(),t("input[name\x3duseLiveAUI]").length?
h.get(a).attrs({$trigger:z,position:"triggerHorizontal"}).show():(c=t.Event("keyup",{triggerPositioningElement:z,manualTrigger:!0}),a.trigger(c)))}var t=a.$,w,x,z,k;a.declarative("itemselect-get-address",["click","touchend"],function(a){f.protectAgainstDoubleAction("itemselect-get-address",200)||(x=a.$currentTarget.find(".js-address-dropdown").val())});a.declarative("itemselect-update-address",["change"],function(a){if(!f.protectAgainstDoubleAction("itemselect-update-address",200)){g.resetMetrics();
var b=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");w=b.val();if("New"===w)c.actionTriggerPopoverFromDropdown(a),r.when("a-dropdown").execute(function(a){a.setValue(b.attr("id").replace(/\./g,"\\."),x)});else{l.show();k=b.closest(".lineitem");var e,p;if(k){var n=k.find('input[name^\x3d"lineItemEntityID."]');n&&(e=n.val());(n=k.find('input[name^\x3d"quantity."]'))&&(p=n.val());(n=k.find(".js-address-dropdown"))&&(w=n.val())}z=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):
a.$currentTarget;a=0;n=t("#addon-indicator");n.length&&"true"===n.attr("data-has-addon-items")&&(a=1);d({lineitems:e,addresses:w,quantities:p,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",["change"],function(a){if(!f.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){w=a.$currentTarget.val();l.show();var b="";a=a.$currentTarget.closest(".pantry-row");t(a).find(".pantry-item").each(function(a,c){a=t(c);b+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+
"\x26";b+="addresses\x3d"+w+"\x26";b+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});d(b)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(z!==F&&null!==z&&!f.protectAgainstDoubleAction("itemselect-delete-addons",200)){t(".a-button-close").trigger("click");l.show();a=(new Date).getTime();var b=t("#useCase").val(),c=m.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),d=k.find('input[name^\x3d"lineItemEntityID."]').val(),e=k.find('input[name^\x3d"quantity."]').val();
t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:d,addresses:w,quantities:e,isTrial:0,deleteAddons:1,returnHTML:1,useCase:b},headers:c,error:m.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&d!==F?q.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==F?q.location=d:(m.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});
a.on("checkout:reload:itemselect",p);a.on("checkout:reload:spp-itemselect",p)});"use strict";r.when("A","page-transition-controller","page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-delete-controller",function(a,l,m,c,f,h,g,b){function e(a,b){p(a,null===b||b===F?a.$currentTarget.closest(".lineitem"):b)}function p(a,b){a.$event.preventDefault();if(!c.protectAgainstDoubleAction("itemselect-delete-single-item",200)){h.resetMetrics();
l.show();x=b;k=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=x.find('input[name^\x3d"lineItemEntityID."]').val();b=0;(new Date).getTime();var d=w("#addon-indicator");d.length&&"true"===d.attr("data-has-addon-items")&&(b=1);n({lineitems:a,isTrial:b})}}function d(a,b){a.$event.preventDefault();if(!c.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){l.show();z=b;k=a.$currentTarget;var d="";a=0;b=w("#addon-indicator");b.length&&"true"===
b.attr("data-has-addon-items")&&(a=1);b=z.hasClass("pantry-row")?!0:!1;z.find(b?".pantry-item":".lineitem").each(function(a,b){d+="lineitems\x3d"+w(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"});n(d+"isTrial\x3d"+a)}}function n(a){var b=(new Date).getTime(),c=w('input[name\x3d"useCase"]').val(),d=m.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});w.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+c+"\x26cachebuster\x3d"+
b,data:a,dataType:"text",headers:d,error:m.ajaxRedirect,success:B})}function B(a,d,e){var f;f=e.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==f&&f!==F?(q.location=f,f=!0):f=!1;if(!f)if(f=e.getResponseHeader("x-amz-checkout-fatal-error"),null!==f&&f!==F)q.location=f;else{var k;if(g.isHeadersCleaned()){if(f=b.jsonify(a))k=f.showAddonWarning}else k=e.getResponseHeader("x-amz-checkout-show-addon-warning");k=null!==k&&k!==F?!0:!1;k?(t(a,e),l.hide()):(m.ajaxUpdatePage(a,d,e),c.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}
function t(a,c){g.isHeadersCleaned()?(a=b.jsonify(a),c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");w(".item-list").hide();a.trim().split(",").forEach(function(a){w('[data-asin\x3d"'+a+'"]').show()});a=w("#addon-warning-"+c+"-launcher");a.length&&(w(".delete-title").show(),w(".reduce-title").hide(),w(".select-address-title").hide(),w("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:k,position:"triggerHorizontal"}).show():(c=w.Event("keyup",{triggerPositioningElement:k,
manualTrigger:!0}),a.trigger(c)))}var w=a.$,x,z,k;a.declarative("itemselect-delete-item",["click","touchend"],e);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){d(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",["click","touchend"],function(a){if(k!==F&&!c.protectAgainstDoubleAction("itemselect-delete-addons",200)){w(".a-button-close").trigger("click");l.show();var b="";null!==z&&z!==F?(a=z.hasClass("pantry-row")?z.find(".pantry-item"):z.find(".lineitem"),
w(a).each(function(a,c){b+="lineitems\x3d"+w(c).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==x&&x!==F&&(b+="lineitems\x3d"+x.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");n(b+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",["click","touchend"],function(a){p(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",["click","touchend"],function(a){d(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",
["click","touchend"],function(a){var b=a.$currentTarget.data("entityidtodelete");d(a,w('a[data-entityid\x3d"'+b+'"]').closest(".item-row"))});return{actionDeleteItem:e}});"use strict";r.when("A","page-transition-controller","page-conductor","itemselect-delete-controller","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-quantity-controller",function(a,l,m,c,f,h,g,b,e){function p(){z(".lineitem, .pantry-item").each(function(a,b){a=z(b);
a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function d(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}function n(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),
e;e="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(c,10)||""===c?("change"===a.type&&d(a.$currentTarget.closest(e)),b.hide()):(a=a.$currentTarget.closest(e).find('input[name^\x3d"previousQuantity."]').val(),c!==a?b.show():b.hide())}function B(a){a.$event.preventDefault();if(!f.protectAgainstDoubleAction("itemselect-update-quantity",200)){g.resetMetrics();I=a.$currentTarget.closest("itemselect-update-pantry-quantity"===a.action||"itemselect-update-pantry-quantity-text-field"===
a.action?".pantry-item":".lineitem");var p=I.find(".js-address-dropdown").val(),n=a.$currentTarget.find("select"),h=n.length?n:a.$currentTarget;k=h.is("select")?h.val():I.find(".quantity-input").val();if(0===parseInt(k,10)||""===k)d(I);else if("Delete"===k)r.when("a-dropdown").execute(function(a){a.setValue(h.attr("id").replace(/\./g,"\\."),u)}),c.actionDeleteItem(a,I);else{l.show();a=I.find('input[name^\x3d"lineItemEntityID."]').val();var n=0,B=(new Date).getTime(),G=z("#useCase").val(),L=z("#addon-indicator");
v=h.is("select")?h.parent():I.find(".quantity-input");L.length&&"true"===L.attr("data-has-addon-items")&&(n=1);L=m.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});b.isHeadersCleaned()?z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+B,data:{lineitems:a,quantities:k,address:p,isTrial:n,returnHTML:1,useCase:G},dataType:"text",headers:L,error:m.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==d&&d!==F?q.location=d:w(a)?(a=e.jsonify(a),x(a,c),t(u===F?I.find('input[name^\x3d"previousQuantity."]').val():u,c),l.hide()):(m.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}):z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+B,data:{lineitems:a,quantities:k,address:p,isTrial:n,returnHTML:1,useCase:G},dataType:"text",headers:L,error:m.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==d&&d!==F?q.location=d:w(c)?(x(a,c),t(u===F?I.find('input[name^\x3d"previousQuantity."]').val():u,c),l.hide()):(m.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}}function t(a,b){10>a?(r.when("a-dropdown").execute(function(b){var c=I.find('select[name^\x3d"quantity."]');b.setValue(c.attr("id").replace(/\./g,"\\."),a);c.find("option").removeAttr("selected");c.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),I.find(".quantity-dropdown").show(),
I.find(".quantity-text-field").hide(),I.find(".js-select").prop("disabled",!1),I.find(".quantity-input").prop("disabled",!0)):(I.find(".quantity-dropdown").hide(),I.find(".quantity-text-field").show(),I.find(".update-quantity-link").hide(),I.find(".js-select").prop("disabled",!0),I.find(".quantity-input").prop("disabled",!1));I.find(".quantity-input").val(a);I.find('input[name^\x3d"previousQuantity."]').val(a)}function w(a){var c;if(b.isHeadersCleaned()){if(a=e.jsonify(a))c=a.showAddonWarning}else c=
a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==c&&c!==F?!0:!1}function x(a,c){b.isHeadersCleaned()?(c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");z(".item-list").hide();a.trim().split(",").forEach(function(a){z('[data-asin\x3d"'+a+'"]').show()});a=z("#addon-warning-"+c+"-launcher");a.length&&0<a.length&&(z(".reduce-title").show(),z(".delete-title").hide(),z(".select-address-title").hide(),z("input[name\x3duseLiveAUI]").length?h.get(a).attrs({$trigger:v}).show():
(c=z.Event("keyup",{triggerPositioningElement:v,manualTrigger:!0}),a.trigger(c)))}var z=a.$,k,u,I,v;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){f.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(u=a.$currentTarget.find("select").val())});a.declarative("itemselect-update-quantity",["change"],B);a.declarative("itemselect-update-pantry-quantity",["change"],B);a.declarative("addon-delete-items",["click","touchend"],function(a){if(v!==
F&&!f.protectAgainstDoubleAction("itemselect-delete-addons",200)){z(".a-button-close").trigger("click");l.show();a=I.find('input[name^\x3d"lineItemEntityID."]').val();var b=(new Date).getTime(),c=z("#useCase").val(),d=m.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+b,data:{lineitems:a,quantities:k,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:d,error:m.ajaxRedirect,
success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&d!==F?q.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==F?q.location=d:(m.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){f.limitInputToNumbers(a)});a.declarative("itemselect-update-quantity-text-field",["click","touchend"],B);a.declarative("itemselect-update-pantry-quantity-text-field",
["click","touchend"],B);a.declarative("itemselect-show-update-button",["change","keyup"],n);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],n);a.on("checkout:reload:itemselect",p);a.on("checkout:reload:spp-itemselect",p)});"use strict";r.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",function(a,l,m,c,f){var h=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],
function(a){a.$event.preventDefault();f.resetMetrics();if(!c.protectAgainstDoubleAction("itemselect-ship-to-multiple",200)){l.show();var b=null,e=null,p=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,c){a=h(c);c=a.find('select[name^\x3d"quantity."]');var d=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<c.val())return b=a.find('input[name^\x3d"lineItemEntityID."]').val(),e=c.val(),p=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&
1<d.val())return b=a.find('input[name^\x3d"lineItemEntityID."]').val(),e=d.val(),p=a.find(".js-address-dropdown").val(),!1});if(null!==b){a=(new Date).getTime();var d=m.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});h.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:b,quantity:e,address:p},headers:d,dataType:"text",error:m.ajaxRedirect,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-fatal-error");
null!==e&&e!==F?q.location=e:(m.ajaxUpdatePage(a,b,d),c.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});"use strict";r.when("A").register("safe-apx-helper",function(a){var l={},m=a.$;return{get:function(a){return l[a]},set:function(){1===arguments.length?l=m.extend(l,arguments[0]):2===arguments.length?l[arguments[0]]=arguments[1]:q.console&&q.console.error&&q.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",arguments.length)}}});"use strict";r.when("A",
"weblab-helper").register("mobile-carrier-billing-util",function(a,l){var m=!1;return{determineIsMCBEnabled:function(a){m=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},toggleGCForMCB:function(a,f){if(!l.isMCBMultiTenderWeblabEnabled()&&m&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var h=f.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]'),h=f.existingBalance||h,g=0<f.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,
b="paymentsForm"in f&&0<f.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,g=g||b;0<a.filter("[value^\x3dMCB]").size()&&g?(h.length&&(h.prop("checked",!1),h.prop("disabled",!0)),f.mcbBalanceWarning&&f.mcbBalanceWarning.show()):(h.length&&h.prop("disabled",!1),f.mcbBalanceWarning&&f.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){m&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},hideMCBWarningMessageForPoints:function(a){m&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});
"use strict";r.when("A").register("emi-utils",function(a){return{}});"use strict";r.when("A").register("emi-helper",function(a){return{}});"use strict";r.when().register("instant-bank-discount-helper",function(){return{showInstantBankDiscountAmazonPayDeselected:function(){},showInstantBankDiscountAmazonPaySelected:function(){}}});"use strict";r.when("A","page-detector","checkout-general-utils").register("pay-common-lib",function(a,l,m){function c(a,b){b.attr("name")&&(a[b.attr("name")]=b.val());b.attr("id")&&
(a[b.attr("id")]=b.val())}function f(a,b){if(!b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function h(a,b,c){g.each(b,function(b,d){a[b]=c?c.find(d):g(d)})}var g=a.$,b="checkbox hidden password radio text number tel month".split(" "),e={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(m.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(g(q).scrollTop(a.$declarativeParent.offset().top),
a.$event.preventDefault())});return{getAttributeData:function(a,b){if(a)return a.attr(b)||a.attr("data-"+b)||a.data(b)},getElements:function(a,b){var c={};h(c,a,b);return c},getInputValues:function(a){var d=a.find(".data-row").data()||{};a.find("input").each(function(){var a=g(this),e=a.attr("type");("radio"!==e&&"checkbox"!==e||a.is(":checked"))&&-1<g.inArray(e,b)&&c(d,a)});a.find("select").each(function(){c(d,g(this))});return d},isDesktopCX:l.isDesktopPayment,isMobileCX:l.isMobilePayment,isPayPage:l.isPayment,
isTouchCX:l.isTabletPayment,mergeFrom:function(a,b){b=f({},b);return f(b,a)},prop:function(a,b,c){if(a){if(1<arguments.length)return b===F?delete e[a]:e[a]={isOneTime:c?1:0,value:b},b;var f=e[a];if(f)return f.isOneTime&&delete e[a],f.value}},refreshElements:h,scrollTopTo:function(a){a&&a.length&&g("html,body").animate({scrollTop:a.offset().top-20},"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=g("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),
b=a.closest("div.payment-selected");b&&0<b.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var b={},c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b}}});"use strict";r.when("A","pay-common-lib","a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,l,m,c,f,h,g){function b(a){a.$event.preventDefault();
a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function e(a){a.preventDefault();var b=u(a.currentTarget),c=b.closest("div.expando-section");a=c.find("div.expando-content");var c=c.find("div.expando-reverse-content"),d=a.is(":visible"),e=function(){var a=b.find("i");a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):
(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show())};d?(c.slideDown("fast"),
a.slideUp("fast",e)):(c.slideUp("fast"),a.slideDown("fast",e))}function p(a){var b=a.$target.closest("a");a=b.closest("div.extender-section");b=b.find("i");b.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),b.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),b.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function d(a){N.msgPopovers.filter(":visible").hide();
a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");a.is(":visible")||a.show()}function n(a,b,c){var d=a||{},e="string"===typeof a;c=c&&c.useSif?u('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",c&&(d+="\x26isAmazonApp\x3d1")):(d.ajaxResponse=1,d.returnjson=1,c&&(d.isAmazonApp=1));for(c=0;c<A.length;c++){var f=A[c],k=u("input[name\x3d"+f+"]").val();e?-1===b.search(f)&&-1===a.search(f)&&(d=d+"\x26"+
f+"\x3d"+k):d[f]=k}return d}function B(a,b){if(0>a)return 0;isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:B(a.substring(0,b-3),0)+","+a.substring(b-3)}function t(a,b,c,d){a="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(c){a=c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+a):
c+("\x26ref\x3d"+a);N.pageContainer.find("#tempForm").remove();c=u('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');c.attr("action",a);if("string"===typeof d){a={};b=d.split("\x26");for(var e=0;e<b.length;e++){var f=b[e].split("\x3d");2===f.length&&(a[f[0]]=f[1])}}else a=d;for(var k in a)"ajaxResponse"!==k&&"returnjson"!==k&&(a=u('\x3cinput type\x3d"hidden"/\x3e').attr("name",k).val(d[k]),c.append(a));N.pageContainer.append(c);c.submit()}}function w(a,b,d,e){var f=h.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),
f={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:n(b,a,e),dataType:"text",headers:f,timeout:v,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b)},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,e):t(c,e,a,b)},success:function(a,b,e){var f=e.getResponseHeader("x-amz-checkout-page");if("payselect"!==f&&"spp-payment"!==f)return a=c.jsonify(a),h.redirect(a);d&&d.successHandler?
d.successHandler(a,b,e):h.ajaxUpdatePage(a,b,e)}};u.extend(f,e);E.push(u.ajax(f))}function x(a,b,c,d){var e=h.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:n(b,a,d),dataType:"text",headers:e,timeout:v,type:"POST",url:a,error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):t(d,e,a,b)},success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&c&&c.pageUpdater?
c.pageUpdater(a):h.ajaxUpdatePage(a,b,d)}};u.extend(e,d);E.push(u.ajax(e))}function z(){v=parseInt(u("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10);v=isNaN(v)?1E4:v;l.isMobileCX()?q&&(q=!1):(N=l.getElements(r),q&&(a.declarative("close-popover",["click"],b),a.declarative("toggle-msg-popover",["click"],d),a.declarative("a-extender-toggle",["click"],p),q=!1),N.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",e),N.pageContainer.find("form select.a-touch-select-input").unbind("change",
k).bind("change",k),u(".a-dropdown-container").each(function(){m.remove(u(this).find("select").attr("name"))}),u(document).bind("click",function(a){a.isPropagationStopped()||0===u(a.target).closest(".pay-popover-msg").length&&N.msgPopovers.filter(":visible").hide()}))}function k(a){var b=u(a.currentTarget);a=b.siblings("a.a-placeholder");b=b.find(":selected").text();a.html(b);return!1}var u=a.$,q=!0,v,E=[],A=["forceResponsive","fromAnywhere","hasWorkingJavascript"],N={},r={msgPopovers:"div.pay-popover-msg",
pageContainer:"div.a-container"};a.on("checkout:reload:payselect",z);a.on("checkout:reload:spp-payment",z);return l.mergeFrom({decodeJSONResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:N,getNumberWithSeparators:B,handleForm:function(a,b,c){a.$event.preventDefault();
var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=l.processSubmissionParameters(d);w(a.data.action,d,b,c)},makeAjaxCall:w,handleAjaxError:t,handlePaymentsPortalForm:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);w(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;x(b,a,c,d)}},l)});"use strict";r.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",
function(a,l,m){function c(a,b,c){a=a||{};var d=w.fromAnywhereField.val(),e=c&&c.useSif?n('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0,f=g();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+f,-1===b.search("fromAnywhere")&&-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=f,-1===b.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),c&&c.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=
!0));return a}function f(){B&&B.abort("abort-for-cleanup");B=null}function h(a,b,c,d){a=a&&a.status;b="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";c&&(c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+b):c+("\x26ref\x3d"+b),p(c,d))}function g(){var a;n.each(t,function(b,c){if(c.pageId&&n(c.pageId).is(":visible"))return a=
b,!1});return a}function b(a){(a=t[a]&&t[a].componentId)&&r.when(a).execute(function(a){a.init&&a.init()})}function e(a,d,e,f,g){g&&g.suppressSpinner||m.show();g={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:c(d,a,f),dataType:"text",timeout:k,type:"POST",url:a,beforeSend:function(a,b){e&&e.beforeHandler&&e.beforeHandler(a,b)},complete:function(a,b){e&&e.completeHandler&&e.completeHandler(a,b);d&&d.isHideSpinnerDisabled||m.hide()},error:function(b,c){e&&e.errorHandler?e.errorHandler(b,
c):h(b,c,a,d)},success:function(c,f,k){var n=k.getResponseHeader("x-amz-checkout-pay-page-name");if(n){var g=k.getResponseHeader("x-amz-checkout-pay-page-title");g&&w.pageTitle.text(decodeURIComponent(g));e&&e.successHandler?e.successHandler(c,f,k):w.pageContainer.html(c);b(n)}else h(null,"unknown",a,d)}};n.extend(g,f);B=n.ajax(g)}function p(a,b,c){var d=n("#tempForm",w.pageContainer);0<d.length&&d.remove();d=n('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);c&&c.target&&d.attr("target",
c.target);if("string"===typeof b)for(a=b.split("\x26"),b=0;b<a.length;b++)c=a[b].split("\x3d"),2===c.length&&"ajaxResponse"!==c[0]&&(c=n('\x3cinput type\x3d"hidden"/\x3e').attr("name",c[0]).val(c[1]),d.append(c));else for(var e in b)"ajaxResponse"!==e&&d.append(n('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(b[e]));w.pageContainer.append(d);d.submit()}function d(a,d,e,f,g){g&&g.suppressSpinner||m.show();g={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:c(d,a,f),dataType:"text",
timeout:k,type:"POST",url:a,complete:function(a,b){e&&e.completeHandler&&e.completeHandler(a,b);m.hide()},error:function(b,c){e&&e.errorHandler?e.errorHandler(b,c):h(b,c,a,d)},success:function(a,c,d){var f=d.getResponseHeader("x-amz-checkout-pay-page-name");if(!f&&e&&e.pageUpdater)e.pageUpdater(a);else{var k=d.getResponseHeader("x-amz-checkout-pay-page-title");k&&w.pageTitle.text(decodeURIComponent(k));e&&e.successHandler?e.successHandler(a,c,d):w.pageContainer.html(a);b(f)}}};n.extend(g,f);B=n.ajax(g)}
var n=a.$,B=null,t={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},w={},x={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",
pageTitle:"head title"},z=!0,k;return l.mergeFrom({decodeJSonResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:w,getCurrentPage:function(){return w.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:g,getPageId:function(a){a=
a.getResponseHeader("x-amz-checkout-pay-page-name");return t[a]&&t[a].pageId},handleForm:function(a,b,c){a.$event.preventDefault();e(a.data.action,a.$target.serialize(),{successHandler:function(a,c,d){b(a,c,d)}},c)},submitFormRequest:p,init:function(){l.isMobileCX()&&(q.onbeforeunload=f,l.refreshElements(w,x),k=parseInt(n("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),k=isNaN(k)?1E4:k,z&&(z=!1,n("div.pay-mobile").bind("keypress",function(a){l.prop("activeGoElement",13===a.keyCode?
document.activeElement:null,!0)})))},makeAjaxCall:e,handleAjaxError:h,pages:t,handlePaymentsPortalForm:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);e(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,e){a=l.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;d(b,a,c,e)}},l)});"use strict";r.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,l,m){return a.isMobile()?m:l});"use strict";
r.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,l,m,c,f,h){function g(){function a(b,c,d,e){aa.push({identifier:b,priority:d||100,target:c,isPincodeError:e})}function g(a){if(!a)return null;var b=new RegExp(String.fromCharCode(32),"g"),c=new RegExp(String.fromCharCode(45),"g");return a.replace(b,"").replace(c,"")}function B(){return 0<aa.length}function t(a){if(!a||0===a.length)return!1;for(var b=
0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10}function w(a,b){return a&&a.match(/^[0-9]+$/)&&a.length===b}function x(a,b,c){return a&&a.match(/^[0-9A-Za-z]+$/)&&a.length>=b&&a.length<=c}function z(a,b){if(!a||!b)return!1;a=parseInt(a,10);b=parseInt(b,10);return k(a,b)}function k(a,b){var c=new Date,d=c.getFullYear();return b>d||b===d&&a>=c.getMonth()+1}function u(a){a=a.val();return!a||0===a.length}function q(){var c=b("#pm_pay_by_check").is(":checked"),
e=b("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");c&&e&&a("continue_BadCombinationCheckExistingBalance")}function v(c){if(b("#jppoints").length){var e,f=!1;1===c.length&&"jppoints"===c.attr("id")?(e=c,f=!0):e=c.filter("#jppoints");if(e&&e.find("#redeemPoints").is(":checked")){c=e.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();c=parseInt(c,10);b('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(c-=parseInt(e.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),
10));var k=parseInt(e.find("#redeemableAmount").text(),10),g=e.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');e.find("#jpPointsMax").is(":checked")?e=k:(e=parseInt(g.val(),10))||(e=0);e>k?a("continue_jpPointsExceedsRedeemableAmount",g):f&&e<c?a("continue_notEnoughJPPoints"):e>c&&a("continue_jpPointsExceedsTotalPurchase")}}}function E(b){b&&(b=b.find(".pci-blocking-cvv"),b.length&&b.is(":visible")&&a("PCI_Block_CVV"))}function A(b){var c=b.find(".currency-list");c.length&&c.is(":visible")&&
(b=c.find("[type\x3dradio]:checked").val(),c=c.find("#cardCurrencyDropDown option:selected").val(),b&&("Other"!==b||"-1"!==c&&"-2"!==c)||a("continue_SelectCardCurrency"))}function N(b){var c=b.find("#existingCvvNum");if(0!==c.length){var f=c.val();b=e?b.data("validcvvlength"):b.attr("validcvvlength");w(f,parseInt(b,10))||a("continue_BadSecurityCode",c)}}function T(b){var c=b.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(c)&&b.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}
function Q(b){b=b.find("#existingPincodeNum");if(0!==b.length){var c=b.val();c?x(c,4,8)||a("existingCreditCard_PincodeInvalid",b,null,!l.isMobileCX()):a("continue_EmptyPincode",b)}}function G(c){if(c&&c.length)for(var e=0;e<c.length;e++){var f=b(c[e]);E(f.parent());N(f);Q(f);"netBanking"===f.find('input[name\x3d"paymentMethod"]').val()&&(b("#netBanking_select").val(),b("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));T(f);var k=f;k.find('input[name\x3d"paymentMethod"]').val();
k.find("#vdcBanksSelect").val();b("#vdcBanksSelect").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable");C(f);f=f.siblings("#upi-acceptance-input").find("#vpaCollect");if(!f||f.length)(k=f.val())&&k.match(/.+@.+/)||a("continue_BadVpaForUpi",f)}}function L(b){var c=b.find("#newMonth"),e=b.find("#newYear");b=b.find("#newExpDate");!(c=c.length&&!z(c.val(),e.val()))&&(c=b.length)&&((b=b.val())?(c=b.split("-"),b=parseInt(c[0],10),c=parseInt(c[1],10),b=k(c,b)):b=!1,c=!b);
c&&a("continue_BadExpiration")}function W(b){"domesticCards"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&b.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function Z(c){var e=b("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");c=l.getAttributeData(c,"paymentmethodtype");e&&"creditCard"!==c&&a("continue_FlexiblePaymentsNeedsCreditCard")}function H(b){"thirdPartyAccounts"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&
0!==b.length||a("continue_BlankSlate"))}function U(b){var c=b.find(".rewards-list");if(c.length&&c.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){b=c.find("input.custom-rewards-input");var e=b.val();if(c.hasClass("show-currency-input-widget-new")){var c=b.data("country-code"),f=m.getCurrencyFormatByCountryCode(c),c=b.data("min"),e=m.getAmount(e,f.decimalPlace);e<c&&a("continue_BadRewardsMin")}else/^\s*$/.test(e)||isNaN(e)?a("continue_BadRewardsValue"):(e=parseFloat(b.val()),
c=b.data("min"),0>=e||e<c?a("continue_BadRewardsMin"):e>b.data().max&&a("continue_BadRewardsMax"))}}function V(c){var e=c.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===e?a("continue_BlankSlate"):"verifiedDebitCard"===e&&(e=c.find("#vdcBanksSelect").val(),(""===e||"OtherBanks"===e||"1"===b("#save_citi_card").val()&&"CIT"===e)&&a("continue_BlankSlate"),c.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function X(b){"cashOnDeliveryCash"===b.find('input[name\x3d"paymentMethod"]').val()&&
b.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function ca(b){if("netBanking"===b.find('input[name\x3d"paymentMethod"]').val()){var c=b.find("#net-banking-select-list").val();b=b.find("option:selected").prop("disabled");""===c&&a("continue_BlankSlate");b&&a("continue_BankTemporarilyNotAvailable")}}function ia(b){"morePaymentMethod"===b.find('input[name\x3d"paymentMethod"]').val()&&""===b.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function C(c){var e=
c.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===e||"StandaloneCreditCardInstallment"===e||"StandaloneReusableCreditLineInstallment"===e)c.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===e?a("continue_GilCCContinueError"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),c.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===
e?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),c.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<b("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&("StandaloneCreditCardInstallment"===e?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===e?a("continue_GilRCLContinueErrorPromotions"):
a("continue_GilContinueErrorPromotions"))}var aa=[],ba=null,y=null,ea=function(a){p=a};p||(l.isMobileCX()?r.when("rewards-section-mobile").execute(ea):r.when("rewards-section-desktop").execute(ea));return{displayErrors:function(a,c){(ba=a)&&ba.hide().find(".error-message").hide().addClass("hidden");(y=c)&&y.find(".a-form-error").removeClass("a-form-error");if(B()){for(a=0;a<aa.length;a++){c=aa[a];if(c.target){var d=c.target.parent();d.hasClass("a-input-text-wrapper")&&!d.hasClass("a-form-error")?
d.addClass("a-form-error"):c.target.hasClass("a-form-error")||c.target.addClass("a-form-error")}c=c.identifier;(ba&&ba.length?ba.find("#"+c):b("#"+c)).show().removeClass("hidden")}ba&&ba.length&&ba.show()}},getHighestErrorId:function(){for(var a={priority:100},c=0;c<aa.length;c++){var d=aa[c],e;(e=d.identifier)?(e=ba&&ba.length?ba.find("#"+e):b("#"+e),e=parseInt(l.getAttributeData(e,"priority"),10),e=isNaN(e)?100:e):e=100;e<=a.priority&&(a={identifier:d.identifier,priority:e,isPincodeError:d.isPincodeError,
target:d.target})}return a},hasErrors:B,isValidCardCVV:w,isValidCardPincode:x,validateBankAccountNum:function(b,c){u(b)&&a("addBankAccount_NoAccountNumber",c)},validateBankAccountNumConfirm:function(b,c,e){b.val()!==c.val()&&a("addBankAccount_AccountNumberMismatch",e)},validateBankDriverLicense:function(b,c){u(b)&&a("addBankAccount_NoDLNumber",c)},validateBankDriverLicenseState:function(b,c){b.val()!==F&&""!==b.val()&&"0"!==b.val()||a("addBankAccount_NoDLState",c)},validateBankHolderName:function(b,
c){u(b)&&a("addBankAccount_NoName",c)},validateBankRoutingNum:function(b,c){9!==b.val().length&&a("addBankAccount_ShortRoutingNumber",c)},validateCreditCardCVV2:function(b,c,e){e="true"===b.attr("isaddresschallenge")?b.attr("issuer"):e&&e.charAt(0);"R"!==e&&(b=b.val(),w(b,"A"===e?4:3)||a("addCreditCard_BadSecurityCode",c))},validateCreditCardDate:function(b,c,e,f){z(b.val(),e.val())||(a("addCreditCard_BadExpiration",c),a("addCreditCard_BadExpiration",f))},validateCreditCardMobile:function(b,c){b=
b.val();h.isUpdateMobileNumberEnabled()?b&&b.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",c):b&&b.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",c)},validateCreditCardPincode:function(b,c){(b=b.val())&&b.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",c)},validateCreditCardName:function(b,c){u(b)&&a("addCreditCard_NoName",c)},validateCreditCardNumber:function(c,e){var f=g(c.val());f&&10<f.length&&t(f)||a("addCreditCard_BadNumber",
e);f=b("#creditCardIssuersBlocked").val();c=c.data("issuer");f&&""!==f&&c&&""!==c&&-1<b.inArray(c,f.split(","))&&a("addCreditCard_IssuerUnsupported",e)},validateSBIMaestroCardNumberLength:function(b,c){19!==g(b.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",c)},isAMEXCreditCard:function(a){a=g(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(b,c){var f=g(b.val());f&&10<f.length&&t(f)?(b=(l.isMobileCX()&&e?b.parent().data():b.data()).tail+
"",f.substr(f.length-b.length)!==b&&a("addCreditCard_NotMatch",c)):a("addCreditCard_NotMatch",c)},validateCreditCardType:function(b,c){b.is(":visible")&&((b=b.val())&&b.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",c))},validateRegistrationResult:function(b){b.cardStatus?1===b.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<b.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(b,c){u(b)&&a("addDirectDebit_NoAccountOwnerName",c)},validateDirectDebitAccountNum:function(b,
c){u(b)&&a("addDirectDebit_NoAccountNumber",c)},validateDirectDebitRoutingNum:function(b,c){u(b)&&a("addDirectDebit_NoRoutingNumber",c)},validateInvoiceFirstName:function(b,c){u(b)&&a("addInvoiceAccount_NoFirstName",c)},validateInvoiceLastName:function(b,c){u(b)&&a("addInvoiceAccount_NoLastName",c)},validateLocName:function(b,c){u(b)&&a("addLoc_NoName",c)},validateLocNumber:function(b,c){u(b)&&a("addLoc_BadNumber",c)},validateNewGiftPromotion:function(b,c){u(b)&&a("addGiftCardOrPromo_NoCode",c)},
validatePayment:function(e){if(l.isMobileCX())G(e),p&&c.wrap(function(){p.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(q(),e&&e.length){for(var f=0;f<e.length;f++){var k=b(e[f]);"true"===l.getAttributeData(k,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===l.getAttributeData(k,"isverifiedfail")&&a("continue_VerifiedFail");"true"===l.getAttributeData(k,"iscupcardexpired")&&a("continue_CUPExpired");E(k);A(k);N(k);Q(k);L(k);W(k);Z(k);H(k);U(k);V(k);ca(k);ia(k);
C(k);X(k);T(k)}p&&c.wrap(function(){p.validatePaymentRewardsInRewardsSection(a)},"shopwithpoints");v(e)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(b){if(b.errors&&0<b.errors.length)for(var c=0;c<b.errors.length;c++)a(b.errors[c])},validateEMIMenuForContinueButton:function(b){var c=b.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===c||"SelectOption"===c)a("continue_BlankSlate");else if(c=c.split("."),1<c.length){var e=c[0];if("emiCreditCard"===
e||"netbankingEMI"===e)b=b.find("."+c[1]),b=b.find(".emiMenuTenuresDropDown"),b.length&&!b.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=f.get("payselect");c&&c.validatePayments(this,b,a)},addError:a,errors:aa,validatePCICVVBlock:E}}var b=a.$,e=q.P&&q.P.AUI_BUILD_DATE,p=F;return{create:function(){return new g}}});"use strict";r.when("A","ajax-utility","pay-common-util","pay-validator").register("pay-credit-card",function(a,l,m,c){function f(a,b,c,
f){a&&a.length&&(b=c+"-"+b,(c=m.prop(b))&&(a=a.find(f).val(c))&&a.length&&(m.isMobileCX()?a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),m.prop(b,F)))}var h=a.$,g={cc:!1,vcc:!1,vdc:!1},b=q.P&&q.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,b,c){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var f=a.newExpDate.split("-");a.year=
parseInt(f[0],10);a.month=parseInt(f[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,a.year=a.expyear);(f="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&m.prop("cvv-"+a.paymentmethodid,f);(f="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&m.prop("pincode-"+a.paymentmethodid,f);m.makeAjaxCall(c,a,{successHandler:b,errorHandler:function(b,c){a.handler="confirm-credit-card";m.handleAjaxError(b,
c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,b){var d=a.$target,f=a.data.type,h=c.create();a.$currentTarget.data("issuer","");h.validateCreditCardNumber(d,d);h.hasErrors()||(g[f]=!0,m.makeAjaxCall(a.data.url,{addCreditCardNumber:d.val(),returnjson:1},{completeHandler:function(){g[f]=!1},successHandler:function(c){c=l.jsonify(c);b(c,f);a.$currentTarget.data("issuer",c.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return g[a]},
runConfirmCardValidator:function(a,b){var d=a.find("#existingCvvNum"),d=d.length?d:a.find("#addCreditCardVerificationNumber"),f=a.find("#addCreditCardNumber"),g=a.find("#newMonth"),h=a.find("#newYear"),l=c.create();l.validateCreditCardTail(f,f);g.length&&h.length&&l.validateCreditCardDate(g,g.closest(".card-date").find(".a-button"),h,h.closest(".card-date").find(".a-button"));d.length&&(f=(f=a.find("#issuer"))&&f.val(),l.validateCreditCardCVV2(d,d,f));l.displayErrors(b,a);return l.hasErrors()},setDateSelectorStatus:function(a,
b){var c=b.find(".card-date").find("select");c&&c.length&&r.when("a-dropdown").execute(function(b){c.each(function(){var c=h(this).attr("id");b.updateSelect(c,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},setNewCardCVVInputStatus:function(a){(m.prop("cvv-newcard")||m.prop("pincode-newcard"))&&a.each(function(){var a=h(this);if("1"===(b?a.data("isnewcard")+"":a.attr("isnewcard")))return f(a,"newcard","cvv","#existingCvvNum"),f(a,"newcard","pincode","#existingPincodeNum"),!1})},
setCardPasswordInputStatus:f}});"use strict";r.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller","page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,l,m,c,f,h,g){function b(a,b){var e=c.create(),f=p("#cupMobileNumber-"+a),g=p("#cupSecurityCode-"+a),h=p("#reRegisterCCErrors-"+a);a=p("#reRegisterCCInputs-"+a);e.validateCreditCardCVV2(g,g,b);e.validateCreditCardMobile(f,f);e.displayErrors(h,a);return e.hasErrors()}function e(a,
b,c){h.ajaxUpdatePage(a,b,c)}var p=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();f.show();var c=a.data.type,h=p("#cupMobileNumber-"+a.data.paymentMethodID).val(),t=p("#cupSecurityCode-"+a.data.paymentMethodID).val();b(a.data.paymentMethodID,c)?f.hide():(c={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,month:a.data.expiredMonth,addCreditCardMobileNumber:h,addCreditCardVerificationNumber:t},
h={useSif:m.isMobileCX()?!0:!1,success:function(a,b,c){a=l.jsonify(a);b=p("#reRegisterCCErrors-"+a.paymentInstrumentId);g.waitForCreditCardStatus(a,e,b)}},a.$event.preventDefault(),m.makeAjaxCall(a.data.url,c,null,h))}}});"use strict";r.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card","pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,
l,m,c,f,h,g,b,e,p,d,n,B){function t(a){a.$event.preventDefault();var b=a.data.type;if(p.isWaitingForType(b))e.show(),setTimeout(function(){t(a)},50);else{var d;d="vdc"===b?S.newVDC:"emi"===b?S.newEMI:S.newVCC;if(da(d,b))e.hide();else{e.show();var f=c.getInputValues(d),k="vdc"===b?"_VDC":"_VCC";d=f["addCreditCardVerificationNumber"+k];var g=f["addCreditCardPincode"+k],b={addCreditCardNumber:f["addCreditCardNumber"+k],addCreditCardVerificationNumber:d,addCreditCardPincode:g,handler:f["handler"+k],month:f["month"+
k],name:f["name"+k],newPaymentType:b,year:f["year"+k],cctype:f["cctype"+k],isSBIInternationalMaestroSelected:f["isSBIInternationalMaestroSelected"+k],isCardSavedFromEMIMenu:f["isCardSavedFromEMIMenu"+k]};c.prop("cvv-newcard",d);g&&c.prop("pincode-newcard",g);c.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,c){N(a,b,c);p.setNewCardCVVInputStatus(S.paymentRows)}},{useSif:!0})}}}function w(a){a.$event.preventDefault();var b=a.data.type;if(p.isWaitingForType(b))e.show(),setTimeout(function(){w(a)},
50);else{var d=S.newCCFormContent;if(da(d,b))e.hide();else{e.show();b=c.getInputValues(d);b.handler=b.handler_addCCInBox;var d=a.data.url,f={};O("#cupSecurityCode").is(":visible")&&O("#cupMobileNumber").is(":visible")?(d="/gp/buy/payselect/handlers/add-credit-card.html",f={successHandler:function(a){a=m.jsonify(a);Q(a)}}):f={successHandler:N};c.makeAjaxCall(d,b,f,{useSif:!0})}}}function x(a){a.$event.preventDefault();var b=O("#new-giftcard-promotion"),b=c.getInputValues(b);O("input[name\x3disUnifiedActionsDesignEnabled]").length&&
z(a)||(b.handler=b.handler_addGCInBox,a=a.data.url,e.show(),c.makeAjaxCall(a,b,{successHandler:function(a,b,d){g.ajaxUpdatePage(a,b,d);oa||c.scrollTopTo(O("#existing-balance"))}},{useSif:!0}))}function z(a){a=a.$declarativeParent;var b=O("#gcpromoinput"),c=f.create();c.validateNewGiftPromotion(b,b);c.displayErrors(S.newGCErrors,a);return c.hasErrors()}function k(a){var b=O(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=O(a.currentTarget).val();r.when("a-dropdown").execute(function(a){b.each(function(){var b=
O(this).attr("id");a.updateSelect(b,{status:"G21"===c?"disabled":"enabled"})})})}}function u(a){var b=S.newVDC.find(".vdc-form-fields"),c=S.newVDC.find("#vdc-logo-prompt"),d=S.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();a?d.addClass():d.removeClass()}function q(a){var b=O(a.currentTarget).val(),c=S.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=S.newVDC.find(".vdc-selected-bank-prompt").hide();u(!1);var e="1"===S.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===
b;"OtherBanks"===b||"1"===O("#save_citi_card").val()&&"CIT"===b||e?(u(!0),O.isEmptyObject(n)||n.showExpiryDateAndCvv()):"SMP"!==b||O.isEmptyObject(n)?""!==b&&(b=O(a.currentTarget).find("option:selected").prop("disabled"),a=O(a.currentTarget).find("option:selected").text(),b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(u(!0),n.hideExpiryDateAndCvv())}function v(a,b){if(!O.isEmptyObject(B)&&a)return a(b)}function E(a){v(B.removeEMIMenuSelectionAttributes);
S.newEMI.find(".emi-group").hide();a=O(a.currentTarget).find("option:selected").val();S.newEMI.find("#emiMenuErrors_VCC").length&&S.newEMI.find("#emiMenuErrors_VCC").hide();if(a=v(B.showPaymentOptionBlock,a))v(B.addEMIMenuSelectionAttributes),a.show()}function A(a){p.handleCreditCardType(a,ka)}function N(a,b,d){g.ajaxUpdatePage(a,b,d);oa||c.scrollTopTo(h.getSelectedPayment())}function T(a){a.$event.preventDefault();var b=a.data.type;p.isWaitingForType(b)?(e.show(),setTimeout(function(){T(a)},50)):
da(a.$declarativeParent,b)?e.hide():(P&&P.hide(),qa&&qa.hide(),e.show(),O("#cupSecurityCode").is(":visible")&&O("#cupMobileNumber").is(":visible")?(b=a.$declarativeParent.serializeArray(),b=c.processSubmissionParameters(b),c.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",b,{successHandler:function(a){a=m.jsonify(a);Q(a)}},{useSif:!0})):c.handleForm(a,{successHandler:N},{useSif:!0}))}function Q(a){var b={};b.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(b.checkStatusCount=
a.checkStatusCount);var d={successHandler:function(a){a=m.jsonify(a);var b=f.create();"VERIFIED"===a.cardStatus?c.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},{successHandler:N}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,b.validateRegistrationResult(a),1===a.checkStatusCount?(e.hide(),b.displayErrors(S.newCCErrors)):(--a.checkStatusCount,
Q(a))):(b.validateRegistrationResult(a),e.hide(),b.displayErrors(S.newCCErrors))}};setTimeout(function(){c.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",b,d)},2500)}function G(a){a.$event.preventDefault();var b=a.$declarativeParent,d=b.find("#loc-name"),k=b.find("#loc-number"),g=f.create();g.validateLocName(d,d);g.validateLocNumber(k,k);g.displayErrors(b.find("#error-box-new-loc"),b);g.hasErrors()||(va&&va.hide(),e.show(),c.handleForm(a,{successHandler:N}))}function L(a){a.$event.preventDefault();
var b=a.$declarativeParent,d=b.find("#gcpromoinput");b.find("#gcpromosuccessblock").hide();var k=f.create();k.validateNewGiftPromotion(d,d);k.displayErrors(S.newGCErrors,b);k.hasErrors()||(e.show(),c.handleForm(a,{successHandler:function(a,b,d){g.ajaxUpdatePage(a,b,d);oa?S.newGCErrors.is(":visible")&&O("#gc-link-expander").trigger("click"):c.scrollTopTo(O("#existing-balance"))}}))}function F(a){a.$event.preventDefault();O("#ccAddCard").trigger("submit")}function Z(a){a.$event.preventDefault();O("#bank-address-popover-submit").trigger("submit")}
function H(a){a.$event.preventDefault();O("#direct-debit-popover-submit").trigger("submit")}function U(a){a.$event.preventDefault();O("#new-loc-popover-submit").trigger("submit")}function V(a){a.$event.preventDefault();O("#new-invoice-popover-submit").trigger("submit")}function X(a){a.$event.preventDefault();O("#brdcAddCard").trigger("submit")}function ca(a){a.$event.preventDefault();var b=a.$declarativeParent,d=f.create(),k=b.find("#bank-name"),g=b.find("#bank-routing-number"),h=b.find("#bank-account-number"),
n=b.find("#bank-account-number-confirm"),p=b.find("#bank-dl"),l=b.find("#bank-dl-state");d.validateBankHolderName(k,k);d.validateBankRoutingNum(g,g);d.validateBankAccountNum(h,h);d.validateBankAccountNumConfirm(h,n,n);d.validateBankDriverLicense(p,p);d.validateBankDriverLicenseState(l,l.parents("div.a-button-dropdown"));d.displayErrors(b.find("#new-bank-error-box"),b);d.hasErrors()||(Aa&&Aa.hide(),e.show(),c.handleForm(a,{successHandler:N}))}function ia(a){a.$event.preventDefault();var b=a.$declarativeParent,
d=f.create(),k=b.find("#debit-bank-routing-number"),g=b.find("#debit-account-number"),h=b.find("#debit-account-name");d.validateDirectDebitRoutingNum(k,k);d.validateDirectDebitAccountNum(g,g);d.validateDirectDebitAccountName(h,h);d.displayErrors(b.find("#new-direct-debit-error"),b);d.hasErrors()||(Ba&&Ba.hide(),e.show(),c.handleForm(a,{successHandler:N}))}function C(a){a.$event.preventDefault();var b=a.$declarativeParent,d=f.create(),k=b.find("#invoice-first-name"),g=b.find("#invoice-last-name");
d.validateInvoiceFirstName(k,k);d.validateInvoiceLastName(g,g);d.displayErrors(b.find("#new-invoice-error-box"),b);d.hasErrors()||(K&&K.hide(),e.show(),c.handleForm(a,{successHandler:N}))}function aa(a){a=O("#order-summary-total");var b=O("#order-summary-container");a.prev().addClass("a-first");b.addClass("a-box-group");a.show();c.isTouchCX()&&b.parent().find(".bottom-order-summary").show();S.newCCFormContent.is(":visible")||O("#wrapper-new-cc").find("a.a-link-expander").trigger("click");O("#ecard-help-link").show()}
function ba(a){var b="Unknown";c.isDesktopCX()?b="Desktop":c.isMobileCX()?b="Mobile":c.isTouchCX()&&(b="Tablet");l.increaseCount("PayPage-ClientSide-AddCupClick-"+b,1);b=O("#cupForm");if(0<b.length)b.submit();else{var d=O("\x3cform\x3e\x3c/form\x3e");d.attr({target:"_blank",method:"POST",action:a.data.url});O("#cup-dc").find("input").each(function(){var a=O(this);"hidden"===a.attr("type")&&a.clone().appendTo(d)});O("body").append(d);d.submit();d.remove()}}function y(d){var f=d.$target.closest(".a-popover"),
k=f.data("a-popover-id");b.hideById(k);f.hide();O("#a-popover-modal").hide();e.show();c.makeAjaxCall(d.data.url,void 0,{successHandler:function(b){O("#existing-payment-methods").replaceWith(O(b).find("#existing-payment-methods"));a.trigger("checkout:reload:payselect");e.hide()}})}function ea(a){a.$event.preventDefault();a=a.data;e.show();d.submitNewGilPayment(a.subtype)}function fa(){if(!c.isMobileCX()){0===O("#form-add-credit-card").length&&(O("#ccAddCard").parents("div.cc-submit").hide(),O("#ccAddCardWithButton").parents("div.cc-submit").show());
O("html").hasClass("a-ie6")&&(O("#cup-mbdc").show(),O(".mbdc-link").attr("data-action","redirect-cup"));S=c.getElements(xa);S.bankNumberConfirm.show();S.newVDC.find(".payment-row").data("hasstatus")||S.newVDC.find(".vdc-form-fields").hide();S.newVDC.find("#suppressedVerifiedDebitCard").hide();S.newCCFormContent.find(".cup-card-field").hide();S.newPayments.find("#cupInfoMessage").hide();S.newPayments.find("#use-ecard-link").show();S.newPayments.find(".mbdc-link").show();S.newPayments.find(".mbdc-button").hide();
oa=!1;S.newPayments.each(function(){var a=O(this),b=a.data();b&&0===b.hasstatus?(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):b&&1===b.hasstatus&&!oa&&(c.scrollTopTo(a),oa=!0)});var b=S.newVCC.find("#requireCVVOrPincode");b&&b.length&&b.val("1");sa&&(a.declarative("new-cc",["submit"],T),a.declarative("new-brdc",["submit"],T),a.declarative("new-loc",["submit"],G),a.declarative("show-card-image",["change"],A),a.declarative("new-giftcard-promotion",
["submit"],L),a.declarative("new-verified-card",["click"],t),a.declarative("new-cc-in-dashboard",["click"],w),a.declarative("new-gc-in-dashboard",["click"],x),a.declarative("add-bank-account",["submit"],ca),a.declarative("add-direct-debit",["submit"],ia),a.declarative("add-invoice",["submit"],C),a.declarative("show-order-summary",["click"],aa),a.declarative("redirect-cup",["click"],ba),a.declarative("cup-popover-close",["click"],y),a.declarative("add-new-debit-and-cc-popover-submit",["click"],F),
a.declarative("add-bank-account-popover-submit",["click"],Z),a.declarative("add-loc-account-popover-submit",["click"],U),a.declarative("new-gil-payment",["click"],ea),a.declarative("add-direct-debit-popover-submit",["click"],H),a.declarative("add-invoice-account-popover-submit",["click"],V),a.declarative("add-new-br-debit-card-popover-submit",["click"],X),sa=!1);S.cardTypeDropdown.unbind("change",k).bind("change",k);S.vdcBankDropdown.unbind("change",q).bind("change",q);S.emiCardsDropdown.unbind("change",
E).bind("change",E);O("div.pay-desktop a.a-link-expander").unbind("keypress");O("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");a.on("a:popover:show:add-new-debit-cc-modal",function(a){qa=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){Aa=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){Ba=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){va=a.popover});
a.on("a:popover:show:add-invoice-account-modal",function(a){K=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){P=a.popover})}}function da(a,b){var c,d,e,k,g,h,n,p,l,m,u;"vcc"===b?(c="#vccCVVNum",b="#newVCCErrors",d="#vccMonth",e="#vccName",k="#newVerifiedCreditCardNumber",g="#vccType",h="#vccYear",n="#vccPincode",u=m=l=p=void 0):"vdc"===b?(c="#vdcCVVNum",b="#newVDCErrors",d="#vdcMonth",e="#vdcName",k="#newVerifiedDebitCardNumber",g="#vdcType",h="#vdcYear",p="#isSBIMaestroAsSavedCardEnabled",
l="#isSBIInternationalMaestroSelected",u=m=n=void 0):"emi"===b?(c="#vccCVVNum",b="#newEMIErrors",d="#vccMonth",e="#vccName",k="#newVerifiedCreditCardNumber",g="#vccType",h="#vccYear",n="#vccPincode",u=m=l=p=void 0):"brdc"===b?(b="#newBRDCErrors",d="#brdcMonth",e="#brdcName",k="#addCreditCardNumber_BRDC",h="#brdcYear",u=m=l=p=n=g=c=void 0):(m="#cupSecurityCode",u="#cupMobileNumber",c="#ccCVVNum",b="#newCCErrors",d="#ccMonth",e="#ccName",k="#addCreditCardNumber",g="#ccType",h="#ccYear",l=p=n=void 0);
c=a.find(c);m&&0===c.length&&a.find(m).is(":visible")&&(c=a.find(m));p="1"===a.find(p).val()&&"1"===a.find(l).val();e=a.find(e);k=a.find(k);u=u?a.find(u):null;d=a.find(d);g=a.find(g);h=a.find(h);var t;n&&a.find(n).is(":visible")&&(t=a.find(n));n=g.val();l=f.create();l.validateCreditCardName(e,e);l.validateCreditCardNumber(k,k);p&&l.validateSBIMaestroCardNumberLength(k,k);p=d.parent();p=p.hasClass("a-button")?p:p.find(".a-button");e=h.parent();e=e.hasClass("a-button")?e:e.find(".a-button");"G21"!==
n&&l.validateCreditCardDate(d,p,h,e);l.validateCreditCardType(g,g.closest(".card-type-field").find(".a-button"));h=n?n.substr(0,1):"";c.length&&"R"!==h&&c.is(":visible")&&l.validateCreditCardCVV2(c,c,n);u&&u.length&&u.is(":visible")&&l.validateCreditCardMobile(u,u);t&&t.length&&l.validateCreditCardPincode(t,t);l.displayErrors(O(b),a);return l.hasErrors()}function ka(a,b){if(a){"1"===a.isDebitCard?S.newCCWarnings.show().removeClass("hidden"):S.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var d=
f.create();d.validateGetCreditCardTypeResult(a);if(d.hasErrors()){d.displayErrors(S.newCCErrors);return}}b="vcc"===b?S.newVCC:"vdc"===b?S.newVDC:"emi"===b?S.newEMI:"brdc"===b?S.newBRDCFormContent:S.newCCFormContent;var d=a.specificFields,e=b.find(".cup-card-field");0!==e.length&&(d&&1===d.securityCode&&1===d.mobileNumber?(c.isTouchCX()&&b.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),e.show()):e.hide());d=a.specificFields;e=b.find(".amex-field");if(0!==e.length){var k=
b.find(".cvv-field");0!==k.length&&(d&&1===d.pincode?(k.hide(),e.show()):d&&0===d.pincode&&0===d.securityCode?(e.hide(),k.hide()):(e.hide(),k.show()))}d=b.find(".card-images");d.find("img").hide();k=a.installmentProgram;e=!1;k&&(k=d.find('img[data-installmentprogram\x3d"'+k+'"]'),0!==k.length&&(k.show(),e=!0));e||(a.issuerdisplayimage?d.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(e=a.issuer+a.brand,d.find("img[data-issuer\x3d"+e+"]").show(),b.find(xa.cardTypeDropdown).val(e).trigger("change")));
p.setDateSelectorStatus(a,b)}}var O=a.$,sa=!0,oa=!1,S={},xa={bankNumberConfirm:"#wrapper-bank-account-number-confirm",btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",
newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},qa,Aa,va,Ba,K,P;a.on("checkout:reload:payselect",fa);a.on("checkout:reload:spp-payment",fa);return{actionShowOrderSummary:aa,handleFormHandlerScrollToSelected:N}});
r.when("A","page-detector","client-side-metrics","ready").execute(function(a,l,m){function c(a,c,b,e){a=f(c).is(":checked");q.P&&q.P.AUI_BUILD_DATE?a?f(b).val(f(b).parent().data("account-name")):f(b).val(""):(m.increaseCount("removeauijs8"),a?(f(e).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),f(b).val(f(b).data("account-name"))):(f(e).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),f(b).val("")));b="undefined"!==typeof q.ue&&
"undefined"!==typeof q.ue.count;e=l.isMobilePayment()?"mobile":"tablet";a=f("#showNameOnCardCheckbox").is(":checked");b&&q.ue.count(e+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var f=a.$;a.declarative("show-card-name",["click"],function(a){c(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){c(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";r.when("A").register("pay-rewards-currency",
function(a){var l=function(a,c){c=Math.pow(10,c);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/c},m={CA:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},c=function(a,c,b,e,f){this.groupingSeparator=a;this.decimalSeparator=c;this.currencyDecimalPlace=
b;this.pointsDecimalPlace=e;this.ratio=f;this.getCurrencyAmount=function(a){return l(a,this.currencyDecimalPlace)};this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/this.ratio};this.format=function(a,b){var c=parseInt(a,10);a=parseFloat(a-c).toFixed(b);a=this.decimalSeparator+a.slice(2);c=c.toString();b=3<c.length?c.length%3:0;c=(0<b?c.substr(0,b)+this.groupingSeparator:"")+c.substr(b).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return a===F||a===this.decimalSeparator?c:
c+a};this.formatCurrency=function(a){return this.format(a,b)};this.formatPoints=function(a){return this.format(a,e)}},f=function(c,f,b,e){this.maxAmount=e;this.rewardsFormatter=b;this.currencyElement=c;this.pointElement=f;var p=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;
default:return!1}};this.isValidKey=function(a){var b=a.which;return 48<=b&&57>=b||96<=b&&105>=b||8===a.which||46===a.which};this.getCaret=function(){var a=p.currencyElement,b=a.get(0),c=0,e=0;if("number"===typeof b.selectionStart&&"number"===typeof b.selectionEnd)c=b.selectionStart,e=b.selectionEnd;else{var f=document.selection.createRange();if(f!==F&&f.parentElement()===b){var a=a.val(),e=a.length,g=b.createTextRange();g.moveToBookmark(f.getBookmark());b=b.createTextRange();b.collapse(!1);-1<g.compareEndPoints("StartToEnd",
b)?c=e:(c=-g.moveStart("character",-e),c+=a.slice(0,c).length-1,-1<g.compareEndPoints("EndToEnd",b)||(e=-g.moveEnd("character",-e),e+=a.slice(0,e).length-1))}}return{start:c,end:e}};this.setCaret=function(a){var b=p.currencyElement.get(0);b.setSelectionRange?b.setSelectionRange(a,a):b.createTextRange&&(b=b.createTextRange(),b.collapse(!0),b.moveStart("character",a),b.moveEnd("character",a),b.select())};this.bind=function(){p.currencyElement.unbind();p.currencyElement.bind("keydown",function(a){p.isNavigationKey(a)||
p.isControlKey(a)||p.isValidKey(a)||a.preventDefault()});p.currencyElement.bind("keyup",function(b){if(!p.isNavigationKey(b)){b=p.getCaret();var c=p.currencyElement.val().length;p.format();var e=p.currencyElement.val().length;b.start===b.end&&p.setCaret(Math.min(b.start+(e-c),e));a.trigger("inlineFormatter:formattingCompleted",p)}})};this.unbind=function(){p.currencyElement.unbind("keydown keyup")};this.format=function(a){a=p.currencyElement.val();a=p.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&
(a=0);a>p.maxAmount&&(a=p.maxAmount);a=p.rewardsFormatter.formatCurrency(a);p.currencyElement.val(a)}};a.on("inlineFormatter:formattingCompleted",function(a){var c=a.pointElement,b=a.currencyElement.val(),b=a.rewardsFormatter.getPointsAmount(b);a=a.rewardsFormatter.formatPoints(Math.round(b));c.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=m[a])||(a=m["default"]);return a},getAmount:l,initializeInlineFormatting:function(h,g,b){var e=h.maxAmount;b=new c(b.groupingSeparator,b.decimalSeparator,
b.decimalPlace,g.decimalPlace,g.ratio);h=new f(h.$element,g.$element,b,e);h.bind();h.format(0);a.trigger("inlineFormatter:formattingCompleted",h)}}});"use strict";r.when("A","pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,l,m,c,f,h){function g(){!l.isMobileCX()&&I("#jppoints").length&&(v=l.getElements(E),n())}function b(){var a=v.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");
a.attr("checked",!1);l.isTouchCX()&&e(a,"radio")}function e(a,b){a.siblings("i").removeClass("a-icon-touch-"+b+"-active").addClass("a-icon-touch-"+b+"-inactive")}function p(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function d(){return I('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function n(){if(v.jppoints&&v.jppoints.length){d()&&q();v.jppoints.show();var a=v.jppoints.find("#redeemPoints");
l.isTouchCX()?a.parents("label").bind("click",x):a.bind("click",x);v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",function(){var a=v.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=v.jppoints.find("#redeemPoints");b.attr("checked",!0);l.isTouchCX()&&(p(a,"radio"),e(v.jppoints.find("#jpPointsMax"),"radio"),p(b,"checkbox"))});v.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",t);v.jppoints.find("#jpPointsCustom").bind("click",function(){v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});
v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",u)}}function q(){var a=v.jppoints.find("#redeemPoints"),b=v.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f=v.jppoints.find("#redeemableAmount"),k=v.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);b.attr("checked",!1);b.attr("disabled",!0);v.jppoints.find("#jpPointsError").hide();d.val("");
d.removeClass("a-form-error");d.attr("disabled",!0);k.text(v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());f.text(v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());c.isSPP()&&(v.jppoints.find("label").addClass("disabled-color"),v.jppoints.removeClass("payment-selected"));l.isTouchCX()&&(e(a,"checkbox"),e(b,"radio"),a.siblings("i").addClass("a-button-disabled"),b.siblings("i").addClass("a-button-disabled"))}function t(c){var d=c.currentTarget,
f=v.jppoints.find("#redeemPoints");f.attr("checked",!0);if(l.isTouchCX()){p(I("#"+d.id),"radio");var k;k="jpPointsMax"===d.id?v.jppoints.find("#jpPointsCustom"):v.jppoints.find("#jpPointsMax");e(k,"radio");p(f,"checkbox")}"true"===d.value&&(v.jppoints.find("#jpPointsError").hide(),d=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),d.removeClass("a-form-error"),d.val(""),f=v.jppoints.find("#redeemableAmount"),k=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),d=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),f=parseInt(f.text(),10)*k,I('input[name\x3d"useAvailableBalance"]').is(":checked")&&(k=v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),d-=parseInt(k.val(),10)),f>=d&&b());r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",I(c.currentTarget))})}function w(a){var c=v.jppoints.find("#redeemableAmount"),
d=v.jppoints.find("#redeemableValue"),f=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),k;a.is(":checked")?(a=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val(),k=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val(),f-=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)):(a=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),
k=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val());var g=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;c.text(a);d.text(k);0>=parseInt(a,10)?(c=v.jppoints.find("#redeemPoints"),c.attr("checked",!1),d=v.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d.attr("checked",!1),l.isTouchCX()&&(e(c,"checkbox"),e(d,"radio"))):v.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?
g>=f&&b():u()}function x(){var b=v.jppoints.find("#redeemPoints");if(!b.is(":disabled")){b=b.is(":checked");if(l.isTouchCX())b?(e(v.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),k()):(p(v.jppoints.find("#jpPointsMax"),"radio"),e(v.jppoints.find("#jpPointsCustom"),"radio"),z());else if(b)z(),c.isSPP()&&v.jppoints.addClass("payment-selected");else if(k(),c.isSPP()){v.jppoints.removeClass("payment-selected");if(d())return;l.selectDefaultPaymentMethodIfNotSelected()}r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",
v.jppoints)})}}function z(){var a=v.jppoints.find("#jpPointsMax");a.attr("checked",!0);var d=parseInt(v.jppoints.find("#redeemableAmount").text(),10),f=v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),k=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);l.isTouchCX()&&(e(v.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),p(a,"radio"));v.jppoints.find("#jpPointsMax").is(":checked")&&(d>=k?b():c.isSPP()&&v.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&
(a=v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),k-=parseInt(a.val(),10),f>=k&&b()))}function k(){var a=v.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");v.jppoints.find("#jpPointsError").hide();l.isTouchCX()&&e(a,"radio")}function u(){var c=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),d=parseInt(c.val(),
10);!d||0>d?(c.val(""),v.jppoints.find("#jpPointsError").hide(),v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):(c.val(d),parseInt(v.jppoints.find("#redeemableAmount").text(),10)<d?(v.jppoints.find("#jpPointsError").show(),v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(v.jppoints.find("#jpPointsError").hide(),v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),
c=parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(v.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),d>=c&&b(),r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",d)})))}var I=a.$,v={},E={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",g);a.on("checkout:reload:spp-payment",
g);return{handleJPPointsOnPaymentRows:function(a){a=I(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))w(a);else{h.isMCBMultiTenderWeblabEnabled()||f.hideMCBWarningMessageForPoints(v);var b=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!h.isMCBMultiTenderWeblabEnabled()&&b.length&&0<b.filter("[value^\x3dMCB]").size())f.showMCBWarningMessageForPoints(v),q();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))q();
else{a=v.jppoints.find("#redeemPoints");var b=v.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=v.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),e=v.jppoints.find("#redeemableAmount"),k=v.jppoints.find("#redeemableValue");c.isSPP()&&v.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);b.attr("disabled",!1);d.attr("disabled",!1);I('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(e.text(v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),
k.text(v.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));l.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),b.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:w}});"use strict";r.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base",
"a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper","safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,l,m,c,f,h,g,b,e,p,d,n,B,t,w,x,z,k,u,I,v,E){function A(){return D.paymentRows.filter(function(){return J(this).hasClass("payment-selected")||J(this).find("#redeemPoints").is(":checked")})}function N(a){h.show();a.$event.preventDefault();var b=
A().find(".card-unreg-rewards").data();b.recommendedPaymentMethodId=b.paymentinstrumentid;c.makeAjaxCall(a.$target.attr("href"),b)}function T(b){b=J(b.currentTarget);var d=b.data();if(!(0>=d.ratio)){var e=b.val()/d.ratio;if(!isNaN(e)){var f=b.val();f<d.min&&(e=0);b=c.getNumberWithSeparators(e,d.decimalplaces);A().find(".custom-reward-points").html(b);r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function Q(a){1===a.data.refresh&&
(h.show(),c.makeAjaxCall(a.data.url))}function G(a){Ea(a)?(a=D.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden")):J("#payPageContinueBtnStateFixEnabled").length&&V(a)}function L(a){c.isTouchCX()&&(Ea()?a.$event.preventDefault():(D.continueErrPopover.hide().find(".error-message").hide(),h.show()))}function F(a){c.isTouchCX()&&(Ea()||D.continueErrPopover.hide().find(".error-message").hide())}function Z(a){a=
J(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}function H(a){a.$event.preventDefault();var b=A();if(!d.runConfirmCardValidator(b,b.find("#cc-errors"))){h.show();var e=(b=c.getInputValues(b))||{},f=c.getInputValues(D.hiddenFormFields),k;for(k in f)f.hasOwnProperty(k)&&(e[k]=f[k]);d.confirmCreditCard(b,Ba,a.data.url)}}function U(){D.continueErrPopover.filter(":visible").length&&D.continueErrPopover.hide()}
function V(){D.continueErrPopover.filter(":visible").length&&D.continueErrPopover.hide().find(".error-message").hide();var a=A();D.disableSubmitButtons.length?a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),a.find(".a-button-disabled").addClass("aok-hidden")):(D.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),D.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&
(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(D.continueErrPopover.hide().find(".error-message").hide(),D.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),D.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),a.hide()))}}function X(){D.continueErrPopover.filter(":visible").length||D.continueBtnTop.trigger("click")}function ca(a){if(13===a.which){var b=J(document.activeElement),d=b.closest("div.payment-row"),e=b.closest(".a-button"),
b=b.get(0).tagName;if(d.length&&!e.length&&"A"!==b&&"a"!==b)return d=d.find('input[type\x3d"submit"]'),d.length?d.trigger("click"):(D.continueErrPopover.filter(":visible").length&&D.continueErrPopover.hide(),Ea(a)?(c.isTouchCX()||(D.continueBtns.find(".a-button-primary").addClass("aok-hidden"),D.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):D.continueBtnTop.trigger("click")),!1}}function ia(a){h.show();var b=A(),d=b.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),
e=b.find(".card-unreg-rewards").data(),b=c.isTouchCX()?b.find(".flag-register-rewards"):D.rewardsRegister,b=c.getInputValues(b);b.programid=e.programid;b.paymentinstrumentid=e.paymentinstrumentid;b.CARD_EXPIRATION_DATE=e.expiredate;b.CARD_HOLDER_NAME=e.holdername;b.returnRefreshedPage=a.data.returnRefreshedPage;b.rewardsdateofbirthmonth&&b.rewardsdateofbirthday&&(b.DATE_OF_BIRTH=b.rewardsdateofbirthmonth+b.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=n.addQueryStringParameter(a.data.url,
"cacheBuster",(new Date).getTime()));c.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,e){h.hide();if(a){a=l.jsonify(a);D.rewardsRegister.find(".register-content").hide();var f=c.isTouchCX()?A().find(".register-error"):D.rewardsRegister.find(".register-error");f.hide();a.error?f.show().find(".error-message").hide().filter("#"+a.error).show():(g.ajaxUpdatePage(a.refreshedPage,b,e),b=D.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+d+'"]').closest(".payment-row"),b.trigger("click"),
c.scrollTopTo(b))}}})}function C(a){a=J(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}function aa(a){a=a.$target.closest("div.payment-row");var b=a.find(".currency-list");if(g.isSPP()){var d=t.getSelect(b.find("select"));null!==d&&d.setValue("")}a.find(".change-currency").hide();b.show();c.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),
a.find(".bottom-cell").show());K();za()}function ba(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();K();P()}function y(a){var b=a.$target.closest("div.payment-row"),d="true"===c.getAttributeData(b,"isaddresschallenge")?1:0;b.find(".expire-date-fields").length?(ba(a),b.find("#newExpDate").focus()):d&&b.find("#addCreditCardNumber").focus()}function ea(a){setTimeout(function(a){var b=J(a.target);a=document.createEvent("UIEvents");
a.initUIEvent("DOMActivate",!0,!0,q,1);b.get(0).dispatchEvent(a)},0,a)}function fa(a){var b=J(a.target).closest("div.payment-row");""!==J(a.target).val()&&("true"===c.getAttributeData(b,"isaddresschallenge")?b.find("#addCreditCardNumber").focus():X())}function da(){var a=A();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),
a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function ka(){da()}function O(a){a.$event.preventDefault();if("1"===A().find("div.flag-register-rewards").attr("cached"))da();else{var b=a.$target.attr("href");-1===b.toLowerCase().indexOf("cachebuster")&&(b=n.addQueryStringParameter(b,"cacheBuster",(new Date).getTime()));h.show();c.makeAjaxCall(b,a.data,{successHandler:function(a){h.hide();var b=l.jsonify(a);a=c.decodeJSONResponse(b.widgetHTML);var d=A();d.find("div.flag-register-rewards").html(a);
d.find("div.flag-register-rewards").attr("cached",1);d.find("div.flag-register-rewards .error-message").each(function(){var a=J(this),c=a.data("errorid");a.html(b.displaydata[c])});da()}})}}function sa(b){var d=J(b.target);if(!d.is(":visible"))return b.preventDefault(),b.stopPropagation(),!1;g.isSPP()&&(g.isPrefetchFromAddressEnabled()?g.disablePageNoUpdateTransition():J("#payment").find(".panel-cancel-row").hide(),x.clearCache());var e=J(b.currentTarget);D.jppoints.length&&p.handleJPPointsOnPaymentRows(b);
var f=e.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==b.target.name&&!f.length)if(S(e),k.toggleGCForMCB(e,D),oa(e),e.hasClass("payment-selected")||e.hasClass("payment-label"))D.disableSubmitButtons.length&&(qa(e,e,!1),!d.hasClass("continue-center")&&e.find(".continue-center").length||X());else if(b=e.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b.length&&"disabled"!==b.attr("disabled")){$a();b=A();g.isSPP()?b.filter(function(){var a=J(this).attr("id");return"gcPromo"===
a?(a=J(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):b.removeClass("payment-selected");b.find("[name\x3dpaymentMethod]").attr("checked",!1);b.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");b.find(".top-cell").removeClass("bottom-line");ta(b);c.isTouchCX()&&(b.find(".bottom-cell").hide(),b.find(".card-unreg-rewards").show());
e.addClass("payment-selected");e.find("[name\x3dpaymentMethod]").attr("checked",!0);e.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");var d="true"===c.getAttributeData(e,"isaddresschallenge")?1:0,f=e.find('.rewards-list input[type\x3d"radio"]').length,h="1"===c.getAttributeData(e,"hasDerivedCurrency")?1:0,l=e.find(".vcc-form-fields").length,n=e.find(".card-ref-num").length;c.isTouchCX()&&(d||f||l||n||h)&&(e.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),
e.find(".bottom-cell").show());r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",e,za)});Pa(e);Ta(e);Ua(e);la(e);ab(e);"1"===J("#suppressionMessageFixEnabledStatus").val()&&cb(e);bb(e);Va(e);Oa(e);Wa(e);db(e);eb(e);Xa(e);Ia(u,u.toggleEMIMenu,e);Ya(e);fb();Aa(e);Fa();K();P();F();ha();va(e,b);Ra();D.hideInputBoxes.length&&(Sa(e,b),Qa(e));D.disableSubmitButtons.length&&qa(e,b,!0);Ka();za();D.disableSubmitButtons.length&&!e.find(".continue-center").length&&
X()}}function oa(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=J("input[type\x3d'hidden'][name\x3d'paySelectLocale']");b.length&&"IN"===b.val()&&a.length&&r.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function S(a){var b=J("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=J("#button-add-gcpromo"),c=J("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),
b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function xa(a){r.when("A","a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}function qa(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)Sa(a,b),Qa(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&
(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));r.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));f=e?a.find(".billing-address-link"):d.find(".continue-center");xa(f)});d.show()}}}function Aa(a){var b=J("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}
function va(a,b){if(c.isTouchCX()&&(b&&b.find(".top-cell .data-row").children(".a-column").height("auto"),a)){a=a.find(".top-cell .data-row");var d=a.find(".addr-challenge-card-scan .a-box");if(d.length){b=a.height();var d=d.height(),e=a.children(".a-column:first");a.children(".a-column").height(d);e.height(b);e.children(".vertical-center-grid:first").height(d)}else a.children(".a-column").height(a.height())}}function Ba(b){h.hide();var e=l.jsonify(b);e.imbWidgetHTML&&J("#imb-wrapper").html(c.decodeJSONResponse(e.imbWidgetHTML));
if(e.cardWidgetHTML&&(b=A(),b.replaceWith(c.decodeJSONResponse(e.cardWidgetHTML)),null!=e.rewardsAccountsWidgetHTML&&r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:refresh-rewards-section",c.decodeJSONResponse(e.rewardsAccountsWidgetHTML))}),a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),b=A(),"true"!==c.getAttributeData(b,"isaddresschallenge"))){d.setCardPasswordInputStatus(b,e.newpaymentmethodid,"cvv","#existingCvvNum");d.setCardPasswordInputStatus(b,
e.newpaymentmethodid,"pincode","#existingPincodeNum");if(D.cvvColumnLabel.length){var f=!1;D.paymentRows.each(function(){if("true"===c.getAttributeData(J(this),"isaddresschallenge"))return f=!0,!1});f||D.cvvColumnLabel.hide()}D.disableSubmitButtons.length&&X()}}function K(){D.paymentRows.each(function(){var a=J(this),b=a.find('.currency-list input[type\x3d"radio"]').length,d=a.find('.rewards-list input[type\x3d"radio"]').length,e=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),
k=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),g=a.find(".bottom-cell .inner-grid-left"),h=a.find(".bottom-cell .inner-grid-right");f?b||d||e?(g.removeClass("hidden a-span10 a-span12").addClass("a-span8"),h.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(g.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),h.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):k?(g.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),h.removeClass("hidden a-span4 a-span12").addClass("a-span2")):
(g.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),h.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!c.isTouchCX()&&k&&(b||d||e)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=A(),b=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,d=a.find(".top-cell.bottom-line").length;b&&!d||a.find(".bottom-cell").removeClass("align-top")}function P(){c.isTouchCX()&&D.paymentRows.each(function(){var a=J(this),b="true"===c.getAttributeData(a,
"isaddresschallenge")?1:0,d=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),e=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),k=a.find(".rewards-info").is(":visible"),g=a.find(".change-currency").is(":visible");d?a.find(".top-cell .second-row").addClass("align-top"):a.find(".top-cell .second-row").removeClass("align-top");b=b||g||f||k;f=e||d;k=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");b||(k.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),
a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));f||(k.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));b&&d&&(k.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));b&&e&&(k.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function ta(a){var b=a.find(".currency-list");if(b.length){var c=
b.find("[type\x3dradio]:checked").val(),b=b.find("#cardCurrencyDropDown option:selected").val();"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function R(a){var b=J(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();else{var c=a.prop("disabled"),b=b.parents("div.selected-section"),d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");c?
(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}function ma(a){var b=J(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),b.find("span.selected-more-payment-content").show())}function wa(a){(D.continueErrPopover.filter(":visible").length||
Ea())&&a.$event.preventDefault()}function Y(b){b=J(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));
r.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}function ra(a){a=J(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);ha()}function ha(a){var b=J("#pm_promo");a=J("#pm_gc_radio");var d=J("#pm_gc_checkbox"),e;J("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&(e=J("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||d&&d.length){var f=
J("input[name\x3dgcBalanceRaw]").val();J("input[name\x3damBalanceRaw]").length&&(f=J("input[name\x3damBalanceRaw]").val());var k=J("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),g=J("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),h=J("input[name\x3damAvailableBalanceRaw]").val(),p=J("input[name\x3dremainingBalanceRaw]").val(),l=J("input[name\x3dpurchaseTotalRaw]").val(),n,m,ga=J(".purchase-total").length;ga?(m=J(".purchase-total").html(),n=J(".remaining-balance").html()):(m=
J("input[name\x3dpurchaseTotal]").val(),n=J("input[name\x3dremainingBalance]").val());var u=J(".balance-applied");ga?u.html(m):u.text(m);(c.isTouchCX()&&"checkbox"===b.attr("type")?"1"===b.closest(".a-control-row").attr("isclicked"):b.is(":checked"))?(b=p,0<b&&(ga?u.html(n):u.text(n))):b=l;k&&E.renderAPBMessagingRemainingBalance({purchaseTotal:m,remainingBalance:n,balanceApplied:u,isPurchaseTotalInSpan:ga},f,l,h);n=a.closest(".radio-col");m=d.closest(".radio-col");p=J(".amazon-money-limit-breached");
ga=J(".long");u=J(".short");"1"===k&&"1"===g?E.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:n,gcCheckboxContainer:m,gcCheckbox:d,gcRadio:a,shortMsg:u,longMsg:ga,amazonMoneyLimitBreachedMsg:p}):0<=f-l?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),n.removeClass("hidden"),a.is(":checked")&&n.trigger("click"),m.addClass("hidden"),d.attr("disabled","disabled"),0==f-l?(ga.hide(),u.show()):(ga.show(),u.hide())):0<f-b?0>=b?(m.removeClass("hidden"),d.attr("disabled","disabled"),
c.isTouchCX()&&m.find("i").addClass("a-button-disabled checkbox-disabled"),n.addClass("hidden"),a.attr("disabled","disabled"),u.show(),ga.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),n.removeClass("hidden"),a.is(":checked")?n.trigger("click"):c.isTouchCX()&&n.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),m.addClass("hidden"),d.attr("disabled","disabled"),ga.show(),u.hide()):("disabled"===d.attr("disabled")&&(d.removeAttr("disabled"),
c.isTouchCX()&&m.find("i").removeClass("a-button-disabled checkbox-disabled")),m.removeClass("hidden"),(g=m.closest(".payment-row"))&&g.hasClass("payment-selected")&&g.removeClass("payment-selected"),n.addClass("hidden"),a.attr("disabled","disabled"),"1"===k?E.renderAPBInsufficientMessaging({shortMsg:u,longMsg:ga},f,h):(u.show(),ga.hide()));"1"===e&&(a.attr("disabled","disabled"),d.attr("disabled","disabled"),(g=m.closest(".payment-row"))&&g.hasClass("payment-selected")&&g.removeClass("payment-selected"))}}
function ja(b){var c=A().find(".enter-custom-rewards");if("rewardscustom"===J(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();var d=c.find("input.custom-rewards-input");d.focus();D.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();r.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",
J(b.currentTarget))});za()}function pa(a){a=a.$target||J(a.currentTarget);ya(a)}function ya(b){if(b.length){var c=D.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=D.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),k=D.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),g=D.installmentsOnlyCards,h=D.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),p=D.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');
if(c.length){var n=c.closest(".payment-row"),l=k.closest(".payment-row"),m=h.closest(".payment-row"),ga=p.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),n.removeClass("payment-selected")),c.parent().siblings().addClass("a-color-secondary"),Ia(u,u.disableEMIPaymentMethods,h),r.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",p)}),I.showInstantBankDiscountAmazonPaySelected(),ua(k,l),(b=d.find("select"))&&b.each(function(){var a=
this.id.replace(/\./g,"\\.");t.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),f.find(".installments-disabled-text").show(),J("#isGurupaPspToggleGcBugfixEnabled").length&&"1"===J("#isGurupaPspToggleGcBugfixEnabled").val()?g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").filter(":checked").removeAttr("checked"):
g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),g.removeClass("payment-selected")):(n.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),l.find(".payment-invalid").length||na(k,l),m.find(".payment-invalid").length||Ia(u,u.enableEMIPaymentMethods,h),ga.find(".payment-invalid").length||r.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",p)}),I.showInstantBankDiscountAmazonPayDeselected(),
d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),f.find(".installments-enabled-text").show(),g.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function na(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}
function ua(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();b.find(".more-payment-gc-disabled-text").show()}function Da(a){var b=a.$target||J(a.currentTarget);a=b.closest(".currency-list");b=b.val();!0===(c.isTouchCX()?"Other"===b:"Other"!==b)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),
a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));za()}function M(a){z.actionReregisterCardInBox(a);c.scrollTopTo(A())}function ga(a){za()}function Ha(){D.paymentRows.each(function(){var a=J(this),b=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",
d=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";a.hasClass("payment-selected")&&("1"===c.getAttributeData(a,"hasDerivedCurrency")||"1"===c.getAttributeData(a,"hasPreferredCurrency")&&"1"===c.getAttributeData(a,"isNewCard"))||(b+=", .currency-list");"1"===c.getAttributeData(a,"hasPreferredCurrency")&&"1"!==c.getAttributeData(a,"isNewCard")&&(d+=", .change-currency");a.find(b).hide();
a.find(d).show()})}function Fa(){D.paymentRows.each(function(){var a=J(this),b="#cc-errors, .enter-date, .expire-date-fields",d=".expire-info";if(a.hasClass("payment-selected")&&"1"===c.getAttributeData(a,"hasDerivedCurrency"))b+=", .change-currency",d+=", .currency-list";else{var e=a.find(".currency-list"),f=e.find("[type\x3dradio]:checked").val();if(f){var k;if("Other"!==f)k=e.find(".currencyNameLabel").html();else{var f=e.find("#cardCurrencyDropDown option:selected"),g=f.val();"-1"!==g&&"-2"!==
g&&(k=f.text())}k&&(d+=", .change-currency",e.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(k))}b+=", .currency-list"}a.find(b).hide();a.find(d).show()})}function Ga(){var a=J("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/",b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");J.getScript(d+c+b,function(){q.d16g&&q.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,
client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function Ca(){Za&&(a.declarative("auto-rewards-reg",["click"],N),a.declarative("complete-rewards-register",["click"],Q),a.declarative("confirm-card",["click"],H),a.declarative("register-card-rewards",["click"],ia),a.declarative("cancel-register-card-rewards",["click"],ka),a.declarative("show-currencies",["click"],aa),a.declarative("show-expire-date-fields",["click"],ba),a.declarative("focus-cc-update-fields",["click"],y),a.declarative("show-rewards-reg",
["click"],O),a.declarative("submit-payment-form",["submit"],wa),a.declarative("toggle-tfx-option",["click"],Da),a.declarative("reregister-cc-in-dashboard",["click"],M),a.declarative("modify-expire-date-fields",["change"],ga),c.isTouchCX()&&a.declarative("continue-button",["click"],L),Za=!1);D.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",sa);r.when("apx-payselect-helper").execute(function(){var a=v.get("payselect");a&&a.initEvents(D.paymentRows,za)});D.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",
ha).bind("change",ha);D.disableSubmitButtons.length&&D.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",Y).bind("click",Y);D.existingPincodeNum.unbind("click",La).bind("click",La);D.paymentRows.find("select#cardCurrencyDropDown").unbind("change",C).bind("change",C);D.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?D.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ja).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");
c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};d=d.data("country-code");d=w.getCurrencyFormatByCountryCode(d);w.initializeInlineFormatting(b,c,d)}):D.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ja).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",T);if(c.isTouchCX())D.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",
F).bind("change",F),D.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",Da),D.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",ra);else if(!g.isSPP()){var b=D.continueBtns.find(".a-button-text");J("#payPageContinueBtnStateFixEnabled").length?b.filter('input[type\x3d"button"]').unbind("mouseenter",Ja).bind("mouseenter",Ja).unbind("focus",Ja).bind("focus",Ja).unbind("mouseleave",
U).bind("mouseleave",U).unbind("blur",U).bind("blur",U):(b.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",G).unbind("focus").bind("focus",G),b.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",V).unbind("blur").bind("blur",V))}D.netBankingSelect.unbind("change",R).bind("change",R);D.morePaymentMethodsSelect.unbind("change",ma).bind("change",ma);D.continueBtnBottom.unbind("click").bind("click",X);0<J("input[name\x3d'needDisableCODandEMIforGC']").length&&
(b=J("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),b.length&&(b.bind("change",pa),b.is(":checked")&&ya(b)));D.jppoints.length&&D.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",p.handleJPPointsOnPaymentRows);r.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});D.hideInputBoxes.length&&(D.paymentRows.find("#confirm-card").unbind("focus").bind("focus",Z),D.paymentRows.find("#newExpDate").unbind("focus").bind("focus",ea),D.paymentRows.find("#newExpDate").unbind("change").bind("change",
fa))}function Ka(){var a=f.create();a.validatePayment(A());a.hasErrors()||g.makePrefetch(D.existingPaymentForm)}function La(a){a=D.showAmexWarning;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function Ma(){if(!c.isMobileCX()){D=c.getElements(gb);D.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var b=A();r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",za)});r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});
la(b);Oa(b);Aa(b);Ha();Pa(b);Ta(b);Ua(b);Wa(b);Xa(b);Ya(b);Va(b);ha();Ra();J(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",ca);J(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",za);D.addressChallengeCardList.length&&D.addressChallengeCardList.show();D.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){J(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");
P();K();Ca();D.existingPaymentForm.data("checkoutFormReady",!0);Ka();Ga();D.orderSummaryBottom.show();va(b);F();za();S(b);k.determineIsMCBEnabled(D);k.toggleGCForMCB(b,D);J(".a-popover-preload").each(function(){var b=J(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,e.displayRewardsRegister),a.off("a:popover:hide:rewards-registration-"+b,e.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,e.displayRewardsRegister),
a.on("a:popover:hide:rewards-registration-"+b,e.hideRewardsRegister))});r.when("a-tv").execute(function(c){a.trigger("a:tv:resize");b.find(".a-tv-navigate").length&&qa(b,b,!1)})}}function za(b){g.isSPP()?(Ea()?D.disableSubmitButtons.length?(b=A(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(D.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),D.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):
V(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):J("#payPageContinueBtnStateFixEnabled").length&&G(b)}function Na(a,c){a=J(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&c.length&&(c=b.triggerLeft(a,c),a.show(),a.offset(c))}function Ja(a){if((!D.continueErrPopover.filter(":visible").length||c.isTouchCX())&&D.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&("mouseenter"===a.type||"focus"===a.type)){var b=J(a.target).closest(".continue-buttons").find(".a-button-disabled");
Na(a,b)}}function Ea(a){if(D.continueErrPopover.filter(":visible").length&&!c.isTouchCX())return!0;var d=A(),e=f.create();Ia(u,u.isEMIPaymentInstrument,d)&&(e.validateEMIMenuForContinueButton(d),d=Ia(u,u.getEMIMenuSelectedCardSection));e.validatePayment(d);e.apxValidatePayment(d,D.paymentRows);e=e.getHighestErrorId();if(!e||!e.identifier)return!1;D.continueErrPopover.find(".error-message").hide();d=d.find(".pincode-err-block");d.hide();d&&d.length&&e.target&&e.target.length&&e.target.addClass("a-form-error");
e.isPincodeError?(d.show(),d.addClass("a-form-error")):(D.continueErrPopover.find("#"+e.identifier).show(),D.continueErrPopover.find("#"+e.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?g.isSPP||D.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=J(this).closest(".order-summary-box").find(".continue-button-errors"),c=b.triggerLeft(a,J(this));a.show();a.offset(c)}):(d=J(a.target).closest(".continue-buttons").find(".a-button-primary"),Na(a,
d)));return!0}function Pa(b){D.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();D.hideInputBoxes.length?D.paymentRows.find(".card-name").show():D.paymentRows.find(".card-info").show();if("true"===c.getAttributeData(b,"isaddresschallenge")){var d=b.find(".addr-challenge, .addr-challenge-msg");0===d.length&&m.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");d.show();D.hideInputBoxes.length?b.find(".card-name").hide():b.find(".card-info").hide();b=b.attr("paymentmethodid")?
b.attr("paymentmethodid"):b.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",b)}}function Qa(a){D.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function Ra(){D.paymentRows.find(".pci-blocking-cvv").length&&D.paymentRows.each(function(){var a=J(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&b.length?b.show():b.length&&b.hide()})}function Sa(a,b){r.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));
b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),xa(d.find(".a-button-primary")))})}function Ta(a){D.paymentRows.find(".verified-fail-msg").hide();"true"===c.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function Ua(a){D.paymentRows.find(".cup-expired-msg").hide();"true"!==c.getAttributeData(a,"iscupcardexpired")&&"true"!==c.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function la(b){D.paymentRows.find(".rewards-list").hide();
D.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var d=b.find('.rewards-list input[type\x3d"radio"]'),e=d.filter(":checked");D.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<e.length?e.prop("checked",!0):b.find(".rewards-list").hasClass("apply-by-default")?d.filter('[value\x3d"rewardsmax"]').prop("checked",!0):d.filter('[value\x3d"rewardsnone"]').prop("checked",!0);d=b.find(".rewards-list").show();d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&
d.children(".enter-custom-rewards").show();c.isTouchCX()&&d.length&&(b.find(".rewards-info").hide(),b.find(".top-cell").addClass("bottom-line"),b.find(".bottom-cell").show());r.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",b)})}function Oa(a){D.paymentRows.find(".financial-offer-list").hide();D.paymentRows.find(".financial-offer-err-detail").hide();var b=a.find('.financial-offer-list input[type\x3d"radio"]'),d=b.filter(":checked");
b.prop("checked",!1);0<d.length?d.prop("checked",!0):b.first().prop("checked",!0);b=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();c.isTouchCX()&&b.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function $a(){J(document.body).find(".a-dropdown").each(function(){B.hide(J(this))})}function ab(a){D.paymentRows.find(".installments-select").hide();D.paymentRows.find(".installments-message").show();a.find(".installments-select").show();
a.find(".installments-message").hide()}function cb(a){D.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function bb(a){D.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Va(a){D.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();D.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();a.find(".card-benefit").hide()}function db(a){D.paymentRows.find(".otpBlock").hide();
a.find(".otpBlock").show()}function eb(a){D.paymentRows.find(D.ovdWidgetSection).hide();a.find(D.ovdWidgetSection).show()}function Wa(a){D.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Xa(a){var b=D.newVDC.find("#vdcBanksSelect"),c=D.newVDC.find(".vdc-selected-bank-prompt").hide(),d=D.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=b.val(),f="1"===J("#save_citi_card").val()?"CIT"!==e:!0,k="1"===J("#save_citi_card").val()&&
"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(D.newVDC.find("option:selected").prop("disabled")?(d.show(),c.hide()):(d.hide(),c.show())):(("OtherBanks"===e||k)&&b.val(b.children("option").first().val()).trigger("change"),c.hide())}function Ia(a,b,c){if(!J.isEmptyObject(a)&&b)return b(c)}function Ya(a){var b=J("#cash-back-ineligible-for-cod-message");b&&b.length&&((a=a.find("#cashOnDeliveryCash"))&&a.length?b.removeClass("hidden"):b.addClass("hidden"))}function fb(){var a=
J("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}var J=a.$,Za=!0,D={},gb={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",
morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",
existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",Ma);a.on("checkout:reload:spp-payment",Ma);return{getSelectedPayment:A}});"use strict";r.when("A","page-detector").register("wechat-detector",function(a,l){var m=a.$,c=function(a){a&&!1!==a.isWeChatInstalled&&(a=m("#wechat_payment"),a.length&&a.show())},f=function(a){},h="MShopWeChatPayment";a.on("checkout:reload:payselect",
function(){m("#wechat_payment").length&&(m("#mShopWeChatApiName").length&&(h=m("#mShopWeChatApiName").val()),r.when("safe-mash").execute(function(a){q.cordova.require("cordova/exec")(c,f,h,"isWeChatInstalled",[])}))})});"use strict";r.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,l,m){function c(){w=t("#cashOnDeliveryCash");if(w.length&&(x=w.find(H.verifyOTP),z=w.find(H.sendOTP),N=x.length&&z.length,T=t(H.payMobile).length?1:0,N&&(k=w.find(H.submitSendOTP),
u=w.find(H.submitVerifyOTP),r=w.find(H.submitResendOTP),v=w.find(H.changeOTPNumber),E=w.find(H.OTPPhoneNumber),A=w.find(H.otpCode),k.length&&u.length&&r.length&&v.length))){Q=w.find(H.addURLHash).length;m.increaseCount(V.metricPrefix+V.block,1,1);k.click(function(){q();m.increaseCount(V.metricPrefix+V.send,1,1)});u.click(function(){G=E.val();Z=A.val();n();var a=h(G),b;b=/^\d{6}$/;b=Z&&b.test(Z);a&&b&&""!==L?d("VerifyOTP",L):b?a||w.find(H.otpServiceFailed).removeClass(H.aokHidden):w.find(H.invalidOTPError).removeClass(H.aokHidden);
m.increaseCount(V.metricPrefix+V.verify,1,1)});if(Q&&location.hash&&location.hash.length){for(var a=location.hash,a=a.replace("#",""),a=a.split(";"),c=0;c<a.length;c++)0<=a[c].indexOf(U.codehandle)&&(L=a[c].replace(U.codehandle,"")),0<=a[c].indexOf(U.contactid)&&(W=a[c].replace(U.contactid,"")),0<=a[c].indexOf(U.phonenumber)&&(G=a[c].replace(U.phonenumber,""),E.val(G));""!==L&&""!==W&&""!==G&&b()}r.click(function(){m.increaseCount(V.metricPrefix+V.resend,1,1);q()});v.click(function(){x.addClass(H.aokHidden);
z.removeClass(H.aokHidden);f(r,!1);f(u,!1);n();m.increaseCount(V.metricPrefix+V.changeNumber,1,1)})}}function f(a,b){b?a.addClass(H.aButtonDisabled):a.removeClass(H.aButtonDisabled);T?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function h(a){var b=/^\d{10}$/;return a&&b.test(a)}function g(){w.find(H.otpServiceFailed).removeClass(H.aokHidden)}function b(){var a=w.find(H.verifyOTPPhoneNumber);w.find(H.invalidPhoneNumber).addClass(H.aokHidden);z.hasClass(H.aokHidden)?w.find(H.otpResentSuccess).removeClass(H.aokHidden):
T&&w.find(H.otpSentSuccess).removeClass(H.aokHidden);z.addClass(H.aokHidden);x.removeClass(H.aokHidden);var b=G.substr(0,2)+"*****"+G.substr(7,9);a.text(b);f(r,!1)}function e(a){if(a!==F&&"object"!==typeof a)try{a=t.parseJSON(a)}catch(b){a={}}a=a||{};var c,d=Q&&location.hash?location.hash:"#";Q&&location.hash&&";"!==d.slice(-1)&&(d+=";");c=a.status;a.codeHandle&&null!==a.codeHandle&&(L=a.codeHandle,Q&&"SEND-SUCCESS"===c&&(d=p(d,U.codehandle,L)));a.contactId&&null!==a.contactId&&(W=a.contactId,Q&&
"SEND-SUCCESS"===c&&(d=p(d,U.contactid,W),d=p(d,U.phonenumber,G)));Q&&(location.hash=d);w.find(H.otpAlertClass).addClass(H.aokHidden);if(X[c])X[c]();else X.DEFAULT()}function p(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d),e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function d(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",{method:"get",params:{phoneNumber:G,method:b,codeHandle:c,contactId:W,otp:Z},success:e,error:function(){e({status:"SERVICE-FAILED"})}})}
function n(){A.val("");w.find(H.otpAlertClass).addClass(H.aokHidden)}function q(){n();G=E.val();h(G)?d("SendOTP",L):w.find(H.invalidPhoneNumber).removeClass(H.aokHidden)}var t=a.$,w,x,z,k,u,r,v,E,A,N,T,Q,G="",L="",W="",Z="",H={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",
submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",
otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},U={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},V={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},X={"SERVICE-FAILED":g,"SEND-SUCCESS":b,"VERIFY-SUCCESS":function(){z.addClass(H.aokHidden);x.addClass(H.aokHidden);w.find(H.verifiedOTPSuccess).removeClass(H.aokHidden);w.find("."+H.phonenumberNotVerified).removeClass(H.phonenumberNotVerified);
T&&l.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){w.find(H.invalidPhoneNumber).removeClass(H.aokHidden)},"NUMBER-ALREADY-USED":function(){f(r,!0);f(u,!0);w.find(H.numberAlreadyUsed).removeClass(H.aokHidden)},"MAX-OTP-REACHED":function(){w.find(H.maxOTPError).removeClass(H.aokHidden);f(r,!0)},"INVALID-OTP":function(){w.find(H.invalidOTPError).removeClass(H.aokHidden);A.val("");T?A.attr("placeholder","Re-enter OTP"):(w.find(H.enterOTPLabel).addClass(H.aokHidden),w.find(H.reEnterOTPLabel).removeClass(H.aokHidden))},
DEFAULT:g};a.on("checkout:reload:payselect",c);a.on("checkout:reload:spp-payment",c)});"use strict";r.when("A","pay-common-util","ready").execute(function(a,l){var m={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},c=l.getElements(m);a.on("checkout:payment:challenge:log",function(f){var h={},g;for(g in m)m.hasOwnProperty(g)&&c[g]&&c[g].val()&&(h[g]=c[g].val());f&&(h.paymentInstrumentId=f);Object.keys&&Object.keys(h).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",
{method:"POST",params:h,timeout:1E3,cache:!1})})});"use strict";r.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,l,m,c,f,h,g){function b(){var a=n("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?g.hide("pay-auth-otp-checks"):(a=n("#otp_invalid_msg").val(),g.show("pay-auth-otp-checks",a))}function e(b,c){l.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},
success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(n("#otp_id").addClass("a-form-error"),n("#otpBadCode").removeClass("hidden"),l.hide()):(n("#isFormValidated").val("1"),t.submit())},error:function(a){l.hide()}})}function p(){n("#otp_id").removeClass("a-form-error");n("#otpBadCode").addClass("hidden")}function d(){h.increaseCount(w.metricPrefix+w.resend,1,1);var b="1"===n("#isPaystationFlow").val(),c;b?(c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1",l.show()):c="resend-otp.html?returnHtml\x3d0";
a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(n("#authSourceId").val(a.authSourceId),n("#paystationRequestId").val(a.paystationRequestId)),l.hide())},error:function(a){b&&l.hide()}})}var n=a.$,q,t,w={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",function(){q=n("#resend_form");t=n("#otp_form");t.submit(function(a){var b=n(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(p(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=
b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),e(a,b),!1});q.submit(function(a){"1"===n("#isPaystationFlow").val()&&p();d();return!1});b();n("#otp_id").unbind("keyup").bind("keyup",b)})});"use strict";r.when("A","ajax-utility","client-side-metrics","loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,l,m,c,f,h,g,b,e,p){function d(a){E=
a.popover;var b=k(E);r("#gil-estimates-popover-"+b+" .gil-popover-content").html("");r("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function n(a){E=a.popover;var b=k(E),d=r("#gil-estimates-popover-"+b);d.find("input[name\x3dgil-subtype]").val(b);c.showSpinner(d,!1,E);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(b);r.ajax({type:"POST",url:a,
data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return l.jsonify(a)},success:function(a,e,f){k(E)===b&&(m.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverSuccess",1),e=E,c.hideSpinner(d),a&&a.errors&&0<a.errors.length?d.find(".gil-popover-error").show():a&&a.widgetHTML?d.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):d.find(".gil-popover-error").show(),e.updatePosition(!0))},error:function(a){k(E)===b&&(m.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverError",
1),a=E,c.hideSpinner(d),d.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function q(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function t(a){a.$event.preventDefault();var d=k(E),f=r("#gil-estimates-popover-"+d);c.showSpinner(f,!1,E);var h=w(a.$currentTarget.parents("#gil-estimates-popover-"+d));c.showSpinner(f,!1,E);e.callBatch(h,{success:function(c,e,f){k(E)===d&&(m.increaseCount("Checkout:GIL:"+d+":SubmitIneligiblePopoverSuccess",
1),q(a),b.show(),1==parseInt(r("input[name\x3d'gil-rendered-using-apx']").val(),10)&&p.isGILCreditCardEnabled()?(c=r(".pmts-select-payment-instrument-form"),e=E,"APX_PSP_TO_RCX_SPC"==(e.attrs?e.attrs("data").onSubmit:e.data.onSubmit)&&c&&0<c.length?g.continueClicked(null,c):m.increaseCount("Checkout:GIL:"+d+"Popover:ErrorRedirectingToSPC",1)):z(d))},error:function(a){k(E)===d&&(m.increaseCount("Checkout:GIL:"+d+":SubmitIneligiblePopoverError",1),a=E,c.hideSpinner(f),f.find(".gil-popover-error").show(),
a.updatePosition(!0))},isTrial:0})}function w(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=r(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function x(a){a.$event.preventDefault();var b=r("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),c=b.data("index"),d=b.data("size"),c=(c+("next"===a.data.direction?1:-1)+d)%d,d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+
c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function z(b){h.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){m.increaseCount("Checkout:GIL:"+b+":NewToExistingSuccess",1);g.ajaxUpdatePage(c,d,e);h.scrollTopTo(r("#existing-payment-methods [value\x3d"+b+"]"));if(g.isSPP())a.on("checkout:afterReload",function L(){r("#existing-gil input[value\x3d"+
b+"]").trigger("click");a.off("checkout:afterReload",L)});else r("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){m.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);g.ajaxUpdatePage(a,c,d)}})}function k(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}function u(){v&&(a.declarative("gil-close-popover",["click"],q),a.declarative("gil-submit-popover",["click"],t),a.declarative("gil-ineligible-pagination",["click"],x));r("#gil-cc-payment-type").length&&
(a.off("a:popover:beforeShow:gil-estimates",d),a.off("a:popover:show:gil-estimates",n),a.on("a:popover:beforeShow:gil-estimates",d),a.on("a:popover:show:gil-estimates",n));r("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",d),a.off("a:popover:show:gil-si-estimates",n),a.on("a:popover:beforeShow:gil-si-estimates",d),a.on("a:popover:show:gil-si-estimates",n));v=!1}var r=a.$,v=!0,E;a.on("checkout:reload:payselect",u);a.on("checkout:reload:spp-payment",u);return{submitNewGilPayment:z,
displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);h.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=l.jsonify(c);f&&!f.errors&&f.widgetHTML?m.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageSuccess",1):m.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){m.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();r("#gil-estimates-subpage").remove();r(h.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();r("#gil-ineligible-view");var d=w(a.$currentTarget.parents("#gil-ineligible-view"));e.callBatch(d,{success:function(c,d,e){m.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){m.increaseCount("Checkout:GIL:"+
a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";r.when("A","ready").register("new-verified-debit-card",function(a){});"use strict";r.when("A").register("apb-limit-messaging-helper",function(a){return{}});"use strict";r.when("A","jQuery","client-side-metrics","ready").register("temporary-preference-indicator",function(a,l,m){function c(){"1"===l("meta[name\x3dSWP_TPP_FEATURE_ENABLED]").attr("content")&&l.ajax({type:"GET",url:"/gp/shopwithpoints/temporaryPreference/has-active-temporary-preference.html",
async:!0,dataType:"json",success:function(a){a.hasOwnProperty("Result")?(f=a.Result,m.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Success",1),m.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Success",1)):m.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Failure",1)},error:function(){m.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Failure",1)}})}var f=
"False";a.on("checkout:reload:payselect",c);a.on("checkout:reload:spp-payment",c);a.on("checkout:reload:pay",c);return{hasActiveTemporaryPreference:function(){return"True"===f}}});r.when().register("rentals-ineligible-util",function(){return{}});r.when().register("rentals-ineligible",function(){return{}});"use strict";r.when("A").register("payment-marketplace-helper",function(a){return{}});"use strict";r.when("A","cvf","page-detector","weblab-helper","ready").register("cvf-old-amazon-aui-fixes",function(a,
l,m,c){function f(){a.$(".cvf-widget-form .a-button-dropdown .a-button-text").css("text-overflow","unset")}function h(){var a=n(this).parent(),b=a.find(".a-native-dropdown option")[0];if(b&&b.hasAttribute("data-a-html-content")){var c=[];a.find(".cvf-widget-input.a-native-dropdown option").each(function(){c.push({phone_country_code:n(this).data("a-html-content"),country_iso:n(this).val()})});var d=setInterval(function(){if(n(".a-popover-inner ul").length){var a="rtl"===n("html").attr("dir");n(".a-popover-inner ul").addClass("a-cvf-list-link");
n.each(c,function(b,c){if(b=c.phone_country_code){if(a){b=b.split("+");var d=b[1];b=b[0].trim()+" "+d+"+"}n(".a-popover-inner [data-value\x3d'"+c.country_iso+"']").html(b)}});clearInterval(d)}},0)}n(".cvf-widget-form .a-button-dropdown").die("click")}function g(){var a=n(this).data("value");n(".cvf-widget-form .a-native-dropdown.cvf-widget-input").val(a).change()}function b(){var a=n(this).parent().find(".a-dropdown-prompt"),b=n(this).find("option:selected").html().trim(),c=setTimeout(function(){a.html(b);
clearTimeout(c)},0)}function e(){a.$(".cvf-widget-form .a-alert-inline.cvf-hidden").remove()}function p(){0===n(".cvf-widget-form").length&&(n("#apx-content .a-alert-info").first().remove(),n("[data-testid\x3d'pmts-cod-cash-description']").closest(".pmts-portal-component").find(".a-radio input").trigger("click"))}function d(){if(!B)if(t)a.on("a:pageUpdate a:ajax:complete",e);else a.on("a:pageUpdate a:ajax:complete",f),n(".cvf-widget-form .a-button-dropdown").live("click",h),n(".a-cvf-list-link a").live("click",
g),n(".cvf-widget-input.a-native-dropdown").live("change",b);a.on("cvf:verification:complete",p)}var n=a.$,B=m.isMobile(),t=q.P&&q.P.AUI_BUILD_DATE;c.isCvfOldAmazonUiFixesEnabled()&&(a.on("checkout:reload:payselect",d),a.on("checkout:reload:spp-payment",d))});"use strict";r.when("A","page-detector").register("alipay-detector",function(a,l){var m=a.$,c=function(){var a=m("input[name\x3d'isAlipayAppPayment']");0<a.length&&l.isMobileSpc&&a.val("1")},f=function(a){},h=function(){var a=m("input[name\x3d'isAlipayRedirect']");
0<a.length&&l.isMobileSpc&&a.val("1")},g=function(a){};a.on("checkout:reload:spc",function(){m("input[name\x3d'isAlipayAppPayment']").length&&r.when("safe-mash").execute(function(a){a=q.cordova.require("cordova/exec");a(c,f,"AlipayPlugin","isAlipayInstalled",[]);m("input[name\x3d'isAlipayRedirect']").length&&a(h,g,"AlipayPlugin","isAlipayFailReturnSupported",[])})})});"use strict";r.when("A","page-transition-controller","page-detector").execute(function(a,l,m){function c(){var a=f("#backButtonProtection");
a.length&&"1"===a.val()&&(l.showPageTransition(),document.location.reload())}var f=a.$;r.register("back-button-protection",function(){return{markAsDirty:function(){f("#backButtonProtection").val(1)}}});a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)});"use strict";r.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",
function(a,l,m,c,f,h,g,b,e){function p(){g.isTabletSpc()&&(u=k("#spc-orders .delivery-preferences-options"),x(),u.find("select").trigger("change"),t())}function d(){var a=u.find("input[name\x3dpreference]:checked").val(),b=u.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(u.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),u.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):
b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),u.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),u.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),u.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),
u.find(".neighbor-name-error").hide(),u.find(".neighbor-house-error").hide()):(u.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),u.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),u.find(".neighbor-name-error").hide(),u.find(".neighbor-house-error").hide(),
u.find(".safe-place-error").hide());n(!0)}function n(a){var b=u.find("input[name\x3dpreference]:checked").val();u.find(".safe-place-error").hide();u.find(".neighbor-name-error").hide();u.find(".neighbor-house-error").hide();u.find("input").removeClass("a-form-error");u.find("div.a-input-text-wrapper").removeClass("a-form-error");u.find("select").closest(".a-button").removeClass("a-button-error");0<k("div.spc-tablet").length?u.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):
u.find(".set-delivery-preferences-button").show();u.find(".save-disabled").hide();u.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=u.find("input[name\x3dneighbor-name]");d.data("defaultValueRemoved")&&d.val()||(u.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),u.find(".current-blocker-content").html(u.find(".neighbor-name-error-text").text()),c=!0);d=u.find("input[name\x3dneighbor-house]");
d.data("defaultValueRemoved")&&d.val()||(u.find(".neighbor-house-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),u.find(".current-blocker-content").html(u.find(".neighbor-house-error-text").text()),c=!0)}else"SafePlaceDelivery"===b&&(d=u.find("select[name\x3dSafePlaceLocation]"),d.val()||(u.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),u.find(".current-blocker-content").html(u.find(".safe-place-error-text").text()),
c=!0));d=k("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||"true"===d&&b===F)0<k("div.spc-tablet").length?u.find(".set-delivery-preferences-button").addClass("a-button-disabled"):u.find(".set-delivery-preferences-button").hide(),u.find(".save-disabled").show();return!c}function q(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var d="",g=u.find(".popover-deliv-prefs-content");g.data("obfuscatedEntityId")?
d=g.data("obfuscatedEntityId"):u.data("obfuscatedEntityId")&&(d=u.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+d+"\x26";d=u.find("input[name\x3dpreference]:checked").val();""!==d&&(a+="prefDelLocation\x3d"+d+"\x26","NeighborDelivery"===d?(a+="neighborName\x3d"+encodeURIComponent(u.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(u.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===d&&(a+="safePlaceLocation\x3d"+u.find("select[name\x3dSafePlaceLocation]").val()+
"\x26"),d=u.find("input[name\x3ddefaultPreference]:checked").val(),d!==F&&""!==d&&(a+="isDefaultPreference\x3d1"));0<k("div.spc-tablet").length?l.show():m.showSpinner(u.find(".popover-deliv-prefs-content"),!1,I);e.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");k.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"},success:function(a,d,e){v=!0;0<k("div.spc-tablet").length?l.hide():m.hideSpinner(u.find(".popover-deliv-prefs-content"));e.getResponseHeader("x-amz-checkout-page")?(u.find(".a-button-close").trigger("click"),f.ajaxUpdatePage(a,d,e)):(a=c.jsonify(a),f.redirect(a));b.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,c){0<k("div.spc-tablet").length?l.hide():m.hideSpinner(u.find(".popover-deliv-prefs-content"));n(!0)}})}function t(){u.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",
function(){if(!k(this).data("defaultValueRemoved")){if(g.isMobileSpc()||g.isDesktopSpc())k(this).val(""),k(this).css("color","black");k(this).data("defaultValueRemoved",!0)}}).each(function(){(g.isMobileSpc()||g.isDesktopSpc())&&k(this).data("defaultValueRemoved")&&k(this).css("color","black")});u.find("input:radio[name\x3dpreference]").unbind("click").bind("click",d);u.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){n(!1)});0<k("div.spc-tablet").length?u.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
w):u.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",function(){n(!1)})}function w(a){n(!0)&&q(a)}function x(a){var b=k("#spc-orders .delivery-preferences-options"),c,d="";a?(c=a.$currentTarget.find("input"),d=b.find("input[name\x3dpreference]:checked").val()):c=b.find("input[name\x3dpreference]:checked");b=c.val();if(d!==b){u.find(".expand-content").hide();var d=c,e=d.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
e.find("input").attr("checked",!1);d.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?c.closest(".deliverypreference-option").siblings(".expand-content").show():a&&q(a)}}function z(a){(a=u.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?b.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):b.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",
1))}var k=a.$;if(!k("html").hasClass("a-ie6")){var u,I,v;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(u.find(".current-blocker-content").text()),a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(b.increaseCount("checkoutSpcDeliveryPref-open",1),I=a.popover,u=I.$popover,v=!1,t(),e.recordCSMWithCurrentFieldValues("popover-displayed",
"preference","defaultPreference"),d(),u.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(v||b.increaseCount("checkoutSpcDeliveryPref-dismissed",1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(v||e.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){x(a)});a.declarative("delivery-preferences-expander-toggle",
["click"],function(a){h.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();h.protectAgainstDoubleAction("set-delivery-preferences")||n(!0)&&q()});a.declarative("delivery-preferences-set-default-checkbox-triggered","change",z);a.on("checkout:reload:spc",p)}});"use strict";r.when("A","page-detector","time-left-formatter","weblab-helper").register("fast-track-controller",function(a,l,m,c){function f(){for(var b in t)t[b]&&clearInterval(t[b]);
a.defer(h)}function h(){n.DAY=d("#fasttrack-day").html();n.DAYS=d("#fasttrack-days").html();n.HOUR=d("#fasttrack-hour").html();n.HOURS=d("#fasttrack-hours").html();n.AND=d("#fasttrack-and").html();n.MINUTE=d("#fasttrack-minute").html();n.MINUTES=d("#fasttrack-minutes").html();n.SECOND=d("#fasttrack-second").html();n.SECONDS=d("#fasttrack-seconds").html();(d("#isfresh").length&&d(".checkout.spc-mobile").length||d("#lazy-fresh-promise-delivery-message").length?d("#spc-form"):d("#spc-orders")).find(".fasttrack-span").each(function(){var b=
d(this),c=b.find("input[name\x3d'countdownId']").val();q[c]=parseInt(b.find("input[name\x3d'fasttrackExpiration']").val());w[c]=a.now()/1E3+q[c];g(b.find("input[name\x3d'countdownThreshold']").val(),b,b.find("input[name\x3d'showSimplifiedCountdown']").val(),c);b.show()})}function g(a,c,d,f){0>=q[f]?e(c,null):a&&0<a&&q[f]>a?c.find("span.fasttrackavailable").hide():(b(c,d),t[f]=setInterval(function(){b(c,d,f)},1E3))}function b(b,c,f){0<q[f]?(q[f]=Math.round(w[f]-a.now()/1E3),c=m.getTimeLeftFormatted(q[f],
1===c||"1"===c?!0:!1,n),d("html").hasClass("a-tablet")?b.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+c):b.find("span[data-field\x3d'fasttrackcountdown']").html(c),b.find("span.fasttrackexpired").hide(),b.find("span.fasttrackcountdown").show(),b.find("span.fasttrackavailable").show()):e(b,f)}function e(a,b){b?(t[b]&&clearInterval(t[b]),a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(t[b])}function p(){f()}var d=a.$;if(!d("html").hasClass("a-ie6")){var n=
{},q={},t={},w={};a.on("checkout:reload:spc",f);a.on("checkout:reload:spp-revieworder",f);return{spcLiteLazyLoadFastTrack:p}}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,l,m,c,f){function h(a){if(!r){a.preventDefault();n(a.currentTarget);var b;0<n("#spc-gcpromoinput").length&&(b=encodeURIComponent(n("#spc-gcpromoinput").val()));0<n("#gc-promo-input").length&&(b=encodeURIComponent(n("#gc-promo-input").val()));
var d=encodeURIComponent(n("#spc-usePromoOnly").val());if(b&&0!==b.length){var f=encodeURIComponent(n("input[name\x3dpurchaseTotal]").val());n("#gc-error").hide();n("#gc-promo-success").hide();n("#gc-success").hide();n("#gc-ineligible").hide();n("#promo-success").hide();c.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(n("#payment"))):l.show();var h=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";n(".checkout.spc.aui-templatized").length&&
(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");b="purchaseTotal\x3d"+f+"\x26claimcode\x3d"+b+"\x26disablegc\x3d"+d+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+n("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+h;d=c.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});n.ajax({type:"POST",url:a,data:b,headers:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){r=!1},success:g,error:c.ajaxRedirect});r=!0}else e("addGiftCardOrPromo_NoCode")}}function g(a,d,f){var k=f.getResponseHeader("x-amz-checkout-page");if(k){if(c.ajaxUpdatePage(a,d,f),"spc"===k||"spclite"===k||"spp-revieworder"===k)(a=parseInt(n("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(n("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),10)||0)?setTimeout(function(){b(f)},a):b(f)}else{a=m.jsonify(a);if(!a)return c.redirect();if(a.error)return e(a.error);
if(a.errors)return e(a.errors);if(a.autohandlererror)return p(a.autohandlererror);c.redirect(a)}}function b(a){var b=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");b&&(a||n("#gc-promo-success").show(),0<n("div.spc-desktop").length?(n("#spc-gcpromoinput").removeClass("a-form-error"),n("#gc-promo-input").removeClass("a-form-error")):(n("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),n("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),
"giftcard"===b?(d("applied"),a?(n("#gc-ineligible").show(),d("gcIneligible")):n("#gc-success").show()):n("#promo-success").show())}function e(a){l.hide();n("#gc-error p").hide();n("#gc-error").show();d("error");0<n("div.spc-desktop").length?(n("#spc-gcpromoinput").addClass("a-form-error"),n("#gc-promo-input").addClass("a-form-error")):(n("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),n("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));n(0<
n("#gc-promo-input").length?"."+t[a]:"#"+a).show()}function p(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));q.location.href=c}else q.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function d(b){var c=a.state("cxt-gc-redemption-method").method;
f.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var n=a.$,r=!1;if(!n("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var t={addGiftCardOrPromo_Unknown:"UNKNOWN",addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",
addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",
addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&h(a.$event)});a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){f.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});n(document).delegate("#spc-gcpromoinput, #gc-promo-input",
"keypress",function(a){13===a.which&&h(a)});return{actionAddGiftPromotion:h,giftSystemErrorHandling:p}}});"use strict";r.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",function(a,l,m,c,f,h,g,b,e,p){function d(){var a=R;a.find("#select-recipient").empty();for(var b=0;b<ja.length;b++){var c=K("\x3coption/\x3e").attr({value:ja[b].value}).text(ja[b].text);
a.find("#select-recipient").append(c)}na&&(b=a.find('#select-recipient option[value\x3d"'+na+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),da())}function n(){a.defer(function(){K("#spc-orders").find(".gift-popover-link").each(function(){K(this).data("action")&&K(this).removeAttr("href").attr("tabindex",0)})});K(".larger-image-link").find("a").removeAttr("href")}function r(a){var b=R;b.find(".gift-error-box").hide();
b.find(".fake-label").each(function(){K(this).unbind("click").bind("click",function(){K(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".popover-gift-top .gift-item-title span").html(a.item.title);a&&a.item&&a.item.isAutoripEligible?b.find("#gift-autorip-unavailable-msg").show():b.find("#gift-autorip-unavailable-msg").hide();if(a&&a.obfuscatedEntityId){var c=b.find(".set-gift-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,
giftData:a},t);h.bindActionEnterKeyOnButton(c)}Y?(ha=a&&a.item&&a.item.isAmazonFulfilled,ra=!(a&&a.address&&0===a.address.shipToSelf),ha&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(z(!0),b.find(".mfn-hide-prices").hide(),b.find(".include-gift-receipt").show()):ha||(z(!0),b.find(".include-gift-receipt").hide(),b.find(".mfn-hide-prices").show(),b.find(".include-gift-message").show()),ua=b.find(".include-gift-message").is(":visible"),E()):a&&a.options&&a.options.canHidePrices?
b.find(".hide-prices-checkbox").closest("div").show():b.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(c=M(b.find(".hide-prices-checkbox")),a.selected.hidePrices?c.attr("checked",!0):c.removeAttr("checked"));if(a&&a.item&&a.item.purchaseIsKindle){if(c=b.find(".kindle-registration-box"),c.show(),c.find(".register-kindle-customer-name").html(b.find(".gift-customer-name").html()),!Y){var c=M(b.find(".kindle-reg-radio-another-account")),f=M(b.find(".kindle-reg-radio-your-account"));
a.selected.hidePrices||a.selected.isWrapped?(f.removeAttr("checked"),c.attr("checked",!0)):(c.removeAttr("checked"),f.attr("checked","checked"));M(b.find(".hide-prices-checkbox")).trigger("change")}}else b.find(".kindle-registration-box").hide();if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(c=a.selected.message,f=M(b.find(".include-gift-message-checkbox")),c&&c.length?(b.find("textarea[name\x3d'gift-message-text']").val(c),u(!0)):null===c&&(a.selected.isWrapped||a.selected.hasReceipt)?
(f.removeAttr("checked"),b.find(".textarea[name\x3d'gift-message-text']").val("")):(b.find("textarea[name\x3d'gift-message-text']").val(""),c="",Y?(c+=b.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!ra&&(c+=" "+a.address.firstName),c=c+",\n"+b.find(".sample-gift-msg").html(),c+="\n"):(c+=b.find(".sample-gift-msg").html(),c+="\n\n"),c+=b.find(".sample-gift-msg-from").text(),c=Y?c+e.getNameWithNoTitle(b.find(".gift-customer-name").html()):c+e.getFirstName(b.find(".gift-customer-name").html()),
b.find("textarea[name\x3d'gift-message-text']").val(c),!Y||ra&&ua||u(!0)));var k=K(".gift-message-warning").length,c=function(){Y&&u(!0);L(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(k){var b=R.find("textarea[name\x3d'gift-message-text']");e.toggleGiftMessageWarning(b,R)}};if(a&&a.options){var g=b.find("textarea[name\x3d'gift-message-text']");g.bind("keyup",c);g.bind("mouseup",c);L(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);
k&&e.toggleGiftMessageWarning(g,b);M(b.find(".include-gift-message-checkbox")).bind("change",function(){var c=K(this).is(":checked"),d=a.options.maxMessageChars,f=a.options.maxMessageLines,h=a.options.hasFixedGiftMsgLimit,p=R,n=p.find("textarea[name\x3d'gift-message-text']");c?Y&&v():(0<p.find(".validateInputCharactersOnBlur.a-form-error").size()&&(p.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<p.find("#onblur-character-validation-error-gift-message-text").size()&&
p.find("#onblur-character-validation-error-gift-message-text").remove()),Y?E():(n.val(""),L(d,f,h)));k&&e.toggleGiftMessageWarning(g,b)})}}else b.find(".popover-gift-message-text").css("visibility","hidden"),b.find(".include-gift-message").css("visibility","hidden"),Y&&(b.find(".include-gift-message").hide(),b.find(".popover-gift-message").css("visibility","hidden")),b.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(b.find(".wrap-option").hide(),b.find(".popover-gift-no-wrap-available").show(),
b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),M(b.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(b.find(".wrap-option").hide(),b.find(".popover-gift-fba-wrap").show(),b.find(".hide-prices-amazon-msg").show(),b.find(".hide-prices-merchant-msg").hide(),(c=a.options.wraps[0].imageurl)&&0<c.length&&(b.find(".large-preview").find("img").attr("src",c),b.find(".large-preview").show(),b.find(".fba-wrap-checkbox").show(),
f=b.find(".larger-image-link"),f.unbind("click").bind("click",{imageURL:c},W),h.bindActionEnterKeyOnButton(f)),a.options.wraps[0].description&&b.find(".gift-wrap-title").show().html(a.options.wraps[0].description),"1"===K("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(c=b.find(".popover-gift-amazon-wrap"),w(b,c),C(a,"afn",c)):a.options&&a.options.wraps&&1===a.options.wraps.length?(b.find(".popover-gift-amazon-wrap").hide(),b.find(".popover-gift-merchant-wrap").hide(),
b.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),f=M(b.find(".amazon-gift-wrap")),f.val(a.options.wraps[0].id),c=M(b.find(".hide-prices-checkbox")),a.selected.isWrapped?(f.attr("checked",!0),a.item.purchaseIsKindle||(c.attr("checked",!0),c.attr("disabled",!0),b.find(".hide-prices-note").show())):(f.removeAttr("checked"),c.attr("disabled",!1),b.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(c=b.find(".popover-gift-amazon-wrap"),
w(b,c),ba(a,"afn",c))):(b.find(".wrap-option").hide(),M(b.find(".hide-prices-checkbox")).removeAttr("disabled"),b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),b.find(".large-preview").hide(),c=b.find(".popover-gift-merchant-wrap").show(),c.find(".mfn-wrap-copy").remove(),ba(a,"mfn",c));Y&&(Q(),G(),A());if(0<K(".enable-gift-connections").length){b.find("#popover-gift-connection select.a-touch-select-input").each(function(){K(this).unbind("change").bind("change",
function(){var a=K(this),b=a.siblings("a.a-placeholder"),a=a.find(":selected").text();b.text(a);return!1})});b.find("#select-recipient").bind("change",function(a){O(a);return!1});b.find("#select-occasion").bind("change",function(a){sa(a);return!1});b.find("#input-recipient-first-name").keyup(function(){da()});b.find("#input-recipient-last-name").keyup(function(){da()});b.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=R;pa||a.find("#select-recipient-spinner").show()});
na=F;if(a.giftConnection){typeof a.giftConnection.giftlistTypeId!==F&&"0"===a.giftConnection.giftlistTypeId&&typeof a.giftConnection.occasionId!==F&&"0"===a.giftConnection.occasionId&&b.find("#include-gift-connection-checkbox").attr("checked",!1);a.giftConnection.firstName&&b.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&b.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)c=
b.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+'"]').attr("selected","selected"),b.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(c.text()),b.find(".gift-connection-recipient-extra").show();if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)na=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)na=a.giftConnection.giftlistTypeId;
a.giftConnection.occasionId&&(c=b.find('#select-occasion option[value\x3d"'+a.giftConnection.occasionId+'"]').attr("selected","selected"),b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.occasionMonth&&(c=b.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.occasionDay&&
(c=b.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+'"]').attr("selected","selected"),b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.age&&(c=b.find('#select-occasion-age option[value\x3d"'+a.giftConnection.age+'"]').attr("selected","selected"),b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)b.find(".gift-connection-occasion-extra").show(),
"2"===a.giftConnection.giftlistTypeId&&b.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&b.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||typeof a.giftConnection.occasionId===F||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&da();ja&&(typeof na!==F||a.registryId in ya)?(typeof na===F&&(na=ya[a.registryId]),d(),b.find("#select-recipient").show(),b.find("#select-recipient-spinner").hide(),
pa=!0):(pa=!1,typeof na!==F?oa():oa(a.registryId))}R.find(".content-container").css("visibility","visible");ma.updatePosition(!0);m.hideSpinner(b.find(".popover-content-main"))}function t(a){var b=R,d="";if(!(0<b.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(d+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");ha&&(d+="isAFN\x3d1\x26");M(b.find(".include-gift-receipt-checkbox")).is(":checked")&&(d+="includeReceipt\x3d1\x26");M(b.find(".include-gift-message-checkbox")).is(":checked")?
(d+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(b.find("textarea[name\x3d'gift-message-text']").val())+"\x26",d+="maxChars\x3d"+a.data.giftData.options.maxMessageChars+"\x26",d+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):d+="includeMessage\x3d0\x26";d=M(b.find(".hide-prices-checkbox")).is(":checked")?d+"hidePrices\x3d1\x26":d+"hidePrices\x3d0\x26";b.find(".kindle-registration-box").is(":visible")&&(d+="isKindlePurchase\x3d1\x26");var e;if(b.find(".popover-gift-fba-wrap").is(":visible"))if(b.find(".popover-gift-amazon-wrap").is(":visible")){if((e=
b.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&e.length)for(d+="giftWrap\x3d"+e+"\x26",e=0;e<a.data.giftData.options.wraps.length;e++)if(b.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+e).is(":checked")){d+="currencyAmount\x3d"+a.data.giftData.options.wraps[e].priceAmount+"\x26";d+="currencyUnit\x3d"+a.data.giftData.options.wraps[e].unit+"\x26";break}}else e=M(b.find(".amazon-gift-wrap")),e.is(":checked")&&(d+="giftWrap\x3d"+e.val()+"\x26",a.data.giftData.options&&(d+="currencyAmount\x3d"+
a.data.giftData.options.wraps[0].priceAmount+"\x26",d+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+"\x26"));else if(b.find(".popover-gift-merchant-wrap").is(":visible")&&(e=b.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&e.length)for(d+="giftWrap\x3d"+e+"\x26",e=0;e<a.data.giftData.options.wraps.length;e++)if(b.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+e).is(":checked")){d+="currencyAmount\x3d"+a.data.giftData.options.wraps[e].priceAmount+"\x26";d+="currencyUnit\x3d"+
a.data.giftData.options.wraps[e].unit+"\x26";break}if(0<K(".enable-gift-connections").length)if(b.find("#include-gift-connection-checkbox").is(":checked")){d+="includeGiftConnection\x3d1\x26";a=b.find("#select-recipient").val();d+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)d+="gcFirstName\x3d"+b.find("#input-recipient-first-name").val()+"\x26",d+="gcLastName\x3d"+b.find("#input-recipient-last-name").val()+"\x26";e=b.find("#select-occasion").val();d+="gcOccasionId\x3d"+e+"\x26";if("1"===e||
"2"===e)d+="gcMonth\x3d"+b.find("#select-occasion-month").val()+"\x26",d+="gcDay\x3d"+b.find("#select-occasion-day").val()+"\x26","1"===e&&"2"===a&&(d+="gcAge\x3d"+b.find("#select-occasion-age").val()+"\x26"),d+="gcHasReminder\x3d"+(b.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else d+="includeGiftConnection\x3d0\x26";(a=K("input#executionId").val())&&(d+="executionId\x3d"+a+"\x26");a=(new Date).getTime();d+="isClientTimeBased\x3d"+K("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
a;f.isSPP()&&(ma.hide(),a=K("#setOrderingPrefsCheckbox"),a.length&&a.is(":checked")&&(d+="\x26saveAsDefaultsSelected\x3d1"));l.show();a=f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});K.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:d,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,d,e){e.getResponseHeader("x-amz-checkout-page")?(f.isSPP()||b.find(".a-button-close").trigger("click"),
f.ajaxUpdatePage(a,d,e)):(a=c.jsonify(a),f.redirect(a))},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}}function w(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function x(){var a=R,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=M(a.find(".amazon-gift-wrap")),d=M(a.find(".afn-wrap-none")),e=M(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function z(a){var b=R,c=M(b.find(".include-gift-receipt-checkbox")),b=M(b.find(".mfn-hide-prices-checkbox"));a?(ha&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),ha||b.is(":checked")||b.attr("checked",!0).trigger("change")):(ha&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!ha&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function k(a){var b=
R,c=M(b.find(".include-gift-receipt-checkbox")),b=M(b.find(".mfn-hide-prices-checkbox"));a?(z(!0),ha?c.attr("disabled","disabled"):b.attr("disabled","disabled")):ha?c.removeAttr("disabled"):b.removeAttr("disabled")}function u(a){var b=M(R.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),I(!1),v()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),E())}function I(a){var b=R,c=b.find(".no-message-warning"),d=b.find(".no-receipt-warning"),
e=b.find("textarea[name\x3d'gift-message-text']"),b=b.find(".message-remaining-text");a&&!d.is(":visible")?(p.showGiftTextAreaOnWarning()||e.addClass("gift-message-warning"),b.hide(),c.show()):(p.showGiftTextAreaOnWarning()||e.removeClass("gift-message-warning"),c.hide(),b.show())}function v(){var a=R,b=a.find("textarea[name\x3d'gift-message-text']"),a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function E(){var a=R,b=a.find("textarea[name\x3d'gift-message-text']"),
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function A(){var b=R,c=M(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),k=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),g=b.find("textarea"),h=!1;b.find(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(h=!0)});b.find(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&
(h=!0)});b.find(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(h=!0)});h?(e.hide(),d.show(),g.attr("placeholder",k),ha&&(u(!0),ua&&c.attr("disabled","disabled"))):(d.hide(),ha&&e.show(),g.attr("placeholder",f),c.removeAttr("disabled"))}function N(){var a=R,b=M(a.find(".include-gift-message-checkbox")),a=a.find("textarea[name\x3d'gift-message-text']");!ra&&ha&&(b.is(":checked")&&0<a.val().length?I(!1):I(!0))}function T(){var a=R,b=M(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning"),
a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),ua||u(!0)):(a.hide(),c.show(),u(!1))}function Q(a){a=R;var b=M(a.find(".include-gift-receipt-checkbox")),b=ha&&b.is(":checked"),c=M(a.find(".mfn-hide-prices-checkbox")),c=!ha&&c.is(":checked");b||c?(U(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):(V(),k(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function G(a){a=R;var b=!1;M(a.find(".include-gift-message-checkbox")).is(":checked")&&
(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});(b||c)&&z(!0);b&&ua||c?k(!0):k(!1)}function L(a,b,c){var d=R;P=a;ta=b;if(a=d.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:q.unescape(encodeURIComponent(a.val())).length;Y&&!ra&&ha&&(0<b?I(!1):I(!0));var e=a.val().split("\n").length;
c=P-b;e=ta-e;!Y&&0<b&&d.find(".include-gift-message-checkbox").not(":checked")&&d.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var k in a)24<a[k].length&&(e=0===a[k].length%24?e-(Math.floor(a[k].length/24)-1):e-Math.floor(a[k].length/24));d.find(".popover-gift-center .remainder-count").hide();(-1>c?d.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?d.find(".popover-gift-center .remaining-char-over-single").show():1===c?d.find(".popover-gift-center .remaining-char-single").show():
d.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>e?d.find(".popover-gift-center .remaining-line-over-multiple").show():0>e?d.find(".popover-gift-center .remaining-line-over-single").show():1===e?d.find(".popover-gift-center .remaining-line-single").show():d.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(e));if(0>c||0>e)f.isSPP()?(d.find(".set-gift-options-button").addClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(d.find(".set-gift-options-button").hide(),d.find(".set-gift-options-button-disabled").show()),0>c?(d.find(".gift-char-limit-error").find(".char-limit-error").html(P),d.find(".current-blocker-content").html(d.find(".gift-char-limit-error").html())):0>e&&(d.find(".gift-line-limit-error").find(".line-limit-error").html(ta),d.find(".current-blocker-content").html(d.find(".gift-line-limit-error").html()));-1<c&&-1<e&&(f.isSPP()?(d.find(".set-gift-options-button").removeClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(d.find(".set-gift-options-button").show(),d.find(".set-gift-options-button-disabled").hide()))}}function W(a){a.stopPropagation();var b=R;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",
Z);h.bindActionEnterKeyOnButton(c);wa=!0}function Z(a){wa=!1;var b=R;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function H(a){var b=R,c=!1;K(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});K(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});K(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&
(c=!0)});if(c)U(),X();else if(M(b.find(".hide-prices-checkbox")).is(":disabled"))ca();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?U():V();else if(f.isSPP())(b=a.closest(".a-radio"))&&a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?V():b.hasClass("kindle-reg-radio-another-account")&&U());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?
V():U()}function U(){var a=R,b=M(a.find(".hide-prices-checkbox"));b.is(":checked")&&!f.isSPP()||b.attr("checked","checked");M(a.find(".kindle-reg-radio-your-account")).is(":checked")&&M(a.find(".kindle-reg-radio-another-account")).attr("checked",!0)}function V(){var a=R,b=M(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");M(a.find(".kindle-reg-radio-another-account")).is(":checked")&&M(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function X(){var a=R;M(a.find(".hide-prices-checkbox")).attr("disabled",
"true");M(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);M(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}function ca(){var a=R;M(a.find(".hide-prices-checkbox")).removeAttr("disabled");M(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");M(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function ia(a){var b=h.getPosition(a,
"#",2),c=h.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function C(b,c,d){var e=aa(),f,k;e?(f=d.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]'),k=d.find(".carousel-gift-wrap").find("ol")):(f=d.find("."+c+"-wrap-template"),k=d.find("ul.allGiftWrapList"));e&&a.trigger("checkout:gift:removeEmptyCarouselCards",k);var g=(d.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||e||(k.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),K("#giftwrap-carousel-wrap-holder-"+
g).css("width",90*(b.options.wraps.length+1)),K("#giftwrap-carousel-wrap-pane-"+g).css("width",360));for(var h=R,p=h.find(".larger-image-link-carousel-template"),n=0;n<b.options.wraps.length;n++){var l=f.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),m=p.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+n),u=c,t=b,q=n,r=l,v=m,y=t.options.wraps[q].id;r.find("input").addClass(u+"-wrap-"+q).val(y);r.find("label").attr("for",u+"-wrap-"+
q);y=t.options.wraps[q].description;r.find("."+u+"-wrap-description").html(y);y=t.options.wraps[q].price;r.find("."+u+"-wrap-price").html(y);(t=t.options.wraps[q].imageurl)&&t.length?(r.find("."+u+"-image").attr("src",t).show(),u=r.find(".larger-image-link"),u.show(),u.unbind("click").bind("click",{imageURL:t},W),v.unbind("click").bind("click",{imageURL:t},W),v.find("a").unbind("click").bind("click",{imageURL:t},W)):"mfn"!==u||aa()||(r.find(".a-span3").hide(),r.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
r.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){q=b;v=n;r=g;u=k;t=h;y=q.options.wraps[v].id;l.data("giftwrap-id",y);l.data("wrap-no",v);if(q.selected.wrap===y){u.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");l.find("img").addClass("selected-giftwrap-image");var q=l.find("img").attr("src"),B=K("#giftwrap-option-preview-imagearea-image-"+r);B.find("img").attr("src",q);B.removeClass("aok-hidden");K("#giftwrap-option-preview-imagearea-default-"+r).addClass("aok-hidden");
H(l.find("input"));x();m.removeClass("aok-hidden");m.addClass("selectedWrapLargeLink")}aa()?(r=ia(y)?"gift-wrap":"noshi-wrap",l.removeClass(r).removeClass("none-wrap"),u.append(l.show())):(r=ia(y)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",u.append(K(r).append(l.show())));l=t.find("#carousel-larger-image-div");l.find(".larger-image-link-carousel-"+v).length||l.append(m.show())}}d.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&b.selected.isWrapped?d.find("input[value\x3d'"+
b.selected.wrap+"']").attr("checked",!0):M(d.find("."+c+"-wrap-none")).attr("checked",!0);e&&a.trigger("checkout:gift:adjustCarouselInitial",b,d)}function aa(){return f.isSPP()&&K("input[name\x3dsppGiftPopoverWithCarousel]").length}function ba(a,b,c){for(var d=c.find("."+b+"-wrap-template"),e=0;e<a.options.wraps.length;e++){var k=d.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),g=a.options.wraps[e].id;k.find("input").addClass(b+"-wrap-"+e).val(g);k.find("label").attr("for",b+"-wrap-"+
e);g=a.options.wraps[e].description;k.find("."+b+"-wrap-description").html(g);g=a.options.wraps[e].price;k.find("."+b+"-wrap-price").html(g);if((g=a.options.wraps[e].imageurl)&&g.length){var h=k.find("."+b+"-image");f.isSPP()&&h.removeClass("hidden");h.attr("src",g).show();h=k.find(".larger-image-link");f.isSPP()&&h.removeClass("hidden");h.show();h.unbind("click").bind("click",{imageURL:g},W)}else k.find(".a-span3").hide(),k.find(".a-span9").addClass("a-span12").removeClass("a-span9"),k.find(".a-color-price").removeClass("wrap-price");
f.isSPP()&&k.removeClass("hidden");k.insertAfter(d).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):M(c.find("."+b+"-wrap-none")).attr("checked",!0)}function y(){R.find("#include-gift-connection-checkbox").attr("checked",!0)}function ea(){if(R.find(".include-gift-connection-checkbox").not(":checked")){var a=R;a.find(".gift-connection-recipient-extra").hide();var b;b=a.find('#select-recipient option[value\x3d"0"]').attr("selected",
"selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");da()}}function fa(a){for(var b=R,c=0;c<ja.length;c++)if(a&&a===ja[c].value&&ja[c].bMonth&&ja[c].bDay){var d;d=b.find('#select-occasion-month option[value\x3d"'+ja[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());
d=b.find('#select-occasion-day option[value\x3d"'+ja[c].bDay+'"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function da(){var a=R,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});
else{b=R;b.find(".gift-connection-occasion-extra").hide();var c;c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function ka(a,b){var c=R;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function O(a){a=
R;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&fa(b)):a.find(".gift-connection-recipient-extra").show();ka(c,b);da()}function sa(a){a=R;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||
"1"!==b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&fa(c),a.find(".gift-connection-occasion-extra").show());ka(b,c)}function oa(a){var b=R,c="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";ja&&(c+="\x26mappingOnly\x3d1");a&&(c+="\x26fromRegistryIds\x3d"+a);K.ajax({type:"POST",url:c,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(c){b.find("#select-recipient").hide();!ja&&c.options&&0<c.options.length&&(ja=c.options);a&&c.registryIdMapping?
(ya[a]=c.registryIdMapping[a],na=c.registryIdMapping[a]):a&&(ya[a]=F);ja&&d();b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();pa=!0},error:function(){b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();pa=!0}})}function S(b,c){var d=aa(),e=c.lineItemId;c=aa()?c.currentTab:b.data("current-tab");var f=K("#popover-gift-options-wrapper-"+e).data("active-tab");c!==f&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),
b.addClass("selected-giftwrap-tab"),b=K("#giftwrap-carousel-wrap-holder-"+e),d||b.css("left",0),f=K("#giftwrap-carousel-wrap-holder-"+e+" li"),d?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,e),a.trigger("checkout:gift:adaptCarouselSPCPanel",e,c)):"all"===c?f.show():(f.hide(),f.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),K("#popover-gift-options-wrapper-"+e).data("active-tab",c),f.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),f.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),
K("#giftwrap-option-preview-imagearea-default-"+e).removeClass("aok-hidden"),K("#giftwrap-option-preview-imagearea-image-"+e).addClass("aok-hidden"),d=K("#allGiftWrapList-"+e).find(".none-wrap").find("input"),e=K(".selectedWrapLargeLink"),d.prop("checked",!0),d.val("").change(),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")))}function xa(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(K("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);0>b&&(b=b+90+"px",K("#giftwrap-carousel-wrap-holder-"+
a).css("left",b))}function qa(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=K("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();var d=d.find("li.noshi-wrap").size(),e=K("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(K("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",K("#giftwrap-carousel-wrap-holder-"+a).css("left",b))}function Aa(a,b){var c=b.lineItemId;K("#allGiftWrapList-"+
c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();var d=a.data("giftwrap-id"),e=a.find("input"),f=a.data("wrap-no");e.prop("checked",!0);e.val(d).change();d=K("#giftwrap-option-preview-imagearea-default-"+c);c=K("#giftwrap-option-preview-imagearea-image-"+c);e=K(".selectedWrapLargeLink");f=K(".larger-image-link-carousel-"+f);b.hasClass("none-wrap")?(d.removeClass("aok-hidden"),c.addClass("aok-hidden"),e.length&&
(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),d.addClass("aok-hidden"),c.removeClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")),f.length&&(f.addClass("selectedWrapLargeLink"),f.removeClass("aok-hidden")))}function va(a,b){var c=b.lineItemId;b=K("#giftwrap-option-preview-imagearea-default-"+c);c=K("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),
c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function Ba(a,b){var c=b.lineItemId;a=K("#giftwrap-option-preview-imagearea-default-"+c);b=K("#giftwrap-option-preview-imagearea-image-"+c);K("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul","li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=K("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),
b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}var K=a.$;if(!K("html").hasClass("a-ie6")){var P,ta,R,ma,wa=!1,Y=!1,ra=!0,ha=!0,ja,pa=!1,ya={},na,ua=!1;a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")&&(f.isSPP()&&b.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),wa&&Z(),Y&&(a=R,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),M(a.find(".amazon-gift-wrap")).removeAttr("checked"),
u(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){R=a.popover.$popover;ma=a.popover;0<R.find(".include-gift-receipt-checkbox").length&&(Y=!0);m.showSpinner(R.find(".popover-content-main"),!1,ma);R.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=ma.data;if(b)a+=
"\x26obfuscatedEntityId\x3d"+b;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(d){q.ueLogError&&q.ueLogError(d,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}K.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return c.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&
f.redirect(a);null!==a?r(a,b,c):f.ajaxRedirect()},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=R,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");
b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var la={enforceSelectorParity:H,enforceGiftReceiptParity:G,enforceHidePriceParity:Q,disableHidePrice:x,toggleMessageBoxDisplay:A,toggleEmptyMsgWarning:N,toggleNoReceiptWarning:T,includeGiftConnection:y,clearGiftConnection:ea,toggleGiftConnectionRecipientArea:O,toggleGiftConnectionOccasionArea:sa,updateGiftOptionsTabSelection:S,updateCarouselOnLeftClick:xa,updateCarouselOnRightClick:qa,updateSelectedGiftWrap:Aa,
updatePreviewImageOnMouseEnter:va,updatePreviewImageOnMouseLeave:Ba},M=e.getInput;a.declarative("gift-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(la[b[c]])la[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(la[b[c]])la[b[c]](a.$currentTarget,
a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);S(b,a.data)});a.on("checkout:reload:spc",n);a.on("checkout:reload:spp-revieworder",n)}});"use strict";r.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,l,m,c,f,h,g,b){function e(){r("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");
a.defer(function(){r("#spc-orders").find(".concealment-popover-link").each(function(){r(this).data("action")&&r(this).removeAttr("href").attr("tabindex",0)})})}function p(a){return a.is("input")?a:a.find("input")}function d(a){var b=t;b.find(".fake-label").each(function(){r(this).unbind("click").bind("click",function(){r(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var c=
b.find(".set-concealment-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},n);h.bindActionEnterKeyOnButton(c)}x=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(c=p(b.find(".conceal-item-checkbox")),a.selected.concealItem?c.attr("checked",!0):c.removeAttr("checked"));t.find(".content-container").css("visibility","visible");w.updatePosition(!0);m.hideSpinner(b.find(".popover-content-main"))}function n(a){var d=t,
e="";a&&a.data&&a.data.obfuscatedentityid&&(e+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(e+="quantity.0\x3d"+a.data.quantity+"\x26");var g="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(g=a.data.concealmentData.saveConcealmentRefTag);var h="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(h=a.data.concealmentData.cancelConcealmentRefTag);(a=p(d.find(".conceal-item-checkbox")).is(":checked"))?
(x&&(e+="isAFN.0\x3d1\x26"),e=e+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(r("input[name\x3d'concealment-item-message']").val())+"\x26"),e=e+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+g+"\x26")):e+="ref\x3d"+h+"\x26";var n=r("input#executionId").val();n&&(e+="executionId\x3d"+n+"\x26");n="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(n+=g,b.increaseCount("CPEX.Checkout.Select.Concealment",1)):(n+=h,b.increaseCount("CPEX.Checkout.Cancel.Concealment",
1));f.isSPP()&&(d.find(".a-button-close").trigger("click"),g=r("#setOrderingPrefsCheckbox"),g.length&&g.is(":checked")&&(e+="\x26saveAsDefaultsSelected\x3d1"));l.show();r.ajax({type:"POST",url:n,data:e,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,e){e.getResponseHeader("x-amz-checkout-page")?(f.isSPP()||d.find(".a-button-close").trigger("click"),f.ajaxUpdatePage(a,
b,e)):(a=c.jsonify(a),f.redirect(a))},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}var r=a.$;if(!r("html").hasClass("a-ie6")){var t,w,x=!0;r(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){b.increaseCount("CPEX.Checkout.Concealment.Button.click",1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(f.isSPP()&&b.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),p(t.find(".conceal-item-checkbox")).removeAttr("checked"))});
a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){t=a.popover.$popover;w=a.popover;m.showSpinner(t.find(".popover-content-main"),!1,w);t.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=w.data.lineItemEntityId,e=w.data.itemId;if(b)a+="\x26obfuscatedEntityId\x3d"+b;else if(e)a+="\x26lineItemEntityId\x3d"+e;else throw{name:"MissingData",
message:"lineItemId is undefined"};var g=w.data.quantity;if(g)a+="\x26quantity\x3d"+g;else throw{name:"MissingData",message:"quantity is undefined"};}catch(h){q.ueLogError&&q.ueLogError(h,{logLevel:"FATAL",attribution:"concealment-popover",message:"[Data missing to open the concealment-popover]. "})}b=w.data.ref;r.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+b,data:a+("\x26ref\x3d"+b),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},
dataFilter:function(a){return c.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&f.redirect(a);null!==a?d(a,b,c):f.ajaxRedirect()},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=t;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var z={};a.declarative("concealment-popover-element",
["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(z[b[c]])z[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(z[b[c]])z[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)}});"use strict";r.when("A",
"page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker","weblab-helper").register("gold-box-controller",function(a,l,m,c,f,h,g){function b(){a.defer(d);a.defer(n)}var e=a.$,p={};if(!e("html").hasClass("a-ie6")){var d=function(){var a=e("#goldbox-countdown"),b=e("#spc-orders");b&&0!==b.length||(b=e("#spclite-items-block"));b=b.find("input[name\x3dgoldboxexpirelefttime]");if(0!==b.length){if(1<b.size()){var c=parseInt(b.attr("data-timeleftms"),10),d=b;e.each(b,function(){var a=
e(this),b=parseInt(a.attr("data-timeleftms"),10);b<c&&(d=a,c=b)});b=d}var g=parseFloat(b.attr("data-pagestarttime")),k=parseFloat(b.attr("data-timeleftms")/1E3);if(!(isNaN(g)||isNaN(k)||0>=k)){var h=(new Date).getTime();isNaN(p[g])?(p={},p[g]=h):h=p[g];var n=a.find("span[data-timefield\x3dminute]"),r=a.find("span[data-timefield\x3dsecond]"),E=q.setInterval(function(){var b=(new Date).getTime();k-=(b-h)/1E3;h=b;if(0>k&&E)r.html("00"),q.clearInterval(E),E=null,l.isSPP()&&f.increaseCount("checkout:spp-revieworder:deal_expired",
1),e("#gold-box-modal-launcher").trigger("click"),m.scrollToTop(),m.toggleScrollOff();else{var b=Math.floor(k/60%60),c=Math.floor(k%60),c=10>c?"0"+c:c;n.html(b);r.html(c);a.is(":visible")||a.show()}},1E3);l.isSPP()&&f.increaseCount("checkout:spp-revieworder:deal_countdown",1)}}},n=function(){var a=e("#gold-box-button-blocker");1===a.length&&h.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",b);a.on("checkout:reload:spclite",b);a.on("checkout:reload:spp-revieworder",
b)}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency","weblab-helper").register("inline-points-controller",function(a,l,m,c,f,h,g,b,e){function p(){k("#spc-points-input")&&k("#spc-points-input").data("points-used")&&(k("#points-applied").show(),k("#inline-points-button").hide());k("#inline-points-register")&&k("#inline-points-register").removeAttr("href");k("#spc-loyalty-points-input")&&
k("#spc-loyalty-points-input").val()&&(k("#loyalty-points-applied").show(),k("#loyalty-points-button").hide());k("#spc-points-input")&&k("#spc-points-input").hasClass("show-currency-input-widget-new")&&k("#spc-points-input").each(function(c,d){var e=a.$(d);c={$element:e,maxAmount:e.data("max-dollar-amount")};d={$element:a.$("#inline-raw-points"),decimalPlaces:e.data("decimal-places"),ratio:e.data("conversion-ratio")};var f=e.data("country-code"),f=b.getCurrencyFormatByCountryCode(f);b.initializeInlineFormatting(c,
d,f);k(document).delegate("#spc-points-input","keydown",function(a){if(e.data("points-used")!==e.val){a=k("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),d=a.find("span.change");k("#points-applied").hide();e.data("points-used")?(c.hide(),d.show()):(c.show(),d.hide());b?a.addClass("display-inline-block"):a.show()}})})}function d(a,b){a.preventDefault();if(n(b)){c.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(k("#payment"))):l.show();var d,f;a={"x-amz-checkout-page":"spc"};
if(b)f=k("#loyalty-points-hidden-fields"),b="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit",d="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(f.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+"\x26jpPointsCustomerRequestedAmount\x3d"+k("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+f.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+f.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+
"\x26jpPointsTargetCurrencyCode\x3d"+f.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26jpPointsAvailablePoints\x3d"+f.find("input[name\x3d'jpPointsAvailablePoints']").val()+"\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+k("input[name\x3duseCtb]").val();else{a=c.setAjaxTransitionHeader(a);f=k("#inline-points-hidden-fields");var g=f.find("input[name\x3d'useGCBalance']").val();b="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(c.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply");
d="paymentMethodId\x3d"+f.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+f.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+f.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+k("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+f.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+g+"\x26usePromoBalance\x3d"+g+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+
k("input[name\x3duseCtb]").val();e.isBRMarketplaceCurrencyFormatEnabled()&&(d="paymentMethodId\x3d"+f.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+f.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+f.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+k("#spc-points-input").val().replaceAll(",",".")+"\x26rewardAccountRate\x3d"+f.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+g+"\x26usePromoBalance\x3d"+
g+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+k("input[name\x3duseCtb]").val())}k.ajax({type:"POST",url:b,data:d,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:a,success:function(a,b,d){d.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,d):(a=m.jsonify(a),c.redirect(a))},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}}function n(a){var b=!1,c=k("input[name\x3drewardAccountAmount]"),
d=k("#inline-points-error-block");a||k("#spc-points-input")&&!k("#spc-points-input").hasClass("show-currency-input-widget-new")?(a&&(c=k("input[name\x3dloyaltyPointsValue]"),d=k("#loyalty-points-error")),d.hide(),d.find("p").hide(),t(c))?r(c,a)?x(c,a)||(d.find("p").filter(function(){return"badMax"===k(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===k(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badValue"===
k(this).data("error")}).show().css("display","inline"),b=!0):a||r(c,a)||(d.find("p").filter(function(){return"badMin"===k(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function q(a,b){var c=k(a.currentTarget),d=c.val();e.isBRMarketplaceCurrencyFormatEnabled()&&(d=d.includes(".")?d.replaceAll(".",","):d.replaceAll(",","."));a=k("#inline-raw-points");b&&(a=k("#loyalty-points-applied-value"));var g=
a.html();if(b)!/^\s*$/.test(d)&&!isNaN(d)&&0<d?a.html(d):a.html(0);else if(!k("#spc-points-input").hasClass("show-currency-input-widget-new")){var h=c.data("min-dollar-amount");!/^\s*$/.test(d)&&!isNaN(d)&&0<d&&!isNaN(h)&&d>=h?(h=c.data("conversion-ratio"),c=c.data("decimal-places"),c=e.isBRMarketplaceCurrencyFormatEnabled()?f.getNumberWithSeparators(d/h,c).replaceAll(".","z").replaceAll(",",".").replaceAll("z",","):f.getNumberWithSeparators(d/h,c),a.html(c)):a.html(0)}(b||k("#points-applied").is(":visible"))&&
g!==a.html()&&(a=k("#spc-loyalty-points-display"),g=k("#loyalty-points-applied"),c=k("#loyalty-points-button"),d=!1,b||(a=k("#inline-points-button"),a.is("span")&&(d=!0),g=a.find("span.apply"),c=a.find("span.change"),k("#points-applied").hide()),g.hide(),c.show(),d?a.css("display","inline-block"):a.show())}function t(a){a=a.val();e.isBRMarketplaceCurrencyFormatEnabled()&&(a=a.includes(".")?a.replaceAll(".",","):a.replaceAll(",","."));return/^\s*$/.test(a)||!isNaN(a)}function r(a,b){if(b)return!0;
b=a.val();e.isBRMarketplaceCurrencyFormatEnabled()&&(b=b.includes(".")?b.replaceAll(".",","):b.replaceAll(",","."));if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function x(a,b){var c=a.val();e.isBRMarketplaceCurrencyFormatEnabled()&&(c=c.includes(".")?c.replaceAll(".",","):c.replaceAll(",","."));if(/^\s*$/.test(c))return!0;var c=parseFloat(c),d=a.data("max-dollar-amount");b&&(d=a.data("available-points"));return isNaN(c)||
!d?!0:c<=d}function z(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var b=k("#loyalty-points-button"),c=k("#spc-points-input");0<b.length&&b.is(":visible")?d(a,1):0<c.length&&d(a,0)}}var k=a.$;k("html").hasClass("a-ie6")||(k(document).delegate("#spc-loyalty-points-input","keypress",function(a){z(a)}),k("#spc-points-input")&&!k("#spc-points-input").hasClass("show-currency-input-widget-new")&&(k(document).delegate("#spc-points-input","keypress",function(a){z(a)}),k(document).delegate("#spc-points-input",
"keyup",function(a){q(a,0)})),k(document).delegate("#spc-loyalty-points-input","keyup",function(a){q(a,1)}),k(document).delegate("#inline-points-button","click",function(a){d(a,0)}),k(document).delegate("#loyalty-points-button","click",function(a){d(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",function(a){g.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",p),a.on("checkout:reload:spp-revieworder",p))});"use strict";r.when("A","client-side-metrics",
"ready").execute(function(a,l){var m=a.$;a.on("checkout:reload:spc",function(){var a=m("input[name\x3d'rewardsProgramId']").val(),f=m("input[name\x3d'swpWidgetCase']").val();a&&f&&l.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+f,1)})});"use strict";r.when("A","client-side-metrics","ready").execute(function(a,l){function m(){"1"!==c("meta[name\x3dSWP_TPP_FEATURE_ENABLED]").attr("content")||f||c.ajax({type:"POST",url:"/gp/shopwithpoints/temporaryPreference/verify-and-log-temporary-preference.html",
data:{sourcePage:"SPC"},dataType:"text",async:!0,success:function(){f=!0;l.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Success",1)},error:function(){l.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Failure",1)}})}var c=a.$,f=!1;a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m);a.on("checkout:reload:spp-revieworder",m);a.on("checkout:reload:spp-collapsed",m)});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor").register("inline-fps-balance-controller",
function(a,l,m,c){function f(a){a.preventDefault();h("#inline-fps-balance-checkbox").prop("disabled","disabled");c.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(h("#payment"))):l.show();var b=h("#inline-fps-balance-hidden-fields"),e=0;h("#inline-fps-balance-checkbox").prop("checked")&&(e=1);a=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var f="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(c.isSPP()?"chk_pay_"+(e?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply"),
b="fpsPaymentMethodId\x3d"+b.find("input[name\x3d'fpsPaymentMethodId']").val()+"\x26useFlexiblePayments\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+h("input[name\x3duseCtb]").val();h.ajax({type:"POST",url:f,data:b,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,e){e.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,e):(a=m.jsonify(a),c.redirect(a))},error:function(a,b,e){c.ajaxRedirect(a,b,e)}})}var h=a.$;h("html").hasClass("a-ie6")||
h(document).delegate("#inline-fps-balance-checkbox","click",function(a){f(a)})});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils","error-feature-detection","page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,l,m,c,f,h,g,b,e,p){function d(){y?C("fieldset div.a-radio").addClass("a-touch-radio"):a.defer(function(){var a=C("#spc-orders").find("div.ship-option");a.filter(".no-scheduled-delivery");
a.each(function(){C(this).find("input.radio-image").remove()});a.each(function(){var a=C(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});da=C("#spc-orders").find("div.ship-option").find('input[type\x3d"radio"]:checked');ka=da.attr("value");n();h.markFeatureAvailable("shipping-speed-selection-controller");B()}function n(){var a=0<C("#trigger-case-call-to-resolve-cv").length||0<C(".force-resolve-invalid-ship-option").length;if(c.isSPP()&&a){var a=function(){var a=q.setInterval(function(){c.isAnimating()||
(l.show(),q.clearInterval(a))},50)},b=C("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");if(b&&b.length){var d=b.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();T(b,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:d}})}}}function B(){C("#buy-button-disabled-state").length&&t(function(a){w(a)})}function t(a){C("div.sd-widgets").each(function(b,c){a(c)})}
function w(a){var b=setInterval(C.proxy(function(){if(C(this).hasClass("sd_widget_initialized")){var a=C(this),c=C(a).attr("id");c&&(a=x(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&T(null,c,a));q.clearInterval(b)}},a),1E3)}function x(a){var b={};z(a,function(a){var c=C(a).attr("key");a=C(a).val();b[c]=a||""});return b}function z(a,b){C(a).find("input[type\x3d'hidden']").each(function(a,c){b(c)})}function k(a){return e.isExcludeMdwFromGoldenCXWidgetRenamingWeblabEnabled()?!(a&&a[0]&&a[0].classList&&
a[0].classList.contains("sd-mdw-widget-root")):!0}function u(){aa||(aa=C("input[type\x3d'hidden'][name\x3d'scopeId']").val());return aa}function I(a,b,d){if(d.getResponseHeader("x-amz-checkout-page")){var f=m.jsonify(a);return f&&f.success&&f.trialkey&&ba[f.trialkey]?(a=ba[f.trialkey],c.isSPP()&&"object"===typeof a&&(a=JSON.stringify(ba[f.trialkey])),e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<C(".mobile-view").length?c.ajaxUpdatePage(a,b,d,{pushNewFrame:"false"}):c.ajaxUpdatePage(a,b,d),ea&&
(clearTimeout(ea),ea=null),ba={},!0):e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<C(".mobile-view").length?c.ajaxUpdatePage(a,b,d,{pushNewFrame:"false"}):c.ajaxUpdatePage(a,b,d)}return c.redirect(a)}function v(a,b){if(a){var c=a.data(b);if(c!==F)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function E(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}
function A(a){var b=a;C(".shipping-group").each(function(a,c){var d=!1;C(c).parents().each(function(a,b){return C(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function N(a,b,c){var d="",f=0;1<a.length&&(d+="\x26forcesetbylineitem\x3d1");a.each(function(g,h){var p=C(h),n="",l=p.data("orderid"),m=p.has(".prime-calendar-container"),t=p.find("input[name\x3d'currentshippingspeed']").attr("value"),q=p.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===a.length&&(d+=
"\x26oldoption\x3d"+t+"."+q);var u=p.find("input[name\x3d'defaultshipsplitpreference."+l+"']").attr("value"),r=p.find("input[name\x3d'usingprimeshipping."+l+"']").attr("value");u&&r&&(n+="\x26defaultshipsplitpreference."+f+"\x3d"+u,n+="\x26usingprimeshipping."+f+"\x3d"+r);u=p.find(".shipping-speed");u=b?u.find('input[type\x3d"radio"]:checked'):u.find("input[src*\x3dradio-on]");m&&!u.length&&(u=p.find("input[name\x3d'hiddenSelection"+l+"']"));r=p.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");
1!==r.length&&(r=p.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));c===p.data("orderid")&&(v(b,"shippingofferingid")?u=b:r=b,1===a.length&&(n=m?n+("\x26option\x3d"+u.data("key")+"."+(r?r.attr("value"):"")):n+("\x26option\x3d"+u.attr("value")+"."+(r?r.attr("value"):""))));var y=p.find("input[name\x3d'lineitemids"+l+"']");0<y.length&&(n+="\x26lineitemids"+f+"\x3d"+y.attr("value"));e.isSecureUnifiedDeliveryEnabled()&&(y=p.find("input[name\x3d'issecureunifieddelivery"+
l+"']"),0<y.length&&(n+="\x26issecureunifieddelivery"+f+"\x3d"+y.attr("value")));var y=p.find("input[name\x3d'onOrAfterAppointment"+l+"']").val(),z=p.find("input[name\x3d'onOrAfterLineItemId"+l+"']").val(),w="";y&&z&&(w+="\x26onOrAfterAppointment"+f+"\x3d"+y,w+="\x26onOrAfterLineItemId"+f+"\x3d"+z);n+=w;if(u.length)n+=Z(u,r,f,m),1===v(u,"isscheduleddelivery")?(h=u.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),e.isScheduleDeliveryHiddenInputIdFixEnabled()?(k(h)&&(h=C("#sd-widgets-"+l)),
g=h.children(":input").serialize(),h.length&&(l=h.get(0).id.substring(11),h=l.replace(/^(\d+)(-)?/,function(a,b,c){return f+(c?c:"")}),g=g.replaceAll(l+"\x3d",h+"\x3d"),g=g.replace(/(SD-OrderID-\d+=)\d+/,"$1"+f),g=g.replace(/(SDV1-orderId-\d+=)\d+/,"$1"+f)),n+="\x26"+g):(k(h)&&(h=C("#sd-widgets-"+g)),n+="\x26"+h.children(":input").serialize())):1===v(u,"isscheduleddeliveryslot")&&v(u,"sddatastring")&&(n+="\x26ScheduledDeliveryEntity.data."+f+"\x3d"+encodeURIComponent(u.data("sddatastring"))),"rush-ispu"===
u.attr("value")&&(n+=L(p,f,r));else if(Q(p))n+=G(p,f,t,q);else{if(p.find("[data-action\x3d'checkout-select-ship-option-radio'").length)return;e.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&"1"===C(h).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+f+"']").attr("value")||(n+="\x26isdigital"+f+"\x3d1")}f++;d+=n});0<f&&(d+="\x26groupcount\x3d"+f);return d}function T(a,d,g,h){y&&E(a);h&&h.transitionAction?h.transitionAction():l.show();for(var p in fa)fa.hasOwnProperty(p)&&(fa[p].abort(),
delete fa[p]);g=C("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();var n;a||(a=C("#"+d).closest(".shipping-speed").find("input[type\x3d'radio']"));a.attr("value")!==ka&&(b.increaseCount("checkout:spc:shipoption:change",1),ka=a.attr("value"));n=a.closest(".shipment").data("orderid");a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&(n=a.closest(".prime-calendar").data("orderid"));var m="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(h&&h.extraData)for(var t in h.extraData)h.extraData.hasOwnProperty(t)&&(m+="\x26"+t+"\x3d"+h.extraData[t]);var q=C(".shipment"),r=0;d=q.length;q=A(q);m+="\x26groupsadded\x3d"+(q.length-d);e.isSkipZeroShippingSpeedShipmentEnabled()?m+=N(q,a,n):(q.each(function(b,c){var d=C(c),f="",g=d.has(".prime-calendar-container"),h=d.find("input[name\x3d'currentshippingspeed']").attr("value"),p=d.find("input[name\x3d'currentshipsplitpreference']").attr("value");
1===q.length&&(m+="\x26oldoption\x3d"+h+"."+p);var l=d.find("input[name\x3d'defaultshipsplitpreference."+r+"']").attr("value"),t=d.find("input[name\x3d'usingprimeshipping."+r+"']").attr("value");l&&t&&(m+="\x26defaultshipsplitpreference."+r+"\x3d"+l,m+="\x26usingprimeshipping."+r+"\x3d"+t);l=d.find(".shipping-speed");l=a?l.find('input[type\x3d"radio"]:checked'):l.find("input[src*\x3dradio-on]");g&&!l.length&&(l=d.find("input[name\x3d'hiddenSelection"+r+"']"));t=d.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");
1!==t.length&&(t=d.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));n===d.data("orderid")&&(v(a,"shippingofferingid")?l=a:t=a,1===q.length&&(f=g?f+("\x26option\x3d"+l.data("key")+"."+(t?t.attr("value"):"")):f+("\x26option\x3d"+l.attr("value")+"."+(t?t.attr("value"):""))));var u=d.find("input[name\x3d'lineitemids"+r+"']");0<u.length&&(f+="\x26lineitemids"+r+"\x3d"+u.attr("value"));e.isSecureUnifiedDeliveryEnabled()&&(u=d.find("input[name\x3d'issecureunifieddelivery"+
r+"']"),0<u.length&&(f+="\x26issecureunifieddelivery"+r+"\x3d"+u.attr("value")));f+=ca(d,r);l.length?(f+=Z(l,t,r,g),1===v(l,"isscheduleddelivery")?(c=l.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),k(c)&&(c=C("#sd-widgets-"+b)),f+="\x26"+c.children(":input").serialize()):1===v(l,"isscheduleddeliveryslot")&&v(l,"sddatastring")&&(f+="\x26ScheduledDeliveryEntity.data."+r+"\x3d"+encodeURIComponent(l.data("sddatastring"))),"rush-ispu"===l.attr("value")&&(f+=L(d,r,t))):Q(d)?f+=G(d,r,h,p):e.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&
"1"===C(c).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+r+"']").attr("value")||(f+="\x26isdigital"+r+"\x3d1");r++;m+=f}),0<r&&(m+="\x26groupcount\x3d"+r));d="ox_spc_set_ship_option";c.isSPP()&&(d="chk_revieworder_set_ship_option",t=C("#setOrderingPrefsCheckbox"),t.length&&t.is(":checked")&&(m+="\x26saveAsDefaultsSelected\x3d1"));t=C("input[name\x3duseCtb]").val();m+="\x26isClientTimeBased\x3d"+t;1===v(a,"istrial")?(g=u()+":"+a.attr("name")+":"+a.attr("value"),m+="\x26trialkey\x3d"+g,
ba[g]&&(ea&&clearTimeout(ea),d="ox_spc_set_cached_ship_option",c.isSPP()&&(d="chk_revieworder_set_cached_ship_option"),m=m.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),m+="\x26trialSuccess\x3d1")):"undefined"!==typeof g&&(g=g+":"+a.attr("name")+":"+a.attr("value"),m+="\x26trialkey\x3d"+g);h&&h.refTag&&(d=h.refTag);h&&h.removeGiftOption&&(m+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));0===m.indexOf("\x26")&&(m=m.substr(1));h="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+
d;g=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<C(".mobile-view").length&&(g=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));C.ajax({type:"POST",url:h,data:m,dataType:"text",async:!0,cache:!1,headers:g,success:function(a,b,c){I(a,b,c);f.nukeDropdowns("#b2brd-cadence-dropdown")},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function Q(a){return e.isVasTrueSPCEnabled()?"1"===C.trim(a.data("iahiddenshipment"))||
0<a.find(".vas-scheduling-prefBlock").length:0<a.find(".vas-scheduling-prefBlock").length}function G(a,b,c,d){var e;e=""+("\x26shippingofferingid"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'shippingofferingid']").val());e+="\x26guaranteetype"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'guaranteetype']").val();e+="\x26issss"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'issss']").val();e+="\x26forceshipsplitpreference"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'forceshipsplitpreference']").val();
return e+("\x26shippingspeed"+b+"\x3d"+c)+("\x26shippriority"+b+"\x3d"+d)}function L(a,b,c){var d;d=""+("\x26preferredSSP"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'shipsplitpriority']").val());d+="\x26currentSSP"+b+"\x3d"+c.attr("value");"shipWhenever"==a.find("input[name\x3d'ispuShipSplitPriority']").attr("value")&&(d=d+("\x26isShipWheneverValid"+b+"\x3d1")+("\x26isShipWhenCompleteValid"+b+"\x3d0"));return d}function W(a,b){y&&E(a);a=b.find("input[name\x3d'ispuLoadingText']").attr("value");
if(c.isSPP()&&a){var d=C("#shipaddress");d&&d.length&&(d.hasClass("expanded")?l.show():(l.shrinkPanel(C(".spp-panel.expanded"),!1),l.shrinkPanel(d,!0,a)))}else l.show();a="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";var d=b.find("input[name\x3d'storeAddressID']").attr("value"),e=b.find("input[name\x3d'storeId']").attr("value"),f=b.find("input[name\x3d'storeOwnerId']").attr("value"),k=b.find("input[name\x3d'lineItemsQuantity']").attr("value"),
g=b.find("input[name\x3d'destinationType']").attr("value"),h=b.find("input[name\x3d'ispuShippingOfferingId']").attr("value"),p=b.find("input[name\x3d'ispuShipSplitPriority']").attr("value"),n=b.find("input[name\x3d'ispuGuaranteeType']").attr("value"),m=b.find("input[name\x3d'ispuPageType']").attr("value");a=a+("\x26storeId\x3d"+e)+("\x26storeAddressId\x3d"+d)+("\x26storeOwnerId\x3d"+f);a+="\x26lineItemsQuantity\x3d"+k;a+="\x26destinationType\x3d"+g;a+="\x26shippingOfferingId\x3d"+h;a+="\x26shipPriority\x3d"+
p;a+="\x26guaranteeType\x3d"+n;a+="\x26pageType\x3d"+m;b=b.find("input[name\x3d'retailProgram']");b.length&&(a+="\x26retailProgram\x3d"+b.attr("value"));b="chk_spc_ispu_ship_option";c.isSPP()&&(b="chk_revieworder_ispu_ship_option");b="/gp/buy/ispu/handlers/ispu-select-store.html/ref\x3d"+b;d=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});0<C(".mobile-view").length&&(d=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));C.ajax({type:"POST",url:b,data:a,
dataType:"text",async:!0,cache:!1,headers:d,success:function(a,b,c){I(a,b,c)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function Z(a,b,c,d,e){var f="";"undefined"!==typeof e&&(c+="-"+e);if(v(a,"rcxsspdecoupling"))return f={},f["shippingspeed"+c]=d?a.attr("key"):a.attr("value"),f["shippingofferingid"+c]=v(a,"shippingofferingid"),f["guaranteetype"+c]=v(a,"guaranteetype"),f["issss"+c]=v(a,"issss"),f["forceshipsplitpreference"+c]=v(a,"forceshipsplitpreference"),d="shipWhenComplete",b&&(d=b.attr("value")),
1===v(a,"isscheduleddelivery")&&(f["isscheduleddelivery"+c]="1",d="shipWhenComplete"),f["shippriority"+c]=d,f["preferredSSP"+c]=v(a,"shipsplitpriority"),f["currentSSP"+c]=b.attr("value"),f["isShipWheneverValid"+c]=v(a,"isshipwhenevervalid"),f["isShipWhenCompleteValid"+c]=v(a,"isshipwhencompletevalid"),f=C.param(f),"\x26"+f;f=d?f+("\x26shippingspeed"+c+"\x3d"+a.data("key")):f+("\x26shippingspeed"+c+"\x3d"+a.attr("value"));f+="\x26shippingofferingid"+c+"\x3d"+v(a,"shippingofferingid");f+="\x26guaranteetype"+
c+"\x3d"+v(a,"guaranteetype");f+="\x26issss"+c+"\x3d"+v(a,"issss");f+="\x26forceshipsplitpreference"+c+"\x3d"+v(a,"forceshipsplitpreference");d="shipWhenComplete";b&&(d=b.attr("value"));1===v(a,"isscheduleddelivery")&&(f+="\x26isscheduleddelivery"+c+"\x3d1",d="shipWhenComplete");return f+("\x26shippriority"+c+"\x3d"+d)}function H(a){var b=[a.closest(".shipment").data("orderid")];V(a,b)}function U(a){var c=[];C("#spc-orders").find(".shipment").each(function(a,b){c.push(a)});b.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",
1);V(a,c)}function V(a,b){l.show();var d="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",e="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");C("#spc-orders").find(".shipment").each(function(c,e){d+="\x26lineitemids"+c+"\x3d"+C(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+c+"']").attr("value");d+=ca(C(e),c);var f=C(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");if(e=-1===b.indexOf(c)?
C(e).find("#selected-ship-option-"+c):a)d+="\x26shippingofferingid"+c+"\x3d"+e.data("shippingofferingid"),d+="\x26guaranteetype"+c+"\x3d"+e.data("guaranteetype"),d+="\x26issss"+c+"\x3d"+e.data("issss"),d+="\x26forceshipsplitpreference"+c+"\x3d"+e.data("forceshipsplitpreference"),d+="\x26shippriority"+c+"\x3d"+e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(d+="\x26preferredSSP"+c+"\x3d"+e.data("shipsplitpriority"),d+="\x26currentSSP"+c+"\x3d"+f.attr("value"),d+="\x26isShipWheneverValid"+
c+"\x3d"+e.data("isshipwhenevervalid"),d+="\x26isShipWhenCompleteValid"+c+"\x3d"+e.data("isshipwhencompletevalid"))});var f=C("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val(),d=d+("\x26groupcount\x3d"+f),d=d+("\x26isClientTimeBased\x3d"+C("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value")),d=d+("\x26trialkey\x3d"+u()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey")),f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});C.ajax({type:"POST",url:e,data:d,
dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){I(a,b,c)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function X(b,c,d,e){f.protectAgainstDoubleAction(c)||sa||(a.trigger(d,b),b=b.$currentTarget.find("a"),e&&e(b))}function ca(a,b){var c=a.find("input[name\x3d'onOrAfterAppointment"+b+"']").val();a=a.find("input[name\x3d'onOrAfterLineItemId"+b+"']").val();var d="";c&&a&&(d=d+("\x26onOrAfterAppointment"+b+"\x3d"+c)+("\x26onOrAfterLineItemId"+b+"\x3d"+a));return d}function ia(){O.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",
!0);"undefined"!==typeof p?(0<C(".mobile-view").length?p.get(C("#faster-than-same-day-sosp-popover")):p.get(C("#faster-than-same-day-spc-popover"))).hide():a.$("div.a-popover button.a-button-close").trigger("click");T(O,null,null,{removeGiftOption:!0})}var C=a.$;if(!C("html").hasClass("a-ie6"))if(q.spcpage){var aa,ba={},y=C("html").hasClass("a-touch"),ea,fa={},da,ka,O;q.spcpage.scheduledDeliverySetSOCallback=function(b,d){c.isSPP()&&a.objectIsEmpty(b)||(q.spcpage&&C("#spcpagecontent").is(":visible")?
q.spcpage.actionSetShipOptions(null,d,b):T(null,d,b))};q.spcpage.scheduledDeliverySetSOCallbackWithTarget=function(b,d,e){c.isSPP()&&a.objectIsEmpty(d)||(q.spcpage&&C("#spcpagecontent").is(":visible")?q.spcpage.actionSetShipOptions(null,e,d):T(b,e,d))};q.spcpage.scheduledDeliveryEnableSOCallback=function(){};q.spcpage.scheduledDeliveryMdwSetSOCallback=function(b,d,f){e.isSsdMdwEnabled()&&(c.isSPP()&&a.objectIsEmpty(d)||(q.spcpage&&C("#spcpagecontent").is(":visible")?q.spcpage.actionSetShipOptions(null,
f,d):T(b,f,d)))};q.spcpage.secureDeliverySetSOCallback=function(a,b){e.isSecureUnifiedDeliveryEnabled()&&T(a,null,null,b)};C(document).delegate(".ship-option","click",function(c){var d=C(c.target);e.isSDIncentiveFixEnabled()?e.isSPCMobileDisplayMoreShipOptionsEnabled()&&C(c.target).closest(".ship-option").hasClass("mobile-view")&&"a-link-normal"!==c.target.parentNode.parentNode.className&&c.preventDefault():e.isSPCMobileDisplayMoreShipOptionsEnabled()&&C(c.target).closest(".ship-option").hasClass("mobile-view")&&
c.preventDefault();var k=C(c.currentTarget);b.resetMetrics();if(!(d.is('a[target\x3d"AmazonHelp"]')||d.is('a[target\x3d"PromoDetails"]')||d.hasClass("no-ship-option-selection-change")||k.is("input")||d.hasClass("a-button")||d.closest("a-button").length||d.is("img")&&(d.closest("div").is(".prime-ship-speed")||d.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(d=k.find("div.prime-ship-speed"),0<d.length)d.find("a:first img").trigger("click");else if((d=k.find("input[type\x3d'image']").attr("src"))&&
d.match(/radio-off/)&&C(".ap_popover_sprited").hide(),k=k.find("input[type\x3d'radio']"),(d=k.closest("div.shipping-speeds").data("sospargs"))&&1===k.data("isscheduleddelivery")&&!k.is(":checked"))l.show(),k.attr("checked",!0),E(k),f.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+d);else if(e.removesGiftOptionOnRush()&&0<k.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===k.closest(".radio-standard").data("nosupportforgiftoption")){O=k;O.is(":checked")&&
(O.attr("checked",!1),da.attr("checked",!0));var h=0<C(".mobile-view").length?C("#faster-than-same-day-sosp-popover"):C("#faster-than-same-day-spc-popover");"undefined"!==typeof p?p.get(h).show():a.delay(function(){h.trigger("click")},10)}else if(k.hasClass("js-no-serverside-callback")&&(k.attr("checked",!0),E(k),k.closest(".a-section-expander-container").find(".a-link-section-expander").click()),!e.isSsdMdwEnabled()||1!==k.closest(".radio-standard").data("callcaseforsdoverride"))if(1!==v(k,"isscheduleddelivery")||
!g.isDesktopSpc()){var d=C("#disableSubmitButtons").length,n=!1;e.isSPCMobileDisplayMoreShipOptionsEnabled()&&(c=C(c.currentTarget).closest(".ship-option"),c.hasClass("mobile-view")&&!c.hasClass("mobile-selected-option")&&(n=!0));!d&&k.is(":checked")&&!n||1===k.data("isscheduleddelivery")||(k.attr("checked",!0),T(k))}});C(document).delegate(".ship-option input[type\x3d'radio']","change",function(a){if(!e.isSPCMobileDisplayMoreShipOptionsEnabled()||!C(a.target).closest(".ship-option").hasClass("mobile-view")){a=
C(a.currentTarget);var b=a.closest("div.prime-ship-speed");e.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===a.closest(".radio-standard").data("nosupportforgiftoption")||e.isSsdMdwEnabled()&&1===a.closest(".radio-standard").data("callcaseforsdoverride")||1===v(a,"isscheduleddelivery")&&g.isDesktopSpc()||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",!1):1!==a.data("isscheduleddelivery")&&T(a))}});C(document).delegate(".ispu-ship-option",
"click",function(a){if(e.isISPUMasterEnabled()){C(a.target).closest(".ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();C(a.target);var c=C(a.currentTarget);b.resetMetrics();var d=c.find("input[type\x3d'radio']"),f=!1;a=C(a.currentTarget).closest(".ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(f=!0);if(!d.is(":checked")||f)d.attr("checked",!0),W(d,c)}else b.increaseCount("checkout:ispu:selection:weblab:disabled",1)});C(document).delegate(".ispu-ship-option input[type\x3d'radio']",
"change",function(a){if(!e.isISPUMasterEnabled())b.increaseCount("checkout:ispu:selection:weblab:disabled",1);else if(!C(a.target).closest(".ispu-ship-option").hasClass("mobile-view")){a=C(a.currentTarget);var c=a.closest(".ispu-ship-option");W(a,c)}});C(document).delegate(".rush-ispu-ship-option","click",function(a){if(e.isRushISPUMasterEnabled()){C(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();C(a.target);var c=C(a.currentTarget);b.resetMetrics();var d=
c.find("input[type\x3d'radio']"),f=!1;a=C(a.currentTarget).closest(".rush-ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(f=!0);if(!d.is(":checked")||f)d.attr("checked",!0),W(d,c)}else b.increaseCount("checkout:rushIspu:selection:weblab:disabled",1)});C(document).delegate(".rush-ispu-ship-option input[type\x3d'radio']","change",function(a){if(!e.isRushISPUMasterEnabled())b.increaseCount("checkout:rushIspu:selection:weblab:disabled",1);else if(!C(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")){a=
C(a.currentTarget);var c=a.closest(".rush-ispu-ship-option");W(a,c)}});C(document).delegate(".rush-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});C(document).delegate(".mfn-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});a.declarative("shipping-speed-expander-toggle",["click"],function(a){var b=a.$target.closest(".a-box"),c,d;b.hasClass("a-single")?(c=b.find(".expanded-header-content"),d=b.find(".collapsed-header-content"),
d.hide(),c.hasClass("prime-title")&&c.find("div").attr("style",""),c.show()):(d=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),d.html(b),c.hide(),d.show());f.toggleExpanderContent(a)});a.declarative("select-prime-slot",["click"],function(a){a=a.$currentTarget;C(".a-button-close").trigger("click");a.closest(".valid-slot").hasClass("selected-slot")||T(a)});var sa=!1;C(document).delegate(".mobile-upsell",
"touchmove",function(a){sa=!0});C(document).delegate(".mobile-upsell","touchstart",function(a){sa=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){X(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",H)});a.declarative("select-all-upsell-shipping-speed",["click","touchend"],function(a){X(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",U)});a.declarative("faster-than-same-day-save",["click"],
ia);a.declarative("faster-than-same-day-sosp-save",["click"],ia);a.on("checkout:reload:spc",d);a.on("checkout:reload:spp-revieworder",d)}else r.log("window.spcpage undefined, shipping-speed-selection-controller not initialized","WARN","ship-speed")});"use strict";r.when("A","page-detector","spc-page-state","client-side-metrics","page-conductor","page-transition-controller","weblab-helper").register("order-summary-controller",function(a,l,m,c,f,h,g){function b(){e();E=k("#transactionalRadio");A=k("#marketplaceRadio");
I=k("#tfx-see-exchange-rates");v=k("#tfx-switch-currency-options");u||(c.increaseCount("removeauijs15"),k("#transactionalRadioImage").remove(),k("#marketplaceRadioImage").remove(),k("#acceptAccImage").remove());var a=k("#exchange-rate-link"),b=k("#switch-currency-link");if(0!==A.length){var d=v.find('input[name\x3d"switchCurrency"]'),f=d.not(":checked"),d=m.prop("currencyType")||d.filter(":checked").val();f.val()===d?f.trigger("click"):w(d);u||(c.increaseCount("removeauijs16"),a.find("i.a-icon-collapse").remove(),
b.find("i.a-icon-collapse").remove())}}function e(){if(0!==k("#currencyConverterFooter").length){k("#tfx-header").hide();var a=k("input[name\x3d'placeYourOrderButtonText']").val();k(".place-your-order-button").val(a);u&&(f.isSPP()?k(".place-order-button-text"):k(".place-your-order-button + span")).text(a);var a=p(),b=k("#subtotals-marketplace-table"),c=k("#subtotals-marketplace-spp-bottom"),e=k("#vatRetailSubtotals-marketplace-table"),g=k("#vatGlobalSubtotals-marketplace-table"),h=k("#vatMerchantSubtotals-marketplace-table"),
l=k("#subtotals-transactional-table"),n=k("#subtotals-transactional-spp-bottom"),m=k("#vatRetailSubtotals-transactional-table"),t=k("#vatGlobalSubtotals-transactional-table"),q=k("#vatMerchantSubtotals-transactional-table");"LOCAL"===a?(d("transactional"),l.show(),n.show(),m.show(),t.show(),q.show(),b.hide(),c.hide(),e.hide(),g.hide(),h.hide()):"MARKETPLACE"===a&&(d("marketplace"),l.hide(),n.hide(),m.hide(),t.hide(),q.hide(),b.show(),c.show(),e.show(),g.show(),h.show())}}function p(){return k("input[name\x3d'selectedCurrencyOption']").val()}
function d(a){k(".tfx-currency").each(function(){k(this).text(k(this).data(a))})}function n(a,b){var c=f.setAjaxTransitionHeader(),d="/checkout/p/p-"+k("input[name\x3d'purchaseID']").val()+"/currency-converter";h.show();k.ajax({type:"POST",url:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:k.param(JSON.parse(JSON.stringify({termsAndConditions:a,currencyOption:b})),!0),dataType:"text",cache:!1,async:!0,headers:c,success:function(a,b,c){h.hide();f.ajaxUpdatePage(a,b,c);e()},
error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}function r(){var a=p(),b=k("input[name\x3d'currencyOptions']:checked").val();b!==a&&n(F,b)}function t(){var a=k("input[name\x3d'currencyConverterTCAgreement']"),b=a.val(),a=a.is(":checked").toString();a!==b&&n(a,F)}function w(b){d(b);m.prop("currencyType",b);var e=k("#subtotals-marketplace-table"),g=k("#subtotals-transactional-table"),h=k("#subtotals-marketplace-spp-bottom"),p=k("#subtotals-transactional-spp-bottom"),n=k("#vatRetailSubtotals-transactional-table"),
t=k("#vatGlobalSubtotals-transactional-table"),q=k("#vatMerchantSubtotals-transactional-table"),r=k("#vatRetailSubtotals-marketplace-table"),z=k("#vatGlobalSubtotals-marketplace-table"),w=k("#vatMerchantSubtotals-marketplace-table"),x=k(".place-your-order-button"),B=k("#fx-enable"),v=f.isSPP()?k(".place-order-button-text"):k(".place-your-order-button + span");f.isSPP()||setTimeout(function(){var a=Math.max(e.outerHeight(),g.outerHeight());0<a&&(e.height(a),g.height(a))},500);if(!u){c.increaseCount("removeauijs17");
var aa=A.siblings("i"),ba=E.siblings("i");if(aa.hasClass("a-icon-touch-radio-inactive")||aa.hasClass("a-icon-touch-radio-active"))"marketplace"===b?(aa.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),ba.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):(ba.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),aa.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===
b?(k("#fxGoodNews-transactional").hide(),k("#fxGoodNews-marketplace").show(),g.hide(),e.show(),p.hide(),h.show(),n.hide(),t.hide(),q.hide(),r.show(),z.show(),w.show(),I&&I.hide(),B&&B.hide(),x.val(k("#placeYourOrderTextMarketplace").val()),u&&v.text(k("#placeYourOrderTextMarketplace").val()),k("#currencyChanged").attr("value","true"),k("#fxCurrencyChoice").attr("value","marketplace"),k("#tfx-total-header").addClass("aok-hidden"),k("#mkt-total-header").removeClass("aok-hidden")):(k("#fxGoodNews-transactional").show(),
k("#fxGoodNews-marketplace").hide(),e.hide(),g.show(),h.hide(),p.show(),r.hide(),z.hide(),w.hide(),n.show(),t.show(),q.show(),I&&I.show(),B&&B.show(),x.val(k("#placeYourOrderTextTransactional").val()),u&&v.text(k("#placeYourOrderTextTransactional").val()),k("#currencyChanged").attr("value","false"),k("#fxCurrencyChoice").attr("value","transactional"),k("#mkt-total-header").addClass("aok-hidden"),k("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");l.isMobileSpc()&&
(h=k("#vatBreakdownNote"),0<h.size()&&(p=h.attr("href"),p=0<p.lastIndexOf(".html?")?p+("\x26currencyType\x3d"+b):p+("?currencyType\x3d"+b),h.attr("href",p)))}function x(a){var b=k("#tfx-footer"),d=k("#tfx-header");if(!u){c.increaseCount("removeauijs18");var e=k("#fxApplicabilityDecision").siblings("i"),f=k("#fxApplicabilityAdoption").siblings("i");if(f.hasClass("a-icon-touch-checkbox-inactive")||f.hasClass("a-icon-touch-checkbox-active"))f.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),
e.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(z()?(k("#fx-terms-and-conditions").show(),k("#fxCardCurrencySubcondition").hide()):(k("#fx-enable").show(),k("#fx-disable").hide()),k("#fxApplicabilityDecision").prop("checked",!0),d.show(),w("transactional"),b.show(),k("#marketplaceRadio").prop("checked",!1),k("#transactionalRadio").prop("checked",!0),k("#fxApplicabilityChoice").attr("value","accept")):(z()?(k("#fx-terms-and-conditions").hide(),
k("#fxCardCurrencySubcondition").show()):(k("#fx-enable").hide(),k("#fx-disable").show()),k("#fxApplicabilityAdoption").prop("checked",!1),d.hide(),w("marketplace"),b.hide(),k("#transactionalRadio").prop("checked",!1),k("#marketplaceRadio").prop("checked",!0),k("#fxApplicabilityChoice").attr("value","decline"))}function z(){return f.isSPP()&&k("input[name\x3disNewTFXExperienceEnabled]").length}var k=a.$;if(!k("html").hasClass("a-ie6")){var u=q.P&&q.P.AUI_BUILD_DATE;k(document).delegate("input[name\x3d'currencyOptions']",
"click",r);k(document).delegate("input[name\x3d'currencyConverterTCAgreement']","click",t);var I,v,E,A;g.isTFXCurrencyToggleOnTabletFixed()?(k(document).delegate("#checkoutCurrencyTransactional","click",function(){w("transactional")}),k(document).delegate("#checkoutCurrencyMarketplace","click",function(){w("marketplace")})):(k(document).delegate("#transactionalRadio","click",function(){w("transactional")}),k(document).delegate("#marketplaceRadio","click",function(){w("marketplace")}));k(document).delegate("#fxApplicabilityDecisionCheckbox",
"click",function(){x("decline")});k(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=z()&&!k("#fxApplicabilityAdoption").is(":checked");x(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){c.increaseCount("checkout:spp-ordersummary:expand_tfx_options",1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){c.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",1)});return{updateCurrencyOption:r,updateTermsAndConditionsAgreement:t,
changeCurrency:w,initOrderSummary:b}}});"use strict";r.when("A","ready").register("spc-page-state",function(a){var l={};return{prop:function(a,c){if(a&&"string"===typeof a)return 1<arguments.length&&(l[a]=c),l[a]}}});"use strict";r.when("A","ready").execute(function(a){function l(){0<m("#spcCachedPromiseData").length&&(c=(new Date).getTime(),m(".place-your-order-button").click(function(){var a=(new Date).getTime()-c;m("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+
a+"' /\x3e")}))}var m=a.$,c=0;a.on("checkout:reload:spc",l);a.on("checkout:reload:spclite",l);a.on("checkout:reload:spp-revieworder",l)});"use strict";r.when("A","client-side-metrics","ready").register("spc-apx-standin",function(a,l){function m(c){var h=a.state("apx-standin-state");h.timestamp=(new Date).toISOString();h.metricName=c;return h}if(a.state("apx-standin-state")){var c=m("APX_STANDIN_ENABLED");l.emitNexusMetrics(c,c.producerId,c.schemaId);a.on("a:popover:show",function(a){if(a.popover&&
a.popover.name&&"apx-popover"==a.popover.name||a.popover&&a.popover.originalFocus&&a.popover.originalFocus.id&&"payChangeButtonId"==a.popover.originalFocus.id)a=m("APX_STANDIN_POPOVER_SHOW"),l.emitNexusMetrics(a,a.producerId,a.schemaId)});a.on("a:sheet:afterShow:apx_standin_bottom_sheet_instance",function(a){a=m("APX_STANDIN_POPOVER_SHOW");l.emitNexusMetrics(a,a.producerId,a.schemaId)})}});"use strict";r.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor",
"checkout-general-utils","ready").register("changeCustomerDetailsPopover",function(a,l,m,c,f,h){function g(){return 0<p("#onblur-character-validation-error-changeNameInput").size()}function b(){d&&d.find("button[data-action\x3da-popover-close]").trigger("click")}function e(){var a=p("#saveButton");if(a.length){var b=p("#changeNameInput"),c=p("#changePostNumberInput"),d=p("#changePhoneInput"),e=1,f=1,k=1;b.length&&!b.val()&&(e=0);c.length&&!c.val()&&(f=0);d.length&&!d.val()&&(k=0);e&&f&&k&&!g()?(a.removeClass("a-button-disabled"),
a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var p=a.$,d;a.declarative("clickedsave","click submit",function(a){if(!g()){var c=p("#changeNameInput").val(),d=p("#changePhoneInput").val(),e=p("#changePostNumberInput").val(),h=p("#changeAccountNameCheckBox").is(":checked")?1:0,m=p("#changePostNumberCheckBox").is(":checked")?1:0,c="custName\x3d"+encodeURIComponent(c)+"\x26changeAccountName\x3d"+encodeURIComponent(h);d&&(c=c+"\x26custPhoneNumber\x3d"+encodeURIComponent(d));
e&&(c=c+"\x26dhlPostNumber\x3d"+encodeURIComponent(e),m&&(c=c+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(m)));d=a.data.changeDetailUrl;f.isSPP()&&(d=a.$target.data("changedetailurl"),p("#cancelReminderPopover").click());f.isSPP()||(c+="\x26usePipelineDispatch\x3d1");l.show();d&&p.ajax({type:"POST",data:c,url:d,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,
c,d){b();l.hide();f.ajaxUpdatePage(a,c,d)},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",function(a){e()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",function(a){e()});a.declarative("clickedcancel","click submit",function(a){b()});a.on("a:popover:beforeShow:changeDetailPopover",function(a){g()&&p("#onblur-character-validation-error-changeNameInput").remove()});
a.on("a:popover:show:changeDetailPopover",function(a){if(!f.isSPP()){var b=p(q).width(),c=p(q).height(),b=parseInt(.6*b,10),c=parseInt(.7*c,10);d=a.popover.$popover;var g=a.popover;d.css("position","absolute");d.css("top","50px");d.css("height",c+"px");d.css("width",b+"px");g.updatePosition()}b=f.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");c=f.isSPP()?a.popover.originalcellphonevalue:a.popover.$trigger.data("original-cellphone-value");a=f.isSPP()?a.popover.originalpostnumbervalue:
a.popover.$trigger.data("original-postnumber-value");var g=p("#changeNameInput"),h=p("#changePhoneInput"),l=p("#changePostNumberInput");g.val(b);h.val(c);l.val(a);e()})});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",function(a,l,m,c,f,h){function g(){e("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action","prime-decline-element")}function b(a,b,e){if(e.getResponseHeader("x-amz-checkout-page"))c.ajaxUpdatePage(a,
b,e);else{a=m.jsonify(a);if(!a)return c.redirect();a.error?l.hide():a.errors?l.hide():a.autohandlererror?(b=(a=a.autohandlererror)?a.action:null,e=a&&a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError",q.location.href="fatal"===b?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+encodeURIComponent(e):"redirect"===b?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(e)):c.redirect(a)}}var e=a.$;e("html").hasClass("a-ie6")||
(a.declarative("prime-decline-element",["click","touchend"],function(a){h.protectAgainstDoubleAction("prime-decline-element")||(a.$event.preventDefault(),l.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+e("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+a,e.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",data:a,headers:{"Cache-Control":"no-cache",
pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:b,error:c.ajaxRedirect}))}),a.on("checkout:reload:spc",g),a.on("checkout:reload:spp-revieworder",g))});"use strict";r.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",function(a,l,m){function c(){h={};a.defer(function(){0!==f("#spc-orders").find(".prime-popover-link").length&&(f("#spc-orders").find(".prime-popover-link").each(function(){var a=
f(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var b=a.data("aCheckoutModalPopover");var c=b.name,l="";b.width&&b.height&&(l="width:"+b.width+"px;height:"+b.height+"px;");0<f("#spc-orders").find("#"+c+"-popover").length||(b=f(['\x3cdiv id\x3d"a-popover-'+c+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e','\x3cdiv id\x3d"'+c+'-popover" class\x3d"checkout" style\x3d"'+l+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),f("#spc-orders").append(b));a=a.data("aCheckoutModalPopover").name;
h[a]||(b=f(".prime-popover-content").html())&&0<b.length&&(h[a]=b,f("#"+a+"-popover").html(b))}}),f("#spc-orders").find(".a-box").each(function(){var a=f(this),b=a.find(".prime-ad-banner-content .prime-popover-link");1<b.length&&(b=b.first());a.find("a.primeAdLauncher").each(function(){var a=f(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');a.replaceWith(b.clone().text(a.text()).addClass("a-size-mini"))})}))})}
var f=a.$;if(!f("html").hasClass("a-ie6")){var h={};a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!h[a])){var b=f("input#primePopopverFallbackContent").val()||"";h[a]=b;f("#"+a+"-popover").html(b)}});a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)}});"use strict";r.when("A","page-transition-controller","back-button-protection","page-conductor","weblab-helper").register("place-order-controller",function(a,
l,m,c,f){function h(){if(!c.isAnimating()){var e=b("#spc-form");if("0"===b("#showPageTransition").attr("content"))if(e.hasClass("paylast-spc"))l.show();else{if(0<b("#enableAlternatePYOBlocker").length){var g=e.find(".a-button.continue-button");if("disabled"===g.find("input").attr("disabled"))return;g.find("input").attr("disabled","disabled");g.addClass("a-button-disabled");setTimeout(function(){g.removeClass("a-button-disabled");g.find("input").removeAttr("disabled")},4E4)}}else l.showPageTransition();
var d=b("#currencyChanged");0<d.length&&"true"===d.val()&&(d='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+b("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',b("#spc-form-inputs").append(d));if(f.isMfaPSD2DeviceDescriptionCollectionEnabled())for(var d=[{name:"javaEnabled",value:q&&q.navigator&&q.navigator.javaEnabled()},{name:"language",value:q&&q.navigator&&q.navigator.language},{name:"screenColorDepth",value:q&&q.screen&&q.screen.colorDepth},{name:"screenHeight",
value:q&&q.screen&&q.screen.height},{name:"screenWidth",value:q&&q.screen&&q.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}],h=0;h<d.length;h++)if(d[h].name!==F&&d[h].value!==F){var r='\x3cinput type\x3d"hidden" name\x3d"'+d[h].name+'" value\x3d"'+d[h].value+'" /\x3e';b("#spc-form-inputs").append(r)}0==e.find("input[type\x3d'hidden'][name\x3d'placeYourOrder1']").length&&e.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");(d=a.state("firetv-aws-attributes"))&&
d.queryParams&&(h=e.attr("action"),h+=0<=h.indexOf("?")?"\x26":"?",h+=b.param(d.queryParams),e.attr("action",h));c.isSPP()&&e.append(b("#subtotalsSection").find("input").hide());m.markAsDirty();e.submit()}}function g(a){a.preventDefault();h(a.target)}var b=a.$;if(!b("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){h(a.target)}),b(document).delegate("span.place-order-button-link","click",g),{placeOrderClick:h,placeOrderClickDelegate:g,PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});
"use strict";r.when("A","page-conductor","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,l,m,c,f){function h(a){x?g(a):b(a);z&&a&&a.blocking&&(c.setmarker("fn"),z=!1)}function g(a){var b=B(".continue-button"),c=B(".continue-button-blocker"),e=B(".place-order-blocker-message.custom-blocker-message");if(a.blocking||!d())a.blocking?(e.text(a.message),b.addClass("aok-hidden"),c.removeClass("aok-hidden")):(e.empty(),b.removeClass("aok-hidden"),
c.addClass("aok-hidden"),r.when("a-tooltip").execute(function(a){(a=a.get(c))&&a.isActive()&&a.hide()}))}function b(a){a.blocking?m.show("place-order-imb-checks",a.message):(m.hide("place-order-imb-checks"),B("#hasTVNavigation").length&&r.when("a-tv").execute(function(a){a.select(".continue-button")}))}function e(){var b,d={blocking:!1,message:""};if(x)b=B("#spc-imb").find(".verification-checkbox input:not(:checked)"),0<b.length&&(d={blocking:!0,message:b.first().closest(".verification-checkbox").attr("data-blocker-message")});
else{c.increaseCount("removeauijs23");if(!B("#spc-imb").find(".verification-checkbox").length)return;b=l.isSPP()?B("#spc-imb").find(".verification-checkbox input:not(:checked)"):B("#spc-imb").find(".verification-checkbox:not(:checked)");0<b.length&&(d={blocking:!0,message:l.isSPP()?b.first().closest(".spp-panel").hasClass("aok-hidden")?b.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):b.first().closest(".verification-checkbox").data("blocker-message"):b.first().attr("data-blocker-message")})}f.isPyoClientSideInitiationEnabled()?
h(d):a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",d)}function p(){var a=B("#wineNoticeCheckbox");a&&a.length&&(t?(a.attr("checked",""),w&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),w&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))))}function d(){var a=
B("input[name\x3disINExpressCheckoutCC]");return a&&a.length?1===parseInt(a.val(),10):!1}function n(){f.isPyoClientSideInitiationEnabled()||p();B('[data-client-component\x3d"PrimaryActionBlockerCheckbox"]').length||(e(),f.isPyoClientSideInitiationEnabled()&&p());var a=q.P&&q.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";B("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",e)}var B=a.$,t,w=B("html").hasClass("a-touch"),
x=!l.isSPP()&&q.P&&q.P.AUI_BUILD_DATE,z=!0;if(!B("html").hasClass("a-ie6")){if(!f.isPyoClientSideInitiationEnabled())a.on("checkbox:primaryActionBlocker:blockingStateChanged",h);a.declarative("change-wine-notice-checkbox",["change"],function(a){t=a.$target.is(":checked")?1:0});a.on("checkout:reload:spc",n);a.on("checkout:reload:spclite",n);a.on("checkout:reload:spp-revieworder",n);a.on("checkout:reload:spp-collapsed",n);a.on("checkout:unload",function(){z=!0});a.on("checkout:afterReload",function(){z=
!1});return{verifyCheckboxes:e,updatePyo:h}}});"use strict";r.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,l,m,c,f,h,g,b,e,p,d,n){function B(){X=V=!1;a.defer(function(){var a=G("#spc-orders");a.find("a.quantity-change-button-static").remove();"1"!==G("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&
a.find("div.quantity-value-static").remove()});G(".lineitem").each(function(a,b){a=G(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var b=G("#pantry-mov-popover-content"),c=G("#pantry-mov-popover-placeholder");!b.length&&c.length&&(b=c.attr("data-device"),G.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",
data:"device\x3d"+b,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,e){~a.indexOf("pantry-mov-popover-content")?c.append(a):d.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,b,c){d.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+c,1)}}))}function t(a,b){a=G('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+
b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function w(a,b,k){var g=
k.getResponseHeader("x-amz-checkout-new-cart-quantity");e.updateCartByMash(g);if(k.getResponseHeader("x-amz-checkout-page"))f.ajaxUpdatePage(a,b,k,{pushNewFrame:"false"}),a=k.getResponseHeader("x-amz-checkout-updated-itemid"),k=k.getResponseHeader("x-amz-checkout-quantity-error"),a&&k&&t(a,k);else if(a=c.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)z(a.errors.pantry.showAddonInfo);else{if(a&&a.errors&&a.errors.addon&&(f.isSPP()&&d.increaseCount("checkout:spp-revieworder:addon_warn_pri",
1),k=a.errors.addon.type,b=a.errors.addon.asins,x(),G(".item-list").hide(),b.forEach(function(a){G('[data-asin\x3d"'+a+'"]').show()}),k=G("#addon-warning-"+k+"-launcher"),k.length)){G("input[name\x3duseLiveAUI]").length?p.get(k).attrs({$trigger:ca}).show():ia&&G("div.checkout.spc-mobile.aui-templatized").length?k.click():(d.increaseCount("removeauijs19"),a=G.Event("keyup",{triggerPositioningElement:ca,manualTrigger:!0}),k.trigger(a),0<G("div.spc-mobile").length&&(m.scrollToTop(),m.toggleScrollOff()));
l.hide();return}return f.redirect(a)}else f.redirect()}function x(){G("#a-popover-addon-warning-normal .select-address-title").hide();0<L?(G("#a-popover-addon-warning-normal .reduce-title").show(),G("#a-popover-addon-warning-normal .delete-title").hide()):(G("#a-popover-addon-warning-normal .delete-title").show(),G("#a-popover-addon-warning-normal .reduce-title").hide())}function z(a){var b=G("#pantry-mov-popover-launcher"),c=G(".pantry-mov-reduce-prompt"),e=G(".pantry-mov-delete-prompt"),k=G("#pantry-mov-addon-info-container");
b.length?(Q()||d.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),k.length&&k.empty(),a&&G("#addon-warning-normal-popover-content").length&&(x(),k.length||(k=G("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),k.append('\x3chr class\x3d"a-divider-normal"\x3e').append(G("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<L?(c.show(),e.hide()):(e.show(),c.hide()),b.length&&(b.click(),l.hide())):(d.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",
1),f.redirect())}function k(a,b){l.show();var c={isClientTimeBased:G('input[name\x3d"useCtb"]').val(),fromAnywhere:G("input[name\x3dfromAnywhere]").val(),success:w};if(b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);f.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=G("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):G(".spc-mobile.aui-templatized").length&&(c.ref="ox_spc_change_quantity");b=G("#addon-indicator")&&"true"===G("#addon-indicator").attr("data-has-addon-items");
d=G("#pantry-mov-indicator")&&"true"===G("#pantry-mov-indicator").attr("data-has-pantry-items");a||!b&&!d||(c.istrial=1);h.call(Z,L,c);H?H.data("currentQuantity",L):U&&U.data("currentQuantity",L)}function u(){l.hide();q.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function I(a){var b=W;L=W;H&&r.when("a-dropdown").execute(function(a){H&&(a.getSelect(H).setValue(b.toString()),H.data("currentQuantity",L))});a===C.addOn&&m.toggleScrollOn();U&&(U.val(b),U.data("currentQuantity",L),
a=U.closest(".quantity-block"),a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),a.find(".dynamic-quantity-update").hasClass("stay-visible")||a.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden"))}function v(a,b){var c=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");Z=c.data("entityId");L=0;H=null;W=c.data("currentQuantity");
ca=G("a.quantity-delete-button[data-entity-id\x3d'"+Z+"']");ca.length||(ca=a.$currentTarget);U=c.closest(".dynamic-quantity-update").find(".quantity-input");U.length||(U=null);c.data("isBundleDelete")?G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):n.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&c.data("showItemAssocDeletePopover")?(d.increaseCount("checkout:item-association:delete:selected",1),setTimeout(function(){G("#ia-delete-trigger-"+c.data("itemAssocGroupId")).trigger("click")},
100)):(k(!1,b),g.hideById(c.closest(".a-popover").data("aPopoverId")))}function E(a){if(!e.protectAgainstDoubleAction("order-summary-update-quantity",200)){d.resetMetrics();var b=a.$currentTarget,c=b.closest(".lineitem"),f=b.find("select"),h=f.length?f:b;Z=c.data("entityId");f=G('.update-quantity-error[data-itemid\x3d"'+Z+'"]');U=H=null;h.is("select")?(H=b.find("select"),L=h.val()):(U=c.find(".quantity-input"),L=U.val());W!==L&&(ca=h.is("select")?H.parent():U,""===L?F(c):"Delete"===L||0===parseInt(L,
10)?(a.$event.preventDefault(),e.protectAgainstDoubleAction("delete-item")||(c=a.$currentTarget.closest(".lineitem"),Z=c.data("entityId"),L=0,c.data("isBundleDelete")?G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):(k(!1,void 0),g.hideById(c.closest(".a-popover").data("aPopoverId"))))):(a=parseInt(G("#quantity-input-max-value").val(),10),e.validateNumber(L,0,a)?(f.hide(),c.blur(),c.data("isBundleDelete")?G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):k(!1)):t(Z,
"changeQuantity_quantityNotInRange")))}}function A(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),d=a.$currentTarget.find("input").data("currentQuantity");W=d;-1===parseInt(c,10)||""===c?("change"===a.type&&F(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()}function F(a){a.find(".quantity-input").val(W)}function T(b,c,e){var f=c.data("itemAssocGroupId"),
k="a:sheet:beforeShow:ia-delete-mbs-"+f,g="a:sheet:afterHide:ia-delete-mbs-"+f;a.on(k,function O(b){b=b.sheet.getContentContainer();var c=G("#ia-delete-"+f).html();c&&(b.empty(),b.html(c));a.off(k,O)});r.when("a-dropdown").execute(function(c){a.on(g,function oa(){d.increaseCount("checkout:item-association:delete:canceled",1);G("#ia-delete-trigger-"+f).data("isItemAssocAlreadyDeleted")||(L=e,H.data("currentQuantity",e),c.getSelect(b).setValue(e));a.off(g,oa)})});G("#ia-delete-trigger-"+f).trigger("click")}
function Q(){return f.isSPP()?G("#revieworder").hasClass("expanded")?!0:!1:0<G("div.spc").length?!0:!1}var G=a.$;if(!G("html").hasClass("a-ie6")){var L,W,Z,H,U,V=!1,X=!1,ca,ia=q.P&&q.P.AUI_BUILD_DATE,C={addOn:"addOn",pantryMOV:"pantryMOV"};a.declarative("change-quantity",["click","touchend"],function(a){if(!e.protectAgainstDoubleAction("lock-update-quantity",200)){a=a.$currentTarget;var b=!0;a.addClass("hidden");a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");
a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=G(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",function(a){13===a.which&&a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",function(a){13!==a.which||b||G(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});
setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){e.protectAgainstDoubleAction("order-summary-get-quantity",200)||a.$currentTarget.find("select").length&&(W=a.$currentTarget.find("select").val())});a.declarative("order-summary-update-quantity",["change"],E);a.declarative("order-summary-update-quantity-text-field",["click","touchend"],E);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),
E(a)):e.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],A);a.declarative("trigger-update-quantity-button",["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});a.declarative("toggle-update-quantity-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),c=a.$currentTarget.find("input"),
d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",["click","touchend"],function(a){d.resetMetrics();a=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");var b=a.closest(".quantity-block"),c=a.closest(".dynamic-quantity-update"),f=c.find(".quantity-input");c.length||(f=b.find(".quantity-input"));if(e.protectAgainstDoubleAction("lock-update-quantity",200))f.focus();else{var g=f.val();
Z=a.data("entityId");var h=G('.update-quantity-error[data-itemid\x3d"'+Z+'"]'),l=parseInt(G("#quantity-input-max-value").val(),10);e.validateNumber(g,0,l)?(h.hide(),c.find(".a-form-error").removeClass("a-form-error"),f.removeClass("a-form-error"),g=parseInt(g,10),U=f,W=U.data("currentQuantity"),W=parseInt(W,10),g===W?(b.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),b.find(".quantity-display").removeClass("hidden"),b.find(".quantity-display-block-tablet").removeClass("hidden"),
c.addClass("hidden").children().addClass("hidden")):(L=g,ca=a,a.blur(),a.data("isBundleDelete")?G("#pb-delete-trigger-"+a.data("bundleGroupId")).trigger("click"):k(!1))):t(Z,"changeQuantity_quantityNotInRange")}});G(document).delegate(".spc-quantity-dropdown","change",function(a){H=G(a.currentTarget);d.resetMetrics();ia?(a=H.next(),Z=a.data("entityId"),W=a.data("currentQuantity")):(d.increaseCount("removeauijs21"),Z=H.data("entityId"),W=H.data("currentQuantity"));a=H.find(":selected");L=parseInt(a.val(),
10);if(W!==L){var b=G("#toggleDropdownQuantityTrigger");b.length&&L===parseInt(b.val(),10)?(a=H.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(ca=H.parent(),H.blur(),a&&a.data("isBundleDelete")?G("#pb-delete-trigger-"+a.data("bundleGroupId")).trigger("click"):n.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&a&&a.data("showItemAssocDeletePopover")||k(!1))}});a.on("a:dropdown:select",function(a){if(n.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&
(a=G(a.nativeItemNode))&&a.data("showItemAssocDeletePopover")){d.increaseCount("checkout:item-association:delete:selected",1);var b=a.closest("select"),c=ia?b.next().data("currentQuantity"):b.data("currentQuantity");T(b,a,c)}});a.declarative("item-assoc-delete-confirm",["click","touchend"],function(a){if(!e.protectAgainstDoubleAction("item-assoc-delete-confirm")){d.increaseCount("checkout:item-association:delete:confirmed",1);k(!1);var b=G(a.$target).data("itemAssocGroupId");G("#ia-delete-trigger-"+
b).data("isItemAssocAlreadyDeleted",1);r.when("a-sheet").execute(function(a){var c=a.get("ia-delete-mbs-"+b);c&&a.hideSheet(c)})}});a.declarative("item-assoc-delete-cancel",["click","touchend"],function(){e.protectAgainstDoubleAction("item-assoc-delete-cancel")||(d.increaseCount("checkout:item-association:delete:canceled",1),L=W)});a.declarative("dont-delete-item",["click","touchend"],function(a){a.$event.preventDefault();e.protectAgainstDoubleAction("dont-delete-item")||g.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});
a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();e.protectAgainstDoubleAction("delete-item")||v(a)});a.declarative("delete-prime-membership-item-confirm",["click","touchend"],function(a){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b={additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};v(a,b)}});a.declarative("bundle-delete",
["click","touchend"],function(){e.protectAgainstDoubleAction("bundle-delete")||k(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){e.protectAgainstDoubleAction("bundle-delete-action")||(r.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),k(!1))});a.declarative("egc-delete",function(a){Z=a.entityId;L=0;k(!0)});a.declarative("bundle-dont-delete",["click","touchend"],function(){e.protectAgainstDoubleAction("bundle-dont-delete")||(L=W,r.when("a-dropdown").execute(function(a){H&&
(a.getSelect(H).setValue(W.toString()),H.data("currentQuantity",L))}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){e.protectAgainstDoubleAction("pantry-return-to-cart-btn")||Q()&&u()});a.declarative("pantry-delete-items-btn",["click","touchend"],function(){!e.protectAgainstDoubleAction("pantry-delete-items-btn")&&Q()&&(X=!0,G(".a-button-close").trigger("click"),k(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){e.protectAgainstDoubleAction("pantry-cancel-delete-btn")||
Q()&&I(C.pantryMOV)});a.on("a:popover:hide:pantry-mov-popover",function(){Q()&&(X||I(C.pantryMOV))});a.declarative("addon-return-to-cart",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-return-to-cart")||Q()&&u()});a.declarative("addon-delete-items",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-delete-items")||(Q()&&(V=!0,G(".a-button-close").trigger("click"),k(!0)),f.isSPP()&&d.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",
["click","touchend"],function(){e.protectAgainstDoubleAction("addon-dont-delete")||(Q()&&I(C.addOn),f.isSPP()&&d.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",function(){0<G("div.spc-mobile").length?u():Q()&&(V||I(C.addOn))});a.on("a:popover:hide:addon-warning-special",function(){Q()&&(V||I(C.addOn))});a.on("checkout:reload:spc",B);a.on("checkout:reload:spp-revieworder",B)}});r.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",
function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var m=a.popover.$popover,c=m.closest("div.a-dropdown");c.length&&(a.popover.$iframe.css("max-height","260px"),m.css("max-height","260px"),m=c.find("div.a-popover-inner"),m.css({"max-height":"260px"}),a.popover.updatePosition(),m.css({"overflow-y":"scroll"}))}})});"use strict";r.when("A","page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,l,m,c){function f(a,e,f){return f.getResponseHeader("x-amz-checkout-page")?
m.ajaxUpdatePage(a,e,f,{pushNewFrame:"false"}):(a=c.jsonify(a))?m.redirect(a):m.redirect()}function h(a,c){var h=c.$target.data("entityId");if(h){l.show();var d={isClientTimeBased:g('input[name\x3d"useCtb"]').val(),fromAnywhere:g("input[name\x3dfromAnywhere]").val()},d=d||{};c={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};g.extend(c,d);c.entityId=h;c.optOut=a;a=m.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});g.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",
data:g.param(c),dataType:"text",async:!0,cache:!1,headers:a,success:f,error:m.ajaxRedirect})}else q.ueLogError&&q.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",logLevel:"FATAL"})}var g=a.$;g("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",["click","touchend"],function(a){h(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){h(!1,a)}))});"use strict";r.when("A").execute(function(a){return{}});
"use strict";r.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,l,m){function c(){var b=g(document);b.delegate(".sns-option","click",function(a){a=g(this);h(a.closest(".sns-upsell"),a)});b.delegate(".sns-option-mobile","click",function(a){var b=g(this);a.target.name&&"snsSetCreateSubscription"===a.target.name&&h(b.closest(".sns-upsell-mobile"),b)});b.delegate(".sns-option-tablet","click",function(a){a=g(this);h(a.closest(".sns-upsell-tablet"),
a)});b.delegate(".sns-upsell-nextdelivery","change",function(){f(g(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){f(g(a.$target))});b.delegate(".sns-upsell-learn-more","click",function(a){var b=g(this);a=b.width();var c=b.height(),f=b.position(),b=b.find(".sns-upsell-popover-learn-more");b.removeClass("aok-hidden");var h=b.width();b.height();b.css({top:f.top+c,left:f.left-(h-a)/2,position:"absolute"})});b.delegate(".sns-upsell-learn-more-close","click",function(a){(a=
g(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}function f(a){var c=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&c.length){var f=c.data("index"),d=c.find("span.sns-change-delivery-txt");d&&d.text(a.find("option:selected").data("date"));d=a.find("option:selected").data("epoch");a=a.find("option:selected").val();c.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+f+"']").val(d);
c.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+f+"']").val(a)}}function h(a,c){l.show();var f=a.data("index"),d=(new Date).getTime(),h=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+f+"']").attr("value"),q=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+f+"']").attr("value"),t=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+f+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+f+"']").attr("value");c=c.prop("checked")||c.find("[type\x3dcheckbox]").is(":checked");
d={returnpipedata:0,returnFullHTML:1,cachebuster:d,hasWorkingJavascript:1};d.lineItemIdentifier=h;d.isONMLSelected=c?1:0;d.merchantId=q;d.asin=t;d.frequency=a;h=m.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});g.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",data:g.param(d),dataType:"text",async:!0,cache:!1,headers:h,success:function(a,b,c){return m.ajaxUpdatePage(a,b,c)},error:function(a,b,c){m.ajaxRedirect(a,b,c)}})}var g=a.$;g("html").hasClass("a-ie6")||c()});"use strict";
r.when("A","page-detector","page-detector-current-page","page-conductor","page-transition-controller","ajax-utility","place-order-controller","client-side-metrics").execute(function(a,l,m,c,f,h,g,b){function e(a){"function"===typeof q.ues&&(q.ues("t0",a,new Date),q.ues("ctb",a,"1"));"function"===typeof q.uet&&q.uet("tc",a,{wb:1})}function p(a,b){"function"===typeof q.uet&&q.uet(a,b,{wb:1})}function d(a){q.ueLogError&&q.ueLogError({message:a},{logLevel:"WARN",attribution:"ajax-typ"})}function n(){var a=
E("span#typ-load").attr("data-typ-args");q.location.href="https://"+q.location.hostname+"/gp/buy/thankyou/handlers/display.html?"+a}function r(){p("cf","ajax-typ:place-your-order");if(H){var a=E("#typ-desktop-frame").contents(),c=H;if(c.deliveryestimates)for(var d in c.deliveryestimates)if(c.deliveryestimates.hasOwnProperty(d)){var e=a.find("span#"+d);e&&e.replaceWith(c.deliveryestimates[d])}c.autorip&&(a=a.find("#thank-you-rogue"))&&a.replaceWith(c.autorip)}c=E("#typ-desktop-frame").contents();a=
c.find("span#typ-rewrite-url");history&&history.pushState&&a&&0<a.length&&(history.pushState({},"",a.attr("data-url")),a.attr("data-view"));c=c.find("title").text();E("#checkoutDisplayPage").hide();E("#typ-desktop").show();document.title=c;f.hide();E("span#typ-load").attr("data-typ-args");p("be","ajax-typ:place-your-order");b.setmarker&&(c=b.getscope(),V&&b.setscope("ajax-typ"),b.setmarker("cf"),V&&b.setscope(c));V||(b.sendUEPageLoadStats(),"function"===typeof q.uex&&q.uex("ld","ajax-typ:place-your-order",
{wb:1}))}function t(a,b,e){a&&a.conductoraction&&a.conductoraction.url?c.redirect(a):(p("af","ajax-typ:place-your-order"),H=a,Q?r():F?G=1:(d("No TYP data available after place-order, redirecting to static TYP"),n()))}function w(){if(!ia)if(ca&&clearTimeout(ca),3===X.readyState){var a;try{a=h.jsonify(X.responseText)}catch(b){a=null}null!==a?(ia=1,t(a)):ca=setTimeout(w,50)}else 4===X.readyState&&(ia=1,200===X.status?(a=h.jsonify(X.responseText),null!==a?t(a):(d("No results from place-order, calling ajaxRedirect"),
c.ajaxRedirect())):(d("Error calling place-order, calling ajaxRedirect"),c.ajaxRedirect()))}function x(){T=1;W&&clearTimeout(W);Z&&clearTimeout(Z);var a=E("#currencyChanged");0<a.length&&"true"===a.val()&&(a='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+E("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',E("#spc-form-inputs").append(a));E("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a=(new Date).getTime()-
C;E("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'waitingTime' value\x3d'"+a+"' /\x3e");E("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'returnjson' value\x3d'1' /\x3e");aa&&E("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'isAsyncTYPEnabled' value\x3d'1' /\x3e");var a=E("#spc-form").serialize(),b=E("#typ-desktop-frame").contents().find("input#cached-promise-data");0<b.length&&(a+="\x26cachedPromiseData\x3d"+b.val());if(U){if(q.XMLHttpRequest)X=new XMLHttpRequest;else if(q.ActiveXObject)try{X=
new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){X=null}if(!X){d("Can't get XMLHttpRequest for data stream, calling standard placeOrderController");T=1;g.placeOrderClick();return}X.open("POST","/gp/buy/spc/handlers/place-your-decoupled-order.html",!0);X.setRequestHeader("Content-type","application/x-www-form-urlencoded");X.setRequestHeader("Content-length",a.length);X.setRequestHeader("Connection","close");X.onreadystatechange=w;X.overrideMimeType("text/plain");X.send(a)}else E.ajax({type:"POST",
url:"/gp/buy/spc/handlers/place-your-decoupled-order.html",data:a,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return h.jsonify(a)},success:function(a,b,e){null!==a?t(a,b,e):(d("No results from place-order, calling ajaxRedirect"),c.ajaxRedirect())},error:function(a,b,e){d("Error calling place-order, calling ajaxRedirect");c.ajaxRedirect(a,b,e)}});"function"===typeof q.uet&&q.uet("bb","ajax-typ:place-your-order",{wb:1})}function z(){Q=F=L=0;E("div#typ-desktop").empty()}function k(a,c,d){L||
(L=1,clearTimeout(Z),F=0,Q=1,A++,(a=E("#typ-desktop-frame").contents().find("span#typ-rewrite-url"))&&0<a.length&&(a=a.attr("data-requestid"),e("ajax-typ:place-your-order"),V||(b.setAsyncRequestId(a),"function"===typeof q.ues&&q.ues("id","ajax-typ:place-your-order",a))),G?r():!T&&5>A&&(W=setTimeout(function(){z();u()},12E4)))}function u(){if(!(T||F||5<=A)){F=1;var a=E("span#typ-load").attr("data-typ-args");Z=setTimeout(function(){z();G&&(d("Timed out waiting for TYP fetch after place-order, redirecting to static TYP"),
n())},45E3);E("\x3ciframe /\x3e",{name:"typ-desktop-frame",id:"typ-desktop-frame",width:"100%",height:"100%",frameborder:"0",src:"/gp/buy/thankyou/handlers/display.html?"+a}).appendTo("div#typ-desktop").load(k)}}function I(){k()}function v(){l.isSpc()&&0<E("span#typ-load").length&&(C=(new Date).getTime(),A=0,E("div#typ-desktop").length?z():E("body").append('\x3cdiv id\x3d"typ-desktop" style\x3d"position:absolute;left:0;right:0;bottom:0;top:0;display:none;"\x3e\x3c/div\x3e'),U=E("span#typ-load").attr("data-early-json-flush")&&
!E("html").hasClass("a-lt-ie10"),aa=0<E("span#async-typ-enabled").length,V=E("span#typ-load").attr("data-use-cds-stub"),E(document).undelegate("span.place-order-button-link","click"),E(document).delegate("span.place-order-button-link","click",function(a){a.preventDefault();V?(a=b.getscope(),b.setscope("ajax-typ"),b.setctb(),b.resetue(),b.setmarker("tc"),b.setscope(a)):(b.resetMetrics(),b.setmarker("tc"));F||Q?(f.show(),x()):(T=1,g.placeOrderClick())}),u())}var E=a.$;if(!E("html").hasClass("a-ie6")){var A=
0,F=0,T=0,Q=0,G=0,L=0,W,Z,H,U=0,V=0,X,ca,ia=0,C=0,aa=0;a.on("ajax-typ-cf",I);a.on("checkout:reload:spc",v);a.on("checkout:reload:spp-revieworder",v);a.on("checkout:reload:spclite",v)}});"use strict";r.when("A","client-side-metrics").register("trialSignPrefetchCommon",function(a,l){function m(){c()&&(d().val(0),l.increaseCount("TrialSign:js:activated"),f(),t!==F&&p(),t=a.interval(e,5E4),r=0)}function c(){return 0!==d().length&&0!==n("input[name\x3d'purchaseID']").length}function f(){q!==F&&q.abort();
q=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:n("input[name\x3d'purchaseID']").val()},success:h,error:g,abort:b})}function h(a,b,c){d().val(a.signPurchaseTrialId);q=F;l.increaseCount("TrialSign:js:success")}function g(a,b,c){p();q=F;l.increaseCount("TrialSign:js:failed")}function b(){p();q=F;l.increaseCount("TrialSign:js:aborted")}function e(){r++;10<r?p():(l.increaseCount("TrialSign:js:retry"),l.increaseCount("TrialSign:js:retry:"+r),f())}function p(){t!==
F&&(clearInterval(t),t=F)}function d(){return n("input[name\x3d'trialSignId']")}var n=a.$,q,t,r=0;a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m);a.on("checkout:billing-address-update",m);return{makeTrialSignCall:f,trialSignCallSucceeded:h,isTrialSignActivated:c}});"use strict";r.when("A","page-transition-controller","client-side-metrics","page-conductor").register("recurring-delivery-line-item",function(a,l,m,c){function f(a,b,c){if("undefined"===typeof a)throw m.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:JSFailure:VariableUndefined:"+
b,1),c.show(),Error("Provided variable is undefined");c.hide()}function h(a,h,d){f(a,"updateRecurrencePeriod",h);f(a.lineItemId,"updateRecurrencePeriod-lineItemId",h);var n=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});g.ajax({type:"POST",url:"/gp/buy/spc/handlers/update-recurrence-period.html",data:{recurrencePeriod:b,encodedLineItemEntityId:a.lineItemId,relatedRequestId:a.relatedRequestId},dataType:"json",cache:!1,headers:n,success:function(a,b){m.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+
b,1);g("#b2brd-frdd").text(a.firstRecurringDeliveryDate);d.hide();h.hide();l.hide()},error:function(b){m.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+b,1);g("#b2brd-cadence-selector").find(".a-dropdown-prompt").text(a.selectedRecurrencePeriodDisplayString);d.hide();h.show();l.hide()}});l.show()}var g=a.$,b;a.declarative("b2brd-cadence-dropdown-change","change",function(a){var c=g("#update-recurrence-period-error"),d=g("#update-recurrence-period-link");f(a,"b2brd-cadence-dropdown-change",
c);a=a.$event.target.value;f(a,"handleDropdownChange",c);d.show();b=a});a.declarative("update-recurrence-period","click",function(a){var b=g("#update-recurrence-period-error"),c=g("#update-recurrence-period-link");f(a,"update-recurrence-period",b);h(a.data,b,c)});a.declarative("update-recurrence-period-mobile","change",function(a){var c=g("#update-recurrence-period-error"),d=g("#update-recurrence-period-link");f(a,"update-recurrence-period-mobile",c);var l=a.$event.target.value;f(l,"handleDropdownChange",
c);d.show();b=l;h(a.data,c,d)})});"use strict";r.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",function(a,l,m,c,f,h,g){function b(){for(var b=function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},c=0;20>c;++c)setTimeout(b,100*c)}function e(a,c){setTimeout(function(){var d=h.prepare(a);d&&t("#spclite-items-operation").show();t("#spclite-items-header-dynamic").fadeIn(c?
0:300,function(){d&&t("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=t(this).attr("view-name");a&&t(this).find("a").click(function(){l.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+a,1);h.switchToView(a);t("#spclite-items-operation").fadeOut(c?0:300);b()})})})},c?0:800)}function p(b,c,d){if(b&&t.isArray(b))for(var e=!1,f=0;f<b.length;f++){var g=b[f];if(g.identifier&&g.content){var h=t("#"+c+"-"+g.identifier);h&&0!==h.length?a.slideDown(h.html(g.content),
d?0:500,"ease-out",function(){}):(l.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(l.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function d(c,d){if(c.presentCVs&&0<c.presentCVs.countOfCVs)n();else{c.orderSummaryHTML&&(a.fadeOut(t("#order-summary-footer"),d?0:250,"ease-out"),a.fadeOut(t("#spc-order-summary"),d?0:250,"ease-out",function(){t("#spc-order-summary").replaceWith(c.orderSummaryHTML).hide();c.additionalOrderSummaryHTML&&t("#order-summary-footer").html(c.additionalOrderSummaryHTML);
a.fadeIn(t("#spc-order-summary"),d?0:400,"ease-out");a.fadeIn(t("#order-summary-footer"),d?0:400,"ease-out")}));c.freshDeliveryMessageHTML&&(t("#lazy-fresh-promise-delivery-message").html(c.freshDeliveryMessageHTML),a.slideDown(t("#lazy-fresh-promise-delivery-message"),d?0:500,"ease-out"),g.spcLiteLazyLoadFastTrack());p(c.itemToPrimeMembershipDelivery,"lazy-membership-delivery",d);p(c.itemToGiftContentMapping,"lazy-gift-options",d);p(c.itemToShipOfferingMapping,"lazy-ship-method",d);p(c.itemToPromise,
"lazy-promise",d);c.freshDeliverySlotInformationHTML&&(t("#lazy-fresh-delivery-slot-information").html(c.freshDeliverySlotInformationHTML),a.slideDown(t("#lazy-fresh-delivery-slot-information"),d?0:250,"ease-out"));c.freshDeliveryInstructionsHTML&&(t("#lazy-fresh-delivery-instructions").html(c.freshDeliveryInstructionsHTML),a.slideDown(t("#lazy-fresh-delivery-instructions"),d?0:250,"ease-out"));if(c.itemToPromoMapping&&t.isArray(c.itemToPromoMapping))for(var f=t("#items-block"),h=0;h<c.itemToPromoMapping.length;h++){var l=
c.itemToPromoMapping[h];"lightningdeal"===l.type?f.find(".lazy-lightning-promo-details-"+l.identifier).removeClass("aok-hidden"):"promotion"===l.type&&f.find(".lazy-promo-details-"+l.identifier).removeClass("aok-hidden")}c.freeShippingId&&t("#"+c.freeShippingId).removeClass("aok-hidden");t("input#isOrderSummaryReady").val(1);e(c.itemGroupData,d);b()}}function n(){var b=t("#spclite-block-order-place-message").html()||"";c.show("disabled-order-place",b);c.lock();f.create({name:"disabled-order-place",
content:b});f.lock();var d=c.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){f.unlock();c.unlock();f.destroy();t("#a-popover-"+d).remove()})}function r(a){if(a&&a.data){var b;try{b=q.atob(a.data)}catch(c){return l.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",1),null}if((b=m.jsonify(b))&&!t.isEmptyObject(b))return b}return null}var t=a.$,w,x=function(a,b){function c(){if(f&&0!==f.length){for(var a="",b=0;b<d%3+1;b++)a+=".";f.html(a);d++}}var d=0,e,f;this.start=
function(){b&&b.useTextAnimate&&(d=0,f=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),f&&0<f.length&&f.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};a.on("checkout:reload:spclite",function(){if("1"===t('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=r(q.__spcliteFinalResultsData);if(a){d(a,!0);return}}else if(q.__spcliteFinalResultsData){d(q.__spcliteFinalResultsData,
!0);return}var a="",b=t("input#executionId").val();b&&(a+="executionId\x3d"+b);return t.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){w=new x(t("#spclite-order-summary-loading-indicator"),{showTextAlways:!0});w.start();q.uet&&q.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,b,c){a=m.jsonify(a);"1"===t('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?
(a=r(a))?d(a,!1):n():a&&!t.isEmptyObject(a)?d(a,!1):n()},error:function(a,b,c){n()},complete:function(a){w.stop();q.uex&&q.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){q.__spcliteFinalResultsData=F})});"use strict";r.when("A","client-side-metrics").register("spclite-items-viewer",function(a,l){function m(){var a=f("#spclite-items-block").find(".spclite-item-detail");a&&0<a.length&&(g={},a.each(function(a){a=f(this).attr("entity-id");
g[a]=f("\x3cp\x3e\x3c/p\x3e").append(f(this).clone().removeClass("a-span-last")).html()}))}function c(a,c){if(!c||0===c.length)return null;a=f('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var h=c;c=[];for(var d=[],l=0;l<h.length;l++){var m=h[l];if("normal"!==m.type)d.push(m);else{for(var t=0;t<c.length;)if(m.data.destinationAddressId!==c[t].data.destinationAddressId)t++;else break;for(;t<c.length;)if(m.data.destinationAddressId===c[t].data.destinationAddressId&&
m.data.promise.starttime.dayepoch>c[t].data.promise.starttime.dayepoch)t++;else break;c.splice(t,0,m)}}for(h=0;h<d.length;h++)switch(m=d[h],m.type){case "primemembership":c.unshift(m);break;case "vas":case "digital":case "no-promise":case "exception":c.push(m);break;default:c.push(m)}for(d=0;d<c.length;d++){m=c[d];if(h=m.content)l='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',h.destination&&(l+='\x3cdiv class\x3d"row destination"\x3e'+h.destination+"\x3c/div\x3e"),h.promise&&(l+='\x3cdiv class\x3d"row promise"\x3e'+
h.promise+"\x3c/div\x3e"),l+="\x3c/div\x3e",a.append(l);a:if(h=m.items,g&&h&&0!==h.length){l="";for(t=0;t<h.length;t++){0===t%2&&(l+='\x3cdiv class\x3d"a-row"\x3e');var q=h[t].identifier;if(!g[q]){h=null;break a}q=f(g[q]);1===t%2&&q.addClass("a-span-last");l+=f("\x3cp\x3e\x3c/p\x3e").append(q).html();1===t%2&&(l+="\x3c/div\x3e")}1===h.length%2&&(l+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');h=l}else h=null;if(h)h=f(h),("no-promise"===m.type||"normal"===m.type&&
m.data&&m.data.promise&&"scheduled"!==m.data.promise.type)&&h.find(".spclite-promise").hide(),a.append(h);else return null;d<c.length-1&&a.append("\x3chr\x3e")}return a}var f=a.$,h,g;return{prepare:function(a){try{var e;a:{m();if(g){var f=c("order-by-delivery",a);if(f){h={"order-by-delivery":f};e=!0;break a}}e=!1}return e}catch(d){l.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,e){var g;h&&h[a]?g=h[a]:(l.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+
a,1),"order-by-delivery"===a&&(g=c(a,e)));if(g){var d=f("#spclite-items-block");d.find(".spclite-item-view").fadeOut(300,function(){d.empty();d.append(g.clone().hide());d.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";r.when("A","loading-spinner-controller").register("cpf-controller",function(a,l){function m(a){var c,g,b;if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,"");if(/(\d)\1{10}/.test(a))return!1;c=a.substring(0,9);g=a.substring(9);b=0;for(var e=
10;1<e;e--)b+=c.charAt(10-e)*e;if((2>b%11?0:11-b%11)!==g.charAt(0))return!1;c=a.substring(0,10);b=0;for(a=11;1<a;a--)b+=c.charAt(11-a)*a;return(2>b%11?0:11-b%11)!==g.charAt(1)?!1:!0}return!1}var c=a.$;a.on("checkout:reload:spp-taxid",function(){c("#useThresholdTaxIdService").length||c("#taxidForm").submit(function(){var a=c("#taxidregistration-imb");if(!m(c("#taxid-field").val()))return l.hideSpinner(c("#spinner-anchor"),!0),a.show(),!1;a.hide();return!0})})});"use strict";r.when("A","page-conductor",
"ready").register("taxid-threshold-controller",function(a,l){function m(){var a=c();l.isSPP()?a?(f("#taxid-continue-disabled").hide(),f("#taxid-continue-enabled").show()):(f("#taxid-continue-enabled").hide(),f("#taxid-continue-disabled").show()):a?f("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):f("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function c(){var a=!0,c=f("#taxIdForm");
c.length&&c.find('input[type\x3d"text"]').each(function(){var b=f(this);if(!b.val()||7>b.val().length)b.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var f=a.$;a.on("checkout:reload:spp-taxid",function(){if(f("#useThresholdTaxIdService").length){var a=f("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(m),a.find('input[type\x3d"checkbox"]').change(m));m()}})});"use strict";r.when("A","page-conductor","loading-spinner-controller","taxaddress-page-config",
"ready").register("taxaddress-controller",function(a,l,m,c){function f(){l.isSPP()&&(g(),b())}function h(){if(l.isSPP()){var a=d(t.taxregistrationnumberInputIdSelector).val();d(t.taxregistrationnumberInputIdSelector).val(a.replace(q,""));a=d(t.businesslegalnameInputIdSelector).val();d(t.businesslegalnameInputIdSelector).val(a.trim());g();b()}}function g(){if(t.isChewbaccaURL){var a=p(d(t.taxregistrationnumberInputIdSelector).val()),b=p(d(t.businesslegalnameInputIdSelector).val());a&&b?d(t.taxaddressFormIdSelector).attr("action",
t.formActionNonSifEncryptionUrl):d(t.taxaddressFormIdSelector).attr("action",t.formActionSifEncryptionUrl)}}function b(){var a=d("#taxid-continue-enabled"),b=d("#taxid-continue-disabled"),c;c=d(t.taxregistrationnumberInputIdSelector).val();var e=d(t.businesslegalnameInputIdSelector).val();if(p(c)&&p(e))c=!0;else{var e=!e||p(e.toString().trim()),f=p(d(t.taxaddressInputNameSelector).val());c=p(c)||!n.test(c)||e||f?!1:!0}c?(a.show(),b.hide()):(a.hide(),b.show());c=p(d(t.taxregistrationnumberInputIdSelector).val())&&
p(d(t.businesslegalnameInputIdSelector).val())?t.continueLabel:t.saveContinueLabel;a.find("span.a-button-text").text(c);b.find("span.a-button-text").text(c)}function e(){if(r)r=!1;else{var a=d(t.taxregistrationnumberInputIdSelector).val().trim(),b=d(t.businesslegalnameInputIdSelector).val().trim();if(!p(a)||!p(b)){var c={tax_registration_number:a,business_legal_name:b};d.ajax({type:"POST",url:t.sifEncryptionUrl,dataType:"json",data:c,success:function(a,b,e){p(c.tax_registration_number)?d(t.taxregistrationnumberInputIdSelector).val(""):
d(t.taxregistrationnumberInputIdSelector).val(a.sifEncryptedTaxId);p(c.business_legal_name)?d(t.businesslegalnameInputIdSelector).val(""):d(t.businesslegalnameInputIdSelector).val(a.sifEncryptedLegalName);r=!0;d(t.taxaddressFormIdSelector).submit()},error:function(a,b,d){console.log("[taxaddress-controller.js] Error while encrypting the input fields. Error Type: "+b+" tax_registration_number: "+c.tax_registration_number+" business_legal_name: "+c.business_legal_name)}});return!1}}}function p(a){return!a||
0===a.toString().length}var d=a.$,n=/^\d{11}$/,q=/\s+/g,t=c.getConfig(),r=!1;a.on("checkout:reload:spp-taxaddress",function(){d(t.taxregistrationnumberInputIdSelector).keyup(h).blur(h);d(t.businesslegalnameInputIdSelector).keyup(f).blur(h);d('input:radio[name\x3d"'+t.taxaddressInputName+'"]').each(function(){d(this).change(f)});t.isChewbaccaURL=-1!=t.formActionSifEncryptionUrl.indexOf("/checkout/p/p-");t.isChewbaccaURL||d(t.taxaddressFormIdSelector).submit(e);f()});return{getNewTaxAddressPopoverURL:function(){return t.newTaxAddressPopoverURL},
submitTaxAddressFormWithNewAddressId:function(a){d(t.newTaxaddressInputIdSelector).val(a);m.showSpinner(d(t.taxAddressPanelSelector),!1);d(t.taxaddressFormIdSelector).submit()}}});r.when("A","address-popovers","taxaddress-controller","ready").register("taxaddress-addresspopover-helper",function(a,l,m){l.actionRegisterTaxAddressController(m)});"use strict";r.when("A","page-spinner-controller","ajax-utility","page-conductor","client-side-metrics").execute(function(a,l,m,c,f){function h(){function e(a){if(!h)if(a.preventDefault(),
a=encodeURIComponent(g("#spc-deliverytipinput").val()),g("#tip-error").addClass("aok-hidden"),g("#tip-promo-success").addClass("aok-hidden"),g("#tip-success").addClass("aok-hidden"),g("#tip-ineligible").addClass("aok-hidden"),g("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)d("invalidDeliveryTip_NoAmount");else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){l.show();m=g("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var b=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+
m+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+g("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+b;b=c.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});g.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",data:a,headers:b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){h=!1;l.hide()},
success:f,error:c.ajaxRedirect});h=!1}else d("invalidDeliveryTip_NoAmount");else d("addDeliveryTip_NoAmount")}function f(a,b,c){l.hide()}function d(a){l.hide();g("#tip-error").removeClass("aok-hidden");0<g("div.spc-desktop").length?g("#spc-deliverytipinput").addClass("a-form-error"):g("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");g("#"+a).removeClass("aok-hidden")}var h=!1,m=0;b&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&
e(a.$event)}),b=!1)}var g=a.$;if(!g("html").hasClass("a-ie6")){var b=!0;a.on("checkout:reload:spc",h);a.on("checkout:reload:spclite",h)}});"use strict";r.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",function(a,l,m,c){function f(){if(!g||"function"!==typeof g)return"";var a=g(),c="";if(a)for(var f in a)if("number"===typeof a[f]||"string"===typeof a[f]||"boolean"===typeof a[f])c+="\x26__pagedata_"+f+"\x3d"+a[f];return c}var h=
a.$,g;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!l.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=h("#checkout-feedback-form"),a.length)){c.showSpinner(a,!1);var e=a.serialize(),e=e+f();h.ajax({type:"POST",url:a.attr("action"),data:e,dataType:"text",error:m.ajaxRedirect,success:function(a,b,c){b=c.getResponseHeader("checkout-feedback-submitted");h(".a-button-close").trigger("click");null!==b&&b!==F&&h("#checkout-feedback-banner").append(a)}})}});
return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(g=a)}}});"use strict";r.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector-current-page","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,l,m,c,f,h,g,b,e,p){function d(){function b(a){a=a.$currentTarget.closest(".delivery-instructions-block");a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");
var c=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");n("#deliveryInstructions").focus();n("#deliveryInstructions").select();n("#deliveryInstructions").keydown(function(a){10===a.which&&a.preventDefault()});n("#deliveryInstructions").keyup(function(){n("#delivery-instructions-left-text").hasClass("aok-hidden")&&n("#delivery-instructions-left-text").removeClass("aok-hidden");
var a=c-n(this).val().length;0>a&&(a=0);n("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function d(a){l.show();a=a.$currentTarget;var b=n("#deliveryInstructions").val(),c=a.closest(".delivery-instructions-block"),h=a.closest(".dynamic-delivery-instructions-update");c.find(".edit-delivery-instructions-link").removeClass("aok-hidden");c.find(".delivery-instructions-display").removeClass("aok-hidden");h.addClass("aok-hidden");c=(new Date).getTime();b="deliveryInstructions\x3d"+
encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+n("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+c;c=f.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":g.getCurrentPage()});n.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){l.hide()},success:e,error:f.ajaxRedirect});a.blur()}function e(a,b,d){(a=c.jsonify(a))&&!n.isEmptyObject(a)&&n("#deliveryInstructionsDisplay").html(a.deliveryInstructions);l.hide()}q&&(a.declarative("edit-delivery-instructions",["click"],b),a.declarative("update-delivery-instructions",["click"],d),q=!1)}var n=a.$;if(!n("html").hasClass("a-ie6")){var q=!0;a.on("checkout:reload:spc",d);a.on("checkout:reload:spclite",d);a.on("checkout:reload:spp-shipaddress",d);a.on("checkout:reload:spp-f3-sosp",
d);a.on("checkout:reload:spp-payment",d)}});"use strict";r.when("A","page-conductor","page-transition-controller").register("installments-service",function(a,l,m){var c=a.$;return{call:function(a,h,g){m.show();c.ajax({type:"POST",url:"/gp/buy/installments/handlers/set-item-installments.html/ref\x3dox_spc_inst_toggle",data:{itemId:a,programId:h},dataType:"text",async:!0,cache:!1,headers:l.setAjaxTransitionHeader(),success:g.success||null,error:g.error||null})},sendReftag:function(a){c.post("/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+
a)}}});"use strict";r.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service","client-side-metrics","widgets/installmentsModal/state","allow-installments-page-transition").register("installments-controller",function(a,l,m,c,f,h,g,b,e){function p(){a.defer(n)}function d(a,b,c){e.isEnabled?m.ajaxUpdatePage(a,b,c,{pushNewFrame:"true"}):(l.hide(),m.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}))}function n(){var a=q("#installments-button-blocker");
1===a.length&&(a=a.data("blocker-message"),f.show("place-order-installments-blocker",a))}var q=a.$;a.declarative("installments-sync-state",["change"],function(a){var c=q("#trigger-installments-modal"),e;if(c.length)if(b.$target=a.$target,b.bundleAsin=a.data.bundleAsin,b.asin=a.data.asin,b.itemId=a.data.itemId,b.isChecked=b.$target.is(":checked"),b.programId=b.isChecked?a.data.programId:"",a={success:d,error:m.ajaxRedirect},b.handlerData=a,e=b.isChecked?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",
b.isChecked)c=b.asin,a=b.bundleAsin,h.call(b.itemId,b.programId,b.handlerData),a?h.sendReftag("installments_toggle_on_asin_"+c+"_bundle_asin_"+a):h.sendReftag("installments_toggle_on_asin_"+c);else{a=b.itemId;var f=b.programId,k=b.handlerData,l=b.asin,n=b.bundleAsin;n&&c.length?(h.sendReftag("installments_toggle_off_asin_"+l+"_bundle_asin_"+n),c.click()):(h.sendReftag("installments_toggle_off_asin_"+l),h.call(a,f,k))}else c=a.data.itemId,f=(e=a.$target.is(":checked"))?a.data.programId:"",a={success:d,
error:m.ajaxRedirect},e=e?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",h.call(c,f,a);g.increaseCount(e)});a.declarative("page-transit-invalidate-ric","click",function(a){m.isAnimating()||(a.$event.preventDefault(),a=a.$currentTarget.closest("div.spp-panel"),l.shrinkPanel(a,!0),a={invalidate:!0,gurupaRicCSRFToken:q("#gurupaRicCSRFToken").val()},g.increaseCount("Checkout:RetailInstallmentContract:Invalidate"),q.ajax({type:"POST",url:"/gp/buy/retailinstallmentcontract/handlers/set-line-item-ric.html?_from\x3dgurupa",
data:a,async:!0,cache:!1,headers:m.setAjaxTransitionHeader(),success:m.redirect,error:m.redirect}))});a.on("checkout:reload:spp-revieworder",p);a.on("checkout:reload:spc",p)});"use strict";r.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector","payments-portal-common","ready").register("spc-payments-portal",function(a,l,m,c,f,h,g){function b(b,c){c={refTag:c,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};
l.isSPP()&&(c.keepCachedPagesData=1);l.loadPage("spc",b,null,c)}function e(a,b,e){l.isSPP()?(c.blockAllActions(),c.showTransitionInContainer(p("#payment"))):c.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a;var f=l.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});p.ajax({type:"POST",url:a,data:b,headers:f,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?
l.ajaxUpdatePage(a,b,c):e(a)},error:l.ajaxRedirect})}var p=a.$;return{prepareDelegatedPopovers:function(b){function c(a,b){a=p(a);a.data("aCheckoutModalPopover",b);m.createModal({$declarativeParent:a},b)}a.on("pmts:retail:billing-address-popover",function(a){c(".pmts-change-address-link",{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){c(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,
footer:"",name:"rewards-registration",allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,b){var c={returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:p("input[name\x3dfromAnywhere]").val(),cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",embedOnlyData:"1"};a=p.param(a)+"\x26"+p.param(c);e("ox_pay_page_gc_add",a,function(a){g.claimCodePageUpdater(b,a)})},handleChangeBillingAddressRequestedEvent:function(){h.isDesktopSpc()?l.isSPP()?p("#pmts-change-billing-address-popover").trigger("click"):
a.trigger("pmts:retail:billing-address-popover"):(c.show(),l.isPipeliningOn()&&b("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){c.show();l.isPipeliningOn()&&b("payselect","ox_spc_change_payment")},handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var b={hasWorkingJavascript:"1",isClientTimeBased:p("input[name\x3duseCtb]").val(),nextAction:"dispatch"};
a=p.param(a)+"\x26"+p.param(b);e("ox_spc_points_edit",a,function(a){a=f.jsonify(a);l.redirect(a)})}}});"use strict";r.when("ajax-utility","gc-redeem-controller","page-transition-controller","ready").register("payments-portal-common",function(a,l,m){return{claimCodePageUpdater:function(c,f){f=a.jsonify(f);null!==f?f.widgetJsonData?(c.update(f.widgetJsonData),m.hide()):f.autohandlererror&&l.giftSystemErrorHandling(f.autohandlererror):m.hide()}}});"use strict";r.when("A","page-detector-current-page",
"a-button","a-meter").register("checkout-throttle-error",function(a,l,m,c){var f=a.$;a.on("checkout:reload:throttle",function(){if(f("#checkout-throttle-meter").length){var a=1E3*f('input[name\x3d"waiting-time"]').val()/100;m("#checkout-throttle-return-to-cart").disable();var g=c("#checkout-throttle-meter"),b=0,e=setInterval(function(){g.percent(b);if(100>b)b+=1;else{clearInterval(e);var a=m("#checkout-throttle-return-to-cart");a.text(f("#checkout-throttle-primary-button-active-text").text());a.enable()}},
a)}})});"use strict";r.when("A","weblab-helper").register("nav-bar-helper",function(a,l){function m(){try{r.register("navCF")}catch(a){if(-1===a.message.toLowerCase().indexOf("already registered"))throw a;}}if(l.isNavCFWeblabOn())a.on("checkout:reload",m)});r.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");a.$currentTarget.hide();a.$event.preventDefault()})});
"use strict";r.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,l,m){function c(a){for(var c=[],b=f;b<a.length;b++)c.push(a[b]);return c}var f=2;return{wrap:function(a,f){try{return a.apply(null,c(arguments))}catch(d){var b=f,e=d,p;p=b;p=l.getExternalDependecies()[p];p=p!==F&&null!==p?p.cti:"Undefined";m.logError(e,"["+b+"] Javascript error thrown while executing wrapper",p,"FATAL");q.console&&q.console.error&&q.console.error(e,b,p)}}}});
"use strict";r.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,l,m){function c(a){a=a.assetsModule;if(f[a]?0:0<l('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+a+'"]').length)f[a]=!0,r.register("trigger"+a,function(){})}var f={};a.on("checkout:reload",function(){var a=m.getExternalDependecies(),f;for(f in a)a.hasOwnProperty(f)&&c(a[f])})});"use strict";r.when("A","client-side-metrics").register("checkout-federation-utilities",
function(a,l){return{getExternalDependecies:function(){var m=a.state("triggerExternalDependencies");Object&&Object.keys&&l.increaseCount("Checkout:ExternalDependencies:count:"+(m?Object.keys(m).length:"undefined"));return m===F||null===m?{}:m}}});"use strict";r.register("allow-installments-page-transition",function(){return{isEnabled:!0}})});
/* ******** */
